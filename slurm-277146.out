	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 10:09:22,919] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 10:09:27,321] INFO: Building board loggers...
[2022-05-31 10:09:27,322] INFO: Building callbacks...
[2022-05-31 10:09:27,323] INFO: Building model: spectra...
[2022-05-31 10:09:27,577] INFO: Created a temporary directory at /tmp/tmp3g9tf122
[2022-05-31 10:09:27,578] INFO: Writing /tmp/tmp3g9tf122/_remote_module_non_sriptable.py
[2022-05-31 10:09:27,946] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 10:09:38,392] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<83:57:19,  7.27it/s]  0%|          | 1037/2196017 [00:00<58:45:31, 10.38it/s]  0%|          | 2222/2196017 [00:00<41:07:27, 14.82it/s]  0%|          | 3524/2196017 [00:00<28:47:02, 21.16it/s]  0%|          | 4834/2196017 [00:00<20:09:02, 30.21it/s]  0%|          | 6156/2196017 [00:00<14:06:38, 43.11it/s]  0%|          | 7448/2196017 [00:00<9:53:09, 61.50it/s]   0%|          | 8817/2196017 [00:00<6:55:44, 87.68it/s]  0%|          | 10228/2196017 [00:00<4:51:36, 124.93it/s]  1%|          | 11679/2196017 [00:01<3:24:44, 177.81it/s]  1%|          | 13160/2196017 [00:01<2:23:57, 252.72it/s]  1%|          | 14639/2196017 [00:01<1:41:26, 358.39it/s]  1%|          | 16224/2196017 [00:01<1:11:38, 507.08it/s]  1%|          | 17788/2196017 [00:01<50:48, 714.47it/s]    1%|          | 19429/2196017 [00:01<36:12, 1001.96it/s]  1%|          | 21128/2196017 [00:01<25:57, 1396.06it/s]  1%|          | 22818/2196017 [00:01<18:48, 1926.14it/s]  1%|          | 24448/2196017 [00:01<13:49, 2618.95it/s]  1%|          | 26152/2196017 [00:01<10:18, 3509.89it/s]  1%|▏         | 27938/2196017 [00:02<07:48, 4623.96it/s]  1%|▏         | 29672/2196017 [00:02<06:05, 5927.98it/s]  1%|▏         | 31410/2196017 [00:02<04:52, 7387.80it/s]  2%|▏         | 33366/2196017 [00:02<03:58, 9083.01it/s]  2%|▏         | 35301/2196017 [00:02<03:20, 10800.73it/s]  2%|▏         | 37130/2196017 [00:02<02:55, 12306.09it/s]  2%|▏         | 39086/2196017 [00:02<02:35, 13843.58it/s]  2%|▏         | 41101/2196017 [00:02<02:21, 15277.72it/s]  2%|▏         | 43111/2196017 [00:02<02:10, 16458.54it/s]  2%|▏         | 45261/2196017 [00:02<02:01, 17699.51it/s]  2%|▏         | 47418/2196017 [00:03<01:54, 18706.08it/s]  2%|▏         | 49569/2196017 [00:03<01:50, 19462.17it/s]  2%|▏         | 51733/2196017 [00:03<01:46, 20063.25it/s]  2%|▏         | 53936/2196017 [00:03<01:43, 20614.42it/s]  3%|▎         | 56215/2196017 [00:03<01:40, 21217.40it/s]  3%|▎         | 58587/2196017 [00:03<01:37, 21907.36it/s]  3%|▎         | 60882/2196017 [00:03<01:36, 22210.00it/s]  3%|▎         | 63223/2196017 [00:03<01:34, 22553.33it/s]  3%|▎         | 65653/2196017 [00:03<01:32, 23049.45it/s]  3%|▎         | 68079/2196017 [00:03<01:30, 23395.50it/s]  3%|▎         | 70639/2196017 [00:04<01:28, 24015.80it/s]  3%|▎         | 73251/2196017 [00:04<01:26, 24607.84it/s]  3%|▎         | 75863/2196017 [00:04<01:24, 25041.80it/s]  4%|▎         | 78625/2196017 [00:04<01:22, 25760.65it/s]  4%|▎         | 81299/2196017 [00:04<01:21, 26043.34it/s]  4%|▍         | 83998/2196017 [00:04<01:20, 26313.14it/s]  4%|▍         | 86899/2196017 [00:04<01:17, 27067.51it/s]  4%|▍         | 89822/2196017 [00:04<01:16, 27677.46it/s]  4%|▍         | 92781/2196017 [00:04<01:14, 28224.72it/s]  4%|▍         | 95849/2196017 [00:04<01:12, 28917.76it/s]  4%|▍         | 98815/2196017 [00:05<01:11, 29135.43it/s]  5%|▍         | 102009/2196017 [00:05<01:09, 29914.77it/s]  5%|▍         | 105322/2196017 [00:05<01:07, 30810.55it/s]  5%|▍         | 108592/2196017 [00:05<01:06, 31352.55it/s]  5%|▌         | 112003/2196017 [00:05<01:04, 32125.05it/s]  5%|▌         | 115520/2196017 [00:05<01:03, 32979.27it/s]  5%|▌         | 119029/2196017 [00:05<01:01, 33582.70it/s]  6%|▌         | 122484/2196017 [00:05<01:01, 33858.83it/s]  6%|▌         | 125916/2196017 [00:05<01:00, 33985.89it/s]  6%|▌         | 129491/2196017 [00:05<00:59, 34494.96it/s]  6%|▌         | 133172/2196017 [00:06<00:58, 35156.64it/s]  6%|▌         | 136778/2196017 [00:06<00:58, 35421.52it/s]  6%|▋         | 140466/2196017 [00:06<00:57, 35846.32it/s]  7%|▋         | 144309/2196017 [00:06<00:56, 36580.79it/s]  7%|▋         | 147975/2196017 [00:06<00:56, 36283.06it/s]  7%|▋         | 151823/2196017 [00:06<00:55, 36913.63it/s]  7%|▋         | 155540/2196017 [00:06<00:55, 36989.26it/s]  7%|▋         | 159555/2196017 [00:06<00:53, 37880.86it/s]  7%|▋         | 163597/2196017 [00:06<00:52, 38607.18it/s]  8%|▊         | 167481/2196017 [00:06<00:52, 38674.34it/s]  8%|▊         | 171639/2196017 [00:07<00:51, 39500.73it/s]  8%|▊         | 175658/2196017 [00:07<00:50, 39703.12it/s]  8%|▊         | 179820/2196017 [00:07<00:50, 40257.92it/s]  8%|▊         | 184011/2196017 [00:07<00:49, 40738.52it/s]  9%|▊         | 188177/2196017 [00:07<00:48, 41010.01it/s]  9%|▉         | 192425/2196017 [00:07<00:48, 41438.25it/s]  9%|▉         | 196574/2196017 [00:07<00:48, 41191.99it/s]  9%|▉         | 200851/2196017 [00:07<00:47, 41651.88it/s]  9%|▉         | 205088/2196017 [00:07<00:47, 41864.58it/s] 10%|▉         | 209526/2196017 [00:07<00:46, 42588.27it/s] 10%|▉         | 213824/2196017 [00:08<00:46, 42703.16it/s] 10%|▉         | 218330/2196017 [00:08<00:45, 43382.43it/s] 10%|█         | 222735/2196017 [00:08<00:45, 43576.79it/s] 10%|█         | 227270/2196017 [00:08<00:44, 44085.08it/s] 11%|█         | 231807/2196017 [00:08<00:44, 44459.93it/s] 11%|█         | 236257/2196017 [00:08<00:44, 43835.13it/s] 11%|█         | 240646/2196017 [00:08<00:44, 43581.20it/s] 11%|█         | 245217/2196017 [00:08<00:44, 44195.62it/s] 11%|█▏        | 249787/2196017 [00:08<00:43, 44634.91it/s] 12%|█▏        | 254321/2196017 [00:08<00:43, 44842.33it/s] 12%|█▏        | 258847/2196017 [00:09<00:43, 44965.52it/s] 12%|█▏        | 263346/2196017 [00:09<00:43, 44587.45it/s] 12%|█▏        | 267808/2196017 [00:09<00:43, 44333.85it/s] 12%|█▏        | 272353/2196017 [00:09<00:43, 44657.38it/s] 13%|█▎        | 277009/2196017 [00:09<00:42, 45210.68it/s] 13%|█▎        | 281534/2196017 [00:11<05:07, 6226.13it/s]  13%|█▎        | 284763/2196017 [00:12<04:52, 6536.83it/s] 13%|█▎        | 289289/2196017 [00:12<03:36, 8793.91it/s] 13%|█▎        | 293957/2196017 [00:12<02:43, 11624.07it/s] 14%|█▎        | 298636/2196017 [00:12<02:06, 15007.91it/s] 14%|█▍        | 303449/2196017 [00:12<01:40, 18912.36it/s] 14%|█▍        | 308329/2196017 [00:12<01:21, 23169.30it/s] 14%|█▍        | 313162/2196017 [00:12<01:08, 27457.06it/s] 14%|█▍        | 318027/2196017 [00:12<00:59, 31584.27it/s] 15%|█▍        | 322894/2196017 [00:12<00:53, 35301.01it/s] 15%|█▍        | 327689/2196017 [00:12<00:48, 38334.59it/s] 15%|█▌        | 332490/2196017 [00:13<00:45, 40799.83it/s] 15%|█▌        | 337292/2196017 [00:13<00:43, 42726.14it/s] 16%|█▌        | 342114/2196017 [00:13<00:41, 44238.01it/s] 16%|█▌        | 346896/2196017 [00:13<00:40, 45181.46it/s] 16%|█▌        | 351841/2196017 [00:13<00:39, 46381.38it/s] 16%|█▌        | 356746/2196017 [00:13<00:39, 47137.60it/s] 16%|█▋        | 361636/2196017 [00:13<00:38, 47651.32it/s] 17%|█▋        | 366614/2196017 [00:13<00:37, 48270.07it/s] 17%|█▋        | 371630/2196017 [00:13<00:37, 48820.21it/s] 17%|█▋        | 376613/2196017 [00:13<00:37, 49117.66it/s] 17%|█▋        | 381560/2196017 [00:14<00:36, 49201.28it/s] 18%|█▊        | 386617/2196017 [00:14<00:36, 49601.94it/s] 18%|█▊        | 391654/2196017 [00:14<00:36, 49823.77it/s] 18%|█▊        | 396764/2196017 [00:14<00:35, 50198.07it/s] 18%|█▊        | 402144/2196017 [00:14<00:35, 51225.70it/s] 19%|█▊        | 407412/2196017 [00:14<00:34, 51652.99it/s] 19%|█▉        | 412587/2196017 [00:14<00:43, 41122.87it/s] 19%|█▉        | 417106/2196017 [00:14<00:42, 42262.80it/s] 19%|█▉        | 422247/2196017 [00:14<00:39, 44644.31it/s] 19%|█▉        | 427424/2196017 [00:15<00:37, 46566.74it/s] 20%|█▉        | 432460/2196017 [00:15<00:37, 47639.80it/s] 20%|█▉        | 437603/2196017 [00:15<00:36, 48708.74it/s] 20%|██        | 442844/2196017 [00:15<00:35, 49762.58it/s] 20%|██        | 447953/2196017 [00:15<00:34, 50153.03it/s] 21%|██        | 453118/2196017 [00:15<00:34, 50592.73it/s] 21%|██        | 458244/2196017 [00:15<00:34, 50789.40it/s] 21%|██        | 463416/2196017 [00:15<00:33, 51063.73it/s] 21%|██▏       | 468577/2196017 [00:15<00:33, 51225.50it/s] 22%|██▏       | 473956/2196017 [00:15<00:33, 51968.35it/s] 22%|██▏       | 479165/2196017 [00:16<00:33, 51850.36it/s] 22%|██▏       | 484365/2196017 [00:16<00:32, 51892.14it/s] 22%|██▏       | 489609/2196017 [00:16<00:32, 52053.28it/s] 23%|██▎       | 494861/2196017 [00:16<00:32, 52191.80it/s] 23%|██▎       | 500084/2196017 [00:16<00:32, 51972.13it/s] 23%|██▎       | 505304/2196017 [00:16<00:32, 52037.92it/s] 23%|██▎       | 510581/2196017 [00:16<00:32, 52254.09it/s] 23%|██▎       | 515885/2196017 [00:16<00:32, 52487.12it/s] 24%|██▎       | 521135/2196017 [00:16<00:32, 52270.31it/s] 24%|██▍       | 526471/2196017 [00:16<00:31, 52590.23it/s] 24%|██▍       | 531922/2196017 [00:17<00:31, 53149.49it/s] 24%|██▍       | 537247/2196017 [00:17<00:31, 53177.95it/s] 25%|██▍       | 542583/2196017 [00:17<00:31, 53229.11it/s] 25%|██▍       | 547941/2196017 [00:17<00:30, 53332.65it/s] 25%|██▌       | 553347/2196017 [00:17<00:30, 53547.71it/s] 25%|██▌       | 558707/2196017 [00:17<00:30, 53561.87it/s] 26%|██▌       | 564064/2196017 [00:17<00:30, 53453.84it/s] 26%|██▌       | 569410/2196017 [00:17<00:30, 52787.21it/s] 26%|██▌       | 574691/2196017 [00:17<00:31, 52297.49it/s] 26%|██▋       | 579924/2196017 [00:17<00:31, 52061.37it/s] 27%|██▋       | 585185/2196017 [00:18<00:30, 52224.10it/s] 27%|██▋       | 590409/2196017 [00:18<00:30, 52067.85it/s] 27%|██▋       | 595617/2196017 [00:18<00:31, 51555.74it/s] 27%|██▋       | 600859/2196017 [00:18<00:30, 51811.62it/s] 28%|██▊       | 606142/2196017 [00:18<00:30, 52112.82it/s] 28%|██▊       | 611355/2196017 [00:18<00:30, 51989.84it/s] 28%|██▊       | 616661/2196017 [00:18<00:30, 52305.90it/s] 28%|██▊       | 621893/2196017 [00:18<00:30, 52305.50it/s] 29%|██▊       | 627274/2196017 [00:18<00:29, 52746.55it/s] 29%|██▉       | 632581/2196017 [00:18<00:29, 52836.64it/s] 29%|██▉       | 637879/2196017 [00:19<00:29, 52878.15it/s] 29%|██▉       | 643168/2196017 [00:19<00:29, 52633.97it/s] 30%|██▉       | 648460/2196017 [00:19<00:29, 52714.24it/s] 30%|██▉       | 653733/2196017 [00:19<00:29, 52636.97it/s] 30%|███       | 659152/2196017 [00:19<00:28, 53090.78it/s] 30%|███       | 664463/2196017 [00:19<00:28, 52853.81it/s] 30%|███       | 669750/2196017 [00:19<00:28, 52849.65it/s] 31%|███       | 675079/2196017 [00:19<00:28, 52978.21it/s] 31%|███       | 680403/2196017 [00:19<00:28, 53055.21it/s] 31%|███       | 685762/2196017 [00:19<00:28, 53214.50it/s] 31%|███▏      | 691084/2196017 [00:20<00:28, 53085.82it/s] 32%|███▏      | 696430/2196017 [00:20<00:28, 53195.91it/s] 32%|███▏      | 701784/2196017 [00:20<00:28, 53295.88it/s] 32%|███▏      | 707260/2196017 [00:20<00:27, 53725.68it/s] 32%|███▏      | 712744/2196017 [00:20<00:27, 54052.65it/s] 33%|███▎      | 718151/2196017 [00:20<00:27, 53881.17it/s] 33%|███▎      | 723541/2196017 [00:20<00:27, 53792.59it/s] 33%|███▎      | 728961/2196017 [00:20<00:27, 53912.65it/s] 33%|███▎      | 734434/2196017 [00:20<00:26, 54154.76it/s] 34%|███▎      | 739884/2196017 [00:20<00:26, 54257.04it/s] 34%|███▍      | 745385/2196017 [00:21<00:26, 54478.45it/s] 34%|███▍      | 750834/2196017 [00:21<00:26, 54331.37it/s] 34%|███▍      | 756268/2196017 [00:21<00:26, 54045.55it/s] 35%|███▍      | 761674/2196017 [00:21<00:26, 54014.02it/s] 35%|███▍      | 767076/2196017 [00:21<00:26, 53949.11it/s] 35%|███▌      | 772472/2196017 [00:21<00:26, 53785.23it/s] 35%|███▌      | 777851/2196017 [00:21<00:26, 53725.39it/s] 36%|███▌      | 783299/2196017 [00:21<00:26, 53946.95it/s] 36%|███▌      | 788843/2196017 [00:21<00:25, 54383.92it/s] 36%|███▌      | 794283/2196017 [00:22<00:25, 54375.62it/s] 36%|███▋      | 799839/2196017 [00:22<00:25, 54725.23it/s] 37%|███▋      | 805372/2196017 [00:22<00:25, 54905.05it/s] 37%|███▋      | 810930/2196017 [00:22<00:25, 55103.71it/s] 37%|███▋      | 816442/2196017 [00:22<00:25, 54965.22it/s] 37%|███▋      | 821940/2196017 [00:22<00:25, 54792.80it/s] 38%|███▊      | 827420/2196017 [00:22<00:25, 54451.30it/s] 38%|███▊      | 832867/2196017 [00:22<00:25, 54388.79it/s] 38%|███▊      | 838324/2196017 [00:22<00:24, 54441.14it/s] 38%|███▊      | 843867/2196017 [00:22<00:24, 54733.70it/s] 39%|███▊      | 849342/2196017 [00:23<00:24, 54586.37it/s] 39%|███▉      | 854802/2196017 [00:23<00:24, 54516.24it/s] 39%|███▉      | 860255/2196017 [00:23<00:24, 53939.66it/s] 39%|███▉      | 865651/2196017 [00:23<00:24, 53898.37it/s] 40%|███▉      | 871059/2196017 [00:23<00:24, 53952.24it/s] 40%|███▉      | 876496/2196017 [00:23<00:24, 54076.76it/s] 40%|████      | 881906/2196017 [00:23<00:24, 54082.39it/s] 40%|████      | 887315/2196017 [00:23<00:24, 53917.14it/s] 41%|████      | 892708/2196017 [00:23<00:24, 53813.14it/s] 41%|████      | 898190/2196017 [00:23<00:23, 54105.43it/s] 41%|████      | 903614/2196017 [00:24<00:23, 54143.62it/s] 41%|████▏     | 909029/2196017 [00:24<00:23, 54095.60it/s] 42%|████▏     | 914439/2196017 [00:24<00:23, 53998.76it/s] 42%|████▏     | 919840/2196017 [00:24<00:23, 53951.45it/s] 42%|████▏     | 925236/2196017 [00:24<00:23, 53908.00it/s] 42%|████▏     | 930627/2196017 [00:24<00:23, 53788.89it/s] 43%|████▎     | 936007/2196017 [00:24<00:23, 53617.65it/s] 43%|████▎     | 941473/2196017 [00:24<00:23, 53926.14it/s] 43%|████▎     | 946867/2196017 [00:24<00:23, 53896.43it/s] 43%|████▎     | 952340/2196017 [00:24<00:22, 54143.19it/s] 44%|████▎     | 957862/2196017 [00:25<00:22, 54459.08it/s] 44%|████▍     | 963309/2196017 [00:25<00:22, 54257.61it/s] 44%|████▍     | 968813/2196017 [00:25<00:22, 54488.92it/s] 44%|████▍     | 974368/2196017 [00:25<00:22, 54801.47it/s] 45%|████▍     | 979855/2196017 [00:25<00:22, 54819.79it/s] 45%|████▍     | 985338/2196017 [00:25<00:22, 54788.31it/s] 45%|████▌     | 990839/2196017 [00:25<00:21, 54853.00it/s] 45%|████▌     | 996325/2196017 [00:25<00:21, 54836.72it/s] 46%|████▌     | 1001880/2196017 [00:25<00:21, 55047.46it/s] 46%|████▌     | 1007386/2196017 [00:25<00:21, 54695.72it/s] 46%|████▌     | 1012857/2196017 [00:26<00:21, 54682.19it/s] 46%|████▋     | 1018326/2196017 [00:26<00:21, 54546.45it/s] 47%|████▋     | 1023782/2196017 [00:26<00:21, 54389.00it/s] 47%|████▋     | 1029222/2196017 [00:26<00:21, 54146.11it/s] 47%|████▋     | 1034689/2196017 [00:26<00:21, 54301.31it/s] 47%|████▋     | 1040120/2196017 [00:26<00:21, 54277.81it/s] 48%|████▊     | 1045646/2196017 [00:26<00:21, 54568.53it/s] 48%|████▊     | 1051108/2196017 [00:26<00:20, 54580.54it/s] 48%|████▊     | 1056575/2196017 [00:26<00:20, 54605.26it/s] 48%|████▊     | 1062062/2196017 [00:26<00:20, 54682.24it/s] 49%|████▊     | 1067535/2196017 [00:27<00:20, 54694.04it/s] 49%|████▉     | 1073052/2196017 [00:27<00:20, 54833.44it/s] 49%|████▉     | 1078536/2196017 [00:27<00:20, 54733.69it/s] 49%|████▉     | 1084010/2196017 [00:27<00:20, 54174.18it/s] 50%|████▉     | 1089436/2196017 [00:27<00:20, 54197.63it/s] 50%|████▉     | 1094940/2196017 [00:27<00:20, 54446.75it/s] 50%|█████     | 1100387/2196017 [00:27<00:20, 54451.05it/s] 50%|█████     | 1105890/2196017 [00:27<00:19, 54623.39it/s] 51%|█████     | 1111353/2196017 [00:27<00:19, 54300.65it/s] 51%|█████     | 1116902/2196017 [00:27<00:19, 54650.54it/s] 51%|█████     | 1122369/2196017 [00:28<00:19, 54520.56it/s] 51%|█████▏    | 1127822/2196017 [00:28<00:19, 54388.82it/s] 52%|█████▏    | 1133386/2196017 [00:28<00:19, 54756.28it/s] 52%|█████▏    | 1138863/2196017 [00:28<00:19, 54681.42it/s] 52%|█████▏    | 1144373/2196017 [00:28<00:19, 54803.57it/s] 52%|█████▏    | 1149871/2196017 [00:28<00:19, 54854.99it/s] 53%|█████▎    | 1155367/2196017 [00:28<00:18, 54886.39it/s] 53%|█████▎    | 1161058/2196017 [00:28<00:18, 55477.86it/s] 53%|█████▎    | 1166620/2196017 [00:28<00:18, 55517.91it/s] 53%|█████▎    | 1172217/2196017 [00:28<00:18, 55650.65it/s] 54%|█████▎    | 1177783/2196017 [00:29<00:18, 55257.33it/s] 54%|█████▍    | 1183391/2196017 [00:29<00:18, 55500.23it/s] 54%|█████▍    | 1188943/2196017 [00:29<00:18, 55201.44it/s] 54%|█████▍    | 1194465/2196017 [00:29<00:18, 54806.45it/s] 55%|█████▍    | 1200013/2196017 [00:29<00:18, 55006.06it/s] 55%|█████▍    | 1205515/2196017 [00:29<00:18, 54971.18it/s] 55%|█████▌    | 1211013/2196017 [00:29<00:17, 54924.74it/s] 55%|█████▌    | 1216531/2196017 [00:29<00:17, 55000.73it/s] 56%|█████▌    | 1222216/2196017 [00:29<00:17, 55540.37it/s] 56%|█████▌    | 1228216/2196017 [00:29<00:17, 56805.58it/s] 56%|█████▌    | 1234124/2196017 [00:30<00:16, 57469.00it/s] 56%|█████▋    | 1239879/2196017 [00:30<00:16, 57294.69it/s] 57%|█████▋    | 1245676/2196017 [00:30<00:16, 57492.99it/s] 57%|█████▋    | 1251430/2196017 [00:30<00:16, 56748.39it/s] 57%|█████▋    | 1257110/2196017 [00:30<00:16, 56591.27it/s] 58%|█████▊    | 1262773/2196017 [00:30<00:16, 56242.11it/s] 58%|█████▊    | 1268401/2196017 [00:30<00:16, 55599.54it/s] 58%|█████▊    | 1273965/2196017 [00:30<00:16, 55178.80it/s] 58%|█████▊    | 1279487/2196017 [00:30<00:16, 54955.56it/s] 59%|█████▊    | 1284986/2196017 [00:30<00:16, 54903.77it/s] 59%|█████▉    | 1290479/2196017 [00:31<00:16, 54648.56it/s] 59%|█████▉    | 1295946/2196017 [00:31<00:16, 54598.28it/s] 59%|█████▉    | 1301407/2196017 [00:31<00:16, 54442.30it/s] 60%|█████▉    | 1306853/2196017 [00:31<00:16, 54130.02it/s] 60%|█████▉    | 1312385/2196017 [00:31<00:16, 54481.01it/s] 60%|██████    | 1317983/2196017 [00:31<00:15, 54921.68it/s] 60%|██████    | 1323477/2196017 [00:31<00:15, 54898.81it/s] 61%|██████    | 1329022/2196017 [00:31<00:15, 55062.79it/s] 61%|██████    | 1334530/2196017 [00:31<00:15, 55063.80it/s] 61%|██████    | 1340038/2196017 [00:31<00:15, 54751.57it/s] 61%|██████▏   | 1345568/2196017 [00:32<00:15, 54912.24it/s] 62%|██████▏   | 1351074/2196017 [00:32<00:15, 54954.11it/s] 62%|██████▏   | 1356570/2196017 [00:32<00:15, 54680.03it/s] 62%|██████▏   | 1362039/2196017 [00:32<00:15, 54555.30it/s] 62%|██████▏   | 1367518/2196017 [00:32<00:15, 54622.94it/s] 63%|██████▎   | 1372984/2196017 [00:32<00:15, 54631.45it/s] 63%|██████▎   | 1378448/2196017 [00:32<00:15, 54340.07it/s] 63%|██████▎   | 1383883/2196017 [00:32<00:14, 54341.86it/s] 63%|██████▎   | 1389395/2196017 [00:32<00:14, 54570.95it/s] 64%|██████▎   | 1394901/2196017 [00:32<00:14, 54715.76it/s] 64%|██████▍   | 1400416/2196017 [00:33<00:14, 54845.17it/s] 64%|██████▍   | 1405903/2196017 [00:33<00:14, 54852.40it/s] 64%|██████▍   | 1411389/2196017 [00:33<00:14, 54606.82it/s] 65%|██████▍   | 1416915/2196017 [00:33<00:14, 54799.53it/s] 65%|██████▍   | 1422521/2196017 [00:33<00:14, 55171.54it/s] 65%|██████▌   | 1428040/2196017 [00:33<00:13, 54924.04it/s] 65%|██████▌   | 1433534/2196017 [00:33<00:13, 54903.40it/s] 66%|██████▌   | 1439025/2196017 [00:33<00:13, 54879.96it/s] 66%|██████▌   | 1444514/2196017 [00:33<00:13, 54245.17it/s] 66%|██████▌   | 1449941/2196017 [00:33<00:13, 54244.72it/s] 66%|██████▋   | 1455367/2196017 [00:34<00:13, 53866.35it/s] 67%|██████▋   | 1460756/2196017 [00:34<00:13, 53602.48it/s] 67%|██████▋   | 1466118/2196017 [00:34<00:13, 53466.40it/s] 67%|██████▋   | 1471466/2196017 [00:34<00:13, 53332.81it/s] 67%|██████▋   | 1476801/2196017 [00:34<00:13, 52612.80it/s] 67%|██████▋   | 1482209/2196017 [00:34<00:13, 53043.43it/s] 68%|██████▊   | 1487684/2196017 [00:34<00:13, 53541.89it/s] 68%|██████▊   | 1493238/2196017 [00:34<00:12, 54126.00it/s] 68%|██████▊   | 1498780/2196017 [00:34<00:12, 54507.79it/s] 68%|██████▊   | 1504234/2196017 [00:34<00:12, 54494.13it/s] 69%|██████▊   | 1509686/2196017 [00:35<00:12, 54459.57it/s] 69%|██████▉   | 1515235/2196017 [00:35<00:12, 54762.67it/s] 69%|██████▉   | 1520716/2196017 [00:35<00:12, 54775.31it/s] 69%|██████▉   | 1526195/2196017 [00:35<00:12, 54496.33it/s] 70%|██████▉   | 1531646/2196017 [00:35<00:12, 53822.71it/s] 70%|██████▉   | 1537091/2196017 [00:35<00:12, 54004.68it/s] 70%|███████   | 1542552/2196017 [00:35<00:12, 54183.53it/s] 70%|███████   | 1548189/2196017 [00:35<00:11, 54821.43it/s] 71%|███████   | 1553675/2196017 [00:35<00:11, 54677.01it/s] 71%|███████   | 1559210/2196017 [00:35<00:11, 54875.56it/s] 71%|███████▏  | 1564700/2196017 [00:36<00:11, 54778.44it/s] 72%|███████▏  | 1570203/2196017 [00:36<00:11, 54853.41it/s] 72%|███████▏  | 1575806/2196017 [00:36<00:11, 55198.58it/s] 72%|███████▏  | 1581327/2196017 [00:36<00:11, 55039.53it/s] 72%|███████▏  | 1586832/2196017 [00:36<00:11, 54974.40it/s] 73%|███████▎  | 1592331/2196017 [00:36<00:10, 54919.00it/s] 73%|███████▎  | 1597824/2196017 [00:36<00:10, 54864.84it/s] 73%|███████▎  | 1603380/2196017 [00:36<00:10, 55053.34it/s] 73%|███████▎  | 1608934/2196017 [00:36<00:10, 55196.42it/s] 74%|███████▎  | 1614454/2196017 [00:36<00:10, 54942.75it/s] 74%|███████▍  | 1620057/2196017 [00:37<00:10, 55264.02it/s] 74%|███████▍  | 1625588/2196017 [00:37<00:10, 55276.16it/s] 74%|███████▍  | 1631162/2196017 [00:37<00:10, 55412.07it/s] 75%|███████▍  | 1636704/2196017 [00:37<00:10, 55334.84it/s] 75%|███████▍  | 1642238/2196017 [00:37<00:10, 55100.82it/s] 75%|███████▌  | 1647749/2196017 [00:37<00:09, 54848.97it/s] 75%|███████▌  | 1653235/2196017 [00:37<00:09, 54684.79it/s] 76%|███████▌  | 1658705/2196017 [00:37<00:09, 54505.55it/s] 76%|███████▌  | 1664210/2196017 [00:37<00:09, 54667.61it/s] 76%|███████▌  | 1669819/2196017 [00:38<00:09, 55084.70it/s] 76%|███████▋  | 1675391/2196017 [00:38<00:09, 55272.56it/s] 77%|███████▋  | 1680920/2196017 [00:38<00:09, 55259.08it/s] 77%|███████▋  | 1686503/2196017 [00:38<00:09, 55428.24it/s] 77%|███████▋  | 1692047/2196017 [00:38<00:09, 54894.81it/s] 77%|███████▋  | 1697545/2196017 [00:38<00:09, 54918.90it/s] 78%|███████▊  | 1703038/2196017 [00:38<00:09, 54730.61it/s] 78%|███████▊  | 1708549/2196017 [00:38<00:08, 54838.55it/s] 78%|███████▊  | 1714077/2196017 [00:38<00:08, 54969.24it/s] 78%|███████▊  | 1719575/2196017 [00:38<00:08, 54667.96it/s] 79%|███████▊  | 1725099/2196017 [00:39<00:08, 54838.03it/s] 79%|███████▉  | 1730584/2196017 [00:39<00:08, 54753.14it/s] 79%|███████▉  | 1736060/2196017 [00:39<00:08, 54561.67it/s] 79%|███████▉  | 1741590/2196017 [00:39<00:08, 54780.40it/s] 80%|███████▉  | 1747094/2196017 [00:39<00:08, 54856.32it/s] 80%|███████▉  | 1752581/2196017 [00:39<00:08, 54324.75it/s] 80%|████████  | 1758065/2196017 [00:39<00:08, 54476.73it/s] 80%|████████  | 1763664/2196017 [00:39<00:07, 54919.49it/s] 81%|████████  | 1769203/2196017 [00:39<00:07, 55057.31it/s] 81%|████████  | 1774729/2196017 [00:39<00:07, 55115.50it/s] 81%|████████  | 1780272/2196017 [00:40<00:07, 55201.43it/s] 81%|████████▏ | 1785810/2196017 [00:40<00:07, 55252.76it/s] 82%|████████▏ | 1791425/2196017 [00:40<00:07, 55515.82it/s] 82%|████████▏ | 1796978/2196017 [00:40<00:07, 55499.57it/s] 82%|████████▏ | 1802686/2196017 [00:40<00:07, 55961.98it/s] 82%|████████▏ | 1808368/2196017 [00:40<00:06, 56216.31it/s] 83%|████████▎ | 1813991/2196017 [00:40<00:06, 56066.59it/s] 83%|████████▎ | 1819599/2196017 [00:40<00:07, 50854.82it/s] 83%|████████▎ | 1825054/2196017 [00:40<00:07, 51907.37it/s] 83%|████████▎ | 1830476/2196017 [00:40<00:06, 52575.56it/s] 84%|████████▎ | 1835987/2196017 [00:41<00:06, 53308.87it/s] 84%|████████▍ | 1841494/2196017 [00:41<00:06, 53822.84it/s] 84%|████████▍ | 1847030/2196017 [00:41<00:06, 54272.45it/s] 84%|████████▍ | 1852751/2196017 [00:41<00:06, 55119.05it/s] 85%|████████▍ | 1858484/2196017 [00:41<00:06, 55762.57it/s] 85%|████████▍ | 1864251/2196017 [00:41<00:05, 56321.00it/s] 85%|████████▌ | 1869895/2196017 [00:41<00:05, 56306.15it/s] 85%|████████▌ | 1875534/2196017 [00:41<00:05, 55850.95it/s] 86%|████████▌ | 1881126/2196017 [00:41<00:05, 55769.91it/s] 86%|████████▌ | 1886708/2196017 [00:41<00:05, 55782.87it/s] 86%|████████▌ | 1892290/2196017 [00:42<00:05, 55721.84it/s] 86%|████████▋ | 1897985/2196017 [00:42<00:05, 56084.62it/s] 87%|████████▋ | 1903596/2196017 [00:42<00:05, 56067.59it/s] 87%|████████▋ | 1909205/2196017 [00:42<00:05, 55781.76it/s] 87%|████████▋ | 1914785/2196017 [00:42<00:05, 55608.30it/s] 87%|████████▋ | 1920509/2196017 [00:42<00:04, 56086.76it/s] 88%|████████▊ | 1926221/2196017 [00:42<00:04, 56391.33it/s] 88%|████████▊ | 1931862/2196017 [00:42<00:04, 55786.67it/s] 88%|████████▊ | 1937444/2196017 [00:42<00:04, 55623.49it/s] 88%|████████▊ | 1943009/2196017 [00:42<00:04, 55255.14it/s] 89%|████████▊ | 1948613/2196017 [00:43<00:04, 55486.53it/s] 89%|████████▉ | 1954164/2196017 [00:43<00:04, 55360.81it/s] 89%|████████▉ | 1959702/2196017 [00:43<00:04, 55237.34it/s] 89%|████████▉ | 1965239/2196017 [00:43<00:04, 55275.43it/s] 90%|████████▉ | 1970893/2196017 [00:43<00:04, 55647.11it/s] 90%|█████████ | 1976490/2196017 [00:43<00:03, 55742.77it/s] 90%|█████████ | 1982066/2196017 [00:43<00:03, 55019.92it/s] 91%|█████████ | 1987701/2196017 [00:43<00:03, 55409.67it/s] 91%|█████████ | 1993291/2196017 [00:43<00:03, 55555.56it/s] 91%|█████████ | 1998849/2196017 [00:43<00:03, 55463.32it/s] 91%|█████████▏| 2004397/2196017 [00:44<00:03, 55372.32it/s] 92%|█████████▏| 2009957/2196017 [00:44<00:03, 55438.66it/s] 92%|█████████▏| 2015502/2196017 [00:44<00:03, 55380.77it/s] 92%|█████████▏| 2021095/2196017 [00:44<00:03, 55544.30it/s] 92%|█████████▏| 2026769/2196017 [00:44<00:03, 55897.27it/s] 93%|█████████▎| 2032360/2196017 [00:44<00:02, 55606.59it/s] 93%|█████████▎| 2038009/2196017 [00:44<00:02, 55868.48it/s] 93%|█████████▎| 2043597/2196017 [00:44<00:02, 55666.01it/s] 93%|█████████▎| 2049165/2196017 [00:44<00:02, 55336.98it/s] 94%|█████████▎| 2054700/2196017 [00:44<00:02, 55189.54it/s] 94%|█████████▍| 2060367/2196017 [00:45<00:02, 55625.20it/s] 94%|█████████▍| 2065931/2196017 [00:45<00:02, 55355.24it/s] 94%|█████████▍| 2071468/2196017 [00:45<00:02, 55182.62it/s] 95%|█████████▍| 2076988/2196017 [00:45<00:02, 54930.99it/s] 95%|█████████▍| 2082483/2196017 [00:45<00:02, 54578.43it/s] 95%|█████████▌| 2087943/2196017 [00:45<00:01, 54419.49it/s] 95%|█████████▌| 2093461/2196017 [00:45<00:01, 54644.79it/s] 96%|█████████▌| 2098967/2196017 [00:45<00:01, 54766.53it/s] 96%|█████████▌| 2104578/2196017 [00:45<00:01, 55160.11it/s] 96%|█████████▌| 2110294/2196017 [00:45<00:01, 55743.10it/s] 96%|█████████▋| 2115871/2196017 [00:46<00:01, 55743.61it/s] 97%|█████████▋| 2121554/2196017 [00:46<00:01, 56065.12it/s] 97%|█████████▋| 2127178/2196017 [00:46<00:01, 56115.24it/s] 97%|█████████▋| 2132870/2196017 [00:46<00:01, 56353.49it/s] 97%|█████████▋| 2138507/2196017 [00:46<00:01, 56220.64it/s] 98%|█████████▊| 2144159/2196017 [00:46<00:00, 56309.13it/s] 98%|█████████▊| 2149791/2196017 [00:46<00:00, 56237.60it/s] 98%|█████████▊| 2155443/2196017 [00:46<00:00, 56319.83it/s] 98%|█████████▊| 2161076/2196017 [00:46<00:00, 55624.78it/s] 99%|█████████▊| 2166641/2196017 [00:46<00:00, 55471.13it/s] 99%|█████████▉| 2172190/2196017 [00:47<00:00, 55434.90it/s] 99%|█████████▉| 2177823/2196017 [00:47<00:00, 55697.45it/s] 99%|█████████▉| 2183528/2196017 [00:47<00:00, 56094.24it/s]100%|█████████▉| 2189139/2196017 [00:47<00:00, 56042.88it/s]100%|█████████▉| 2194762/2196017 [00:47<00:00, 56096.86it/s]100%|██████████| 2196017/2196017 [00:47<00:00, 46001.55it/s]
[2022-05-31 10:10:27,281] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 10:10:36,997] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f3c656d9a30>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f3c656d9a30>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 10:10:37,146] INFO: Vocab size: 64518
[2022-05-31 10:10:37,146] INFO: Nb labels: 2
[2022-05-31 10:10:37,146] INFO: Total params: 21123803
[2022-05-31 10:10:37,147] INFO: Learnable params: 1768403
[2022-05-31 10:10:37,175] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  0%|          | 1/8214 [00:00<39:17,  3.48ex/s]  4%|▍         | 338/8214 [00:00<26:23,  4.97ex/s]  8%|▊         | 670/8214 [00:00<17:42,  7.10ex/s] 12%|█▏        | 995/8214 [00:00<11:52, 10.14ex/s] 15%|█▍        | 1212/8214 [00:01<08:10, 14.28ex/s] 19%|█▊        | 1530/8214 [00:01<05:28, 20.36ex/s] 23%|██▎       | 1857/8214 [00:01<03:39, 29.01ex/s] 26%|██▌       | 2101/8214 [00:01<02:28, 41.23ex/s] 30%|██▉       | 2430/8214 [00:01<01:38, 58.58ex/s] 34%|███▎      | 2760/8214 [00:01<01:05, 83.05ex/s] 37%|███▋      | 3046/8214 [00:01<00:44, 116.92ex/s] 41%|████      | 3378/8214 [00:02<00:29, 164.54ex/s] 45%|████▌     | 3720/8214 [00:02<00:19, 230.30ex/s] 49%|████▉     | 4026/8214 [00:02<00:13, 316.02ex/s] 53%|█████▎    | 4367/8214 [00:02<00:08, 434.19ex/s] 57%|█████▋    | 4692/8214 [00:02<00:06, 586.64ex/s] 61%|██████    | 5001/8214 [00:02<00:04, 761.84ex/s] 65%|██████▌   | 5344/8214 [00:02<00:02, 993.47ex/s] 69%|██████▉   | 5668/8214 [00:02<00:02, 1254.28ex/s] 73%|███████▎  | 5994/8214 [00:02<00:01, 1537.43ex/s] 77%|███████▋  | 6310/8214 [00:02<00:01, 1734.78ex/s] 81%|████████  | 6650/8214 [00:03<00:00, 2032.70ex/s] 85%|████████▍ | 6961/8214 [00:03<00:00, 2267.91ex/s] 89%|████████▊ | 7271/8214 [00:03<00:00, 2350.41ex/s] 93%|█████████▎| 7604/8214 [00:03<00:00, 2575.80ex/s] 97%|█████████▋| 7937/8214 [00:03<00:00, 2763.39ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2249.90ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 25%|██▌       | 348/1369 [00:00<00:00, 3465.35ex/s] 49%|████▉     | 675/1369 [00:00<00:00, 3401.30ex/s] 73%|███████▎  | 996/1369 [00:00<00:00, 3340.67ex/s] 89%|████████▊ | 1212/1369 [00:00<00:00, 2790.31ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3001.59ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  0%|          | 2/1369 [00:00<01:45, 12.93ex/s]  8%|▊         | 114/1369 [00:00<01:08, 18.37ex/s] 23%|██▎       | 320/1369 [00:00<00:40, 26.10ex/s] 35%|███▍      | 474/1369 [00:00<00:24, 37.02ex/s] 41%|████▏     | 567/1369 [00:00<00:15, 51.45ex/s] 64%|██████▍   | 880/1369 [00:00<00:06, 72.99ex/s] 76%|███████▌  | 1043/1369 [00:00<00:03, 102.30ex/s] 99%|█████████▊| 1350/1369 [00:00<00:00, 144.09ex/s]100%|██████████| 1369/1369 [00:00<00:00, 1409.63ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 113, in forward
    x.cpu().numpy() / test_temperature.cpu().numpy(),  # x / test_temperature --> ValueError: only one element tensors can be converted to Python scalars
AttributeError: 'float' object has no attribute 'cpu'

                                                                   