	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 11:02:21,719] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 11:02:26,732] INFO: Building board loggers...
[2022-05-31 11:02:26,733] INFO: Building callbacks...
[2022-05-31 11:02:26,734] INFO: Building model: spectra...
[2022-05-31 11:02:27,183] INFO: Created a temporary directory at /tmp/tmpdglir95r
[2022-05-31 11:02:27,183] INFO: Writing /tmp/tmpdglir95r/_remote_module_non_sriptable.py
[2022-05-31 11:02:27,856] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 11:02:38,121] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<82:09:18,  7.43it/s]  0%|          | 1099/2196017 [00:00<57:29:47, 10.60it/s]  0%|          | 2371/2196017 [00:00<40:14:18, 15.14it/s]  0%|          | 3714/2196017 [00:00<28:09:48, 21.62it/s]  0%|          | 5032/2196017 [00:00<19:42:58, 30.87it/s]  0%|          | 6438/2196017 [00:00<13:48:20, 44.06it/s]  0%|          | 7874/2196017 [00:00<9:40:13, 62.85it/s]   0%|          | 9311/2196017 [00:00<6:46:38, 89.62it/s]  0%|          | 10792/2196017 [00:00<4:45:11, 127.70it/s]  1%|          | 12324/2196017 [00:01<3:20:12, 181.78it/s]  1%|          | 13887/2196017 [00:01<2:20:44, 258.40it/s]  1%|          | 15509/2196017 [00:01<1:39:07, 366.64it/s]  1%|          | 17115/2196017 [00:01<1:10:00, 518.69it/s]  1%|          | 18762/2196017 [00:01<49:37, 731.12it/s]    1%|          | 20400/2196017 [00:01<35:22, 1024.84it/s]  1%|          | 22123/2196017 [00:01<25:22, 1427.63it/s]  1%|          | 23856/2196017 [00:01<18:22, 1969.90it/s]  1%|          | 25585/2196017 [00:01<13:28, 2683.01it/s]  1%|          | 27375/2196017 [00:01<10:02, 3601.44it/s]  1%|▏         | 29153/2196017 [00:02<07:37, 4733.96it/s]  1%|▏         | 31031/2196017 [00:02<05:54, 6103.13it/s]  2%|▏         | 32990/2196017 [00:02<04:41, 7691.52it/s]  2%|▏         | 34994/2196017 [00:02<03:49, 9435.72it/s]  2%|▏         | 36929/2196017 [00:02<03:13, 11149.48it/s]  2%|▏         | 38908/2196017 [00:02<02:48, 12829.26it/s]  2%|▏         | 40949/2196017 [00:02<02:29, 14437.94it/s]  2%|▏         | 43036/2196017 [00:02<02:15, 15907.94it/s]  2%|▏         | 45253/2196017 [00:02<02:03, 17377.25it/s]  2%|▏         | 47525/2196017 [00:02<01:54, 18696.01it/s]  2%|▏         | 49708/2196017 [00:03<01:49, 19534.15it/s]  2%|▏         | 51971/2196017 [00:03<01:45, 20366.07it/s]  2%|▏         | 54222/2196017 [00:03<01:42, 20960.48it/s]  3%|▎         | 56534/2196017 [00:03<01:39, 21561.48it/s]  3%|▎         | 58929/2196017 [00:03<01:36, 22221.21it/s]  3%|▎         | 61349/2196017 [00:03<01:33, 22778.59it/s]  3%|▎         | 63847/2196017 [00:03<01:31, 23396.20it/s]  3%|▎         | 66401/2196017 [00:03<01:28, 23998.16it/s]  3%|▎         | 68956/2196017 [00:03<01:27, 24443.46it/s]  3%|▎         | 71620/2196017 [00:03<01:24, 25060.29it/s]  3%|▎         | 74326/2196017 [00:04<01:22, 25627.47it/s]  4%|▎         | 77201/2196017 [00:04<01:20, 26484.46it/s]  4%|▎         | 80107/2196017 [00:04<01:17, 27206.75it/s]  4%|▍         | 82846/2196017 [00:04<01:17, 27202.80it/s]  4%|▍         | 85826/2196017 [00:04<01:15, 27932.50it/s]  4%|▍         | 88793/2196017 [00:04<01:14, 28429.38it/s]  4%|▍         | 91831/2196017 [00:04<01:12, 28986.35it/s]  4%|▍         | 94981/2196017 [00:04<01:10, 29696.68it/s]  4%|▍         | 98082/2196017 [00:04<01:09, 30077.60it/s]  5%|▍         | 101310/2196017 [00:04<01:08, 30705.40it/s]  5%|▍         | 104672/2196017 [00:05<01:06, 31524.89it/s]  5%|▍         | 108025/2196017 [00:05<01:05, 32100.02it/s]  5%|▌         | 111402/2196017 [00:05<01:03, 32583.04it/s]  5%|▌         | 114904/2196017 [00:05<01:02, 33277.22it/s]  5%|▌         | 118444/2196017 [00:05<01:01, 33877.15it/s]  6%|▌         | 122032/2196017 [00:05<01:00, 34453.14it/s]  6%|▌         | 125535/2196017 [00:05<00:59, 34623.05it/s]  6%|▌         | 129238/2196017 [00:05<00:58, 35311.52it/s]  6%|▌         | 132989/2196017 [00:05<00:57, 35942.35it/s]  6%|▌         | 136796/2196017 [00:05<00:56, 36554.15it/s]  6%|▋         | 140549/2196017 [00:06<00:55, 36840.85it/s]  7%|▋         | 144405/2196017 [00:06<00:54, 37331.50it/s]  7%|▋         | 148218/2196017 [00:06<00:54, 37566.52it/s]  7%|▋         | 152193/2196017 [00:06<00:53, 38192.92it/s]  7%|▋         | 156169/2196017 [00:06<00:52, 38647.56it/s]  7%|▋         | 160288/2196017 [00:06<00:51, 39375.25it/s]  7%|▋         | 164419/2196017 [00:06<00:50, 39931.66it/s]  8%|▊         | 168441/2196017 [00:06<00:50, 40017.37it/s]  8%|▊         | 172632/2196017 [00:06<00:49, 40566.55it/s]  8%|▊         | 176779/2196017 [00:06<00:49, 40833.06it/s]  8%|▊         | 180883/2196017 [00:07<00:49, 40893.98it/s]  8%|▊         | 185213/2196017 [00:07<00:48, 41584.33it/s]  9%|▊         | 189428/2196017 [00:07<00:48, 41752.15it/s]  9%|▉         | 193727/2196017 [00:07<00:47, 42113.75it/s]  9%|▉         | 198142/2196017 [00:07<00:46, 42704.14it/s]  9%|▉         | 202563/2196017 [00:07<00:46, 43144.21it/s]  9%|▉         | 207019/2196017 [00:07<00:45, 43550.07it/s] 10%|▉         | 211535/2196017 [00:07<00:45, 44016.59it/s] 10%|▉         | 215957/2196017 [00:07<00:44, 44075.29it/s] 10%|█         | 220465/2196017 [00:07<00:44, 44370.32it/s] 10%|█         | 224937/2196017 [00:08<00:44, 44472.80it/s] 10%|█         | 229478/2196017 [00:08<00:43, 44747.90it/s] 11%|█         | 234153/2196017 [00:08<00:43, 45327.50it/s] 11%|█         | 238689/2196017 [00:08<00:44, 44478.53it/s] 11%|█         | 243295/2196017 [00:08<00:43, 44941.40it/s] 11%|█▏        | 247979/2196017 [00:08<00:42, 45492.58it/s] 12%|█▏        | 252689/2196017 [00:08<00:42, 45951.25it/s] 12%|█▏        | 257444/2196017 [00:08<00:41, 46417.51it/s] 12%|█▏        | 262091/2196017 [00:08<00:41, 46350.51it/s] 12%|█▏        | 266757/2196017 [00:08<00:41, 46440.59it/s] 12%|█▏        | 271404/2196017 [00:09<00:41, 46389.66it/s] 13%|█▎        | 276068/2196017 [00:09<00:41, 46464.39it/s] 13%|█▎        | 280881/2196017 [00:09<00:40, 46951.07it/s] 13%|█▎        | 285742/2196017 [00:09<00:40, 47435.66it/s] 13%|█▎        | 290489/2196017 [00:09<00:40, 47174.95it/s] 13%|█▎        | 295209/2196017 [00:09<00:40, 47138.16it/s] 14%|█▎        | 300090/2196017 [00:09<00:39, 47625.51it/s] 14%|█▍        | 304925/2196017 [00:09<00:39, 47838.55it/s] 14%|█▍        | 309793/2196017 [00:09<00:39, 48086.60it/s] 14%|█▍        | 314604/2196017 [00:09<00:39, 47916.95it/s] 15%|█▍        | 319450/2196017 [00:10<00:39, 48077.47it/s] 15%|█▍        | 324381/2196017 [00:10<00:38, 48425.04it/s] 15%|█▍        | 329225/2196017 [00:10<00:38, 48382.94it/s] 15%|█▌        | 334125/2196017 [00:10<00:38, 48557.62it/s] 15%|█▌        | 339116/2196017 [00:10<00:37, 48939.45it/s] 16%|█▌        | 344045/2196017 [00:10<00:37, 49043.79it/s] 16%|█▌        | 348989/2196017 [00:10<00:37, 49159.97it/s] 16%|█▌        | 353908/2196017 [00:10<00:37, 49162.45it/s] 16%|█▋        | 358872/2196017 [00:10<00:37, 49302.73it/s] 17%|█▋        | 363942/2196017 [00:10<00:36, 49707.95it/s] 17%|█▋        | 369036/2196017 [00:11<00:36, 50068.92it/s] 17%|█▋        | 374192/2196017 [00:11<00:36, 50505.32it/s] 17%|█▋        | 379245/2196017 [00:11<00:36, 50453.50it/s] 17%|█▋        | 384292/2196017 [00:11<00:35, 50432.93it/s] 18%|█▊        | 389353/2196017 [00:11<00:35, 50483.27it/s] 18%|█▊        | 394402/2196017 [00:11<00:35, 50175.08it/s] 18%|█▊        | 399421/2196017 [00:11<00:35, 50042.22it/s] 18%|█▊        | 404450/2196017 [00:11<00:35, 50116.24it/s] 19%|█▊        | 409474/2196017 [00:11<00:35, 50151.21it/s] 19%|█▉        | 414511/2196017 [00:11<00:35, 50214.08it/s] 19%|█▉        | 419626/2196017 [00:12<00:35, 50489.83it/s] 19%|█▉        | 424676/2196017 [00:12<00:35, 50474.49it/s] 20%|█▉        | 429757/2196017 [00:12<00:34, 50574.54it/s] 20%|█▉        | 434867/2196017 [00:12<00:34, 50730.52it/s] 20%|██        | 439941/2196017 [00:12<00:34, 50503.48it/s] 20%|██        | 445123/2196017 [00:12<00:34, 50889.16it/s] 21%|██        | 450213/2196017 [00:12<00:34, 50864.60it/s] 21%|██        | 455354/2196017 [00:12<00:34, 51025.24it/s] 21%|██        | 460487/2196017 [00:12<00:33, 51115.21it/s] 21%|██        | 465599/2196017 [00:12<00:33, 50999.25it/s] 21%|██▏       | 470772/2196017 [00:13<00:33, 51214.97it/s] 22%|██▏       | 475894/2196017 [00:13<00:33, 51179.82it/s] 22%|██▏       | 481013/2196017 [00:13<00:33, 51074.51it/s] 22%|██▏       | 486191/2196017 [00:13<00:33, 51283.93it/s] 22%|██▏       | 491354/2196017 [00:13<00:33, 51386.40it/s] 23%|██▎       | 496542/2196017 [00:13<00:32, 51531.45it/s] 23%|██▎       | 501736/2196017 [00:13<00:32, 51652.55it/s] 23%|██▎       | 506923/2196017 [00:13<00:32, 51716.13it/s] 23%|██▎       | 512138/2196017 [00:13<00:32, 51844.18it/s] 24%|██▎       | 517364/2196017 [00:13<00:32, 51967.69it/s] 24%|██▍       | 522562/2196017 [00:14<00:32, 51532.77it/s] 24%|██▍       | 527724/2196017 [00:14<00:32, 51554.73it/s] 24%|██▍       | 532919/2196017 [00:14<00:32, 51672.58it/s] 25%|██▍       | 538087/2196017 [00:14<00:32, 51594.82it/s] 25%|██▍       | 543351/2196017 [00:14<00:31, 51903.82it/s] 25%|██▍       | 548551/2196017 [00:14<00:31, 51930.50it/s] 25%|██▌       | 553780/2196017 [00:14<00:31, 52036.55it/s] 25%|██▌       | 559032/2196017 [00:14<00:31, 52180.33it/s] 26%|██▌       | 564251/2196017 [00:14<00:31, 51913.37it/s] 26%|██▌       | 569443/2196017 [00:14<00:31, 51801.23it/s] 26%|██▌       | 574629/2196017 [00:15<00:31, 51816.08it/s] 26%|██▋       | 579811/2196017 [00:15<00:31, 51716.41it/s] 27%|██▋       | 585097/2196017 [00:15<00:30, 52052.80it/s] 27%|██▋       | 590303/2196017 [00:15<00:30, 51875.67it/s] 27%|██▋       | 595541/2196017 [00:15<00:30, 52024.44it/s] 27%|██▋       | 600768/2196017 [00:15<00:30, 52095.28it/s] 28%|██▊       | 605978/2196017 [00:15<00:30, 51748.48it/s] 28%|██▊       | 611154/2196017 [00:15<00:30, 51529.66it/s] 28%|██▊       | 616308/2196017 [00:15<00:30, 51512.00it/s] 28%|██▊       | 621460/2196017 [00:15<00:30, 51319.38it/s] 29%|██▊       | 626741/2196017 [00:16<00:30, 51755.74it/s] 29%|██▉       | 632000/2196017 [00:16<00:30, 52002.84it/s] 29%|██▉       | 637222/2196017 [00:16<00:29, 52066.85it/s] 29%|██▉       | 642455/2196017 [00:16<00:29, 52141.44it/s] 29%|██▉       | 647670/2196017 [00:16<00:29, 51910.43it/s] 30%|██▉       | 652862/2196017 [00:16<00:29, 51553.84it/s] 30%|██▉       | 658162/2196017 [00:16<00:29, 51976.94it/s] 30%|███       | 663362/2196017 [00:16<00:29, 51921.17it/s] 30%|███       | 668621/2196017 [00:16<00:29, 52119.30it/s] 31%|███       | 673885/2196017 [00:16<00:29, 52273.07it/s] 31%|███       | 679193/2196017 [00:17<00:28, 52510.94it/s] 31%|███       | 684491/2196017 [00:17<00:28, 52650.24it/s] 31%|███▏      | 689768/2196017 [00:17<00:28, 52686.01it/s] 32%|███▏      | 695076/2196017 [00:17<00:28, 52801.62it/s] 32%|███▏      | 700460/2196017 [00:17<00:28, 53091.95it/s] 32%|███▏      | 705770/2196017 [00:17<00:28, 52844.94it/s] 32%|███▏      | 711153/2196017 [00:17<00:27, 53136.29it/s] 33%|███▎      | 716468/2196017 [00:17<00:27, 53091.36it/s] 33%|███▎      | 721778/2196017 [00:17<00:27, 52932.93it/s] 33%|███▎      | 727113/2196017 [00:17<00:27, 53056.93it/s] 33%|███▎      | 732420/2196017 [00:18<00:27, 52813.55it/s] 34%|███▎      | 737799/2196017 [00:18<00:27, 53101.75it/s] 34%|███▍      | 743124/2196017 [00:18<00:27, 53144.79it/s] 34%|███▍      | 748449/2196017 [00:18<00:27, 53174.95it/s] 34%|███▍      | 753767/2196017 [00:18<00:27, 53081.65it/s] 35%|███▍      | 759076/2196017 [00:18<00:27, 52874.45it/s] 35%|███▍      | 764378/2196017 [00:18<00:27, 52915.33it/s] 35%|███▌      | 769703/2196017 [00:18<00:26, 53014.09it/s] 35%|███▌      | 775005/2196017 [00:18<00:26, 52947.26it/s] 36%|███▌      | 780342/2196017 [00:18<00:26, 53071.20it/s] 36%|███▌      | 785672/2196017 [00:19<00:26, 53137.11it/s] 36%|███▌      | 790986/2196017 [00:19<00:26, 53002.62it/s] 36%|███▋      | 796328/2196017 [00:19<00:26, 53126.75it/s] 37%|███▋      | 801675/2196017 [00:19<00:26, 53226.81it/s] 37%|███▋      | 806998/2196017 [00:19<00:26, 53215.22it/s] 37%|███▋      | 812320/2196017 [00:19<00:26, 53205.10it/s] 37%|███▋      | 817641/2196017 [00:19<00:26, 52906.22it/s] 37%|███▋      | 822962/2196017 [00:19<00:25, 52996.97it/s] 38%|███▊      | 828300/2196017 [00:19<00:25, 53110.67it/s] 38%|███▊      | 833612/2196017 [00:19<00:25, 52862.46it/s] 38%|███▊      | 838992/2196017 [00:20<00:25, 53139.46it/s] 38%|███▊      | 844361/2196017 [00:20<00:25, 53301.71it/s] 39%|███▊      | 849692/2196017 [00:20<00:25, 53297.42it/s] 39%|███▉      | 855075/2196017 [00:20<00:25, 53456.03it/s] 39%|███▉      | 860422/2196017 [00:20<00:25, 53088.03it/s] 39%|███▉      | 865732/2196017 [00:20<00:25, 52617.58it/s] 40%|███▉      | 870996/2196017 [00:20<00:25, 52426.39it/s] 40%|███▉      | 876288/2196017 [00:20<00:25, 52572.25it/s] 40%|████      | 881654/2196017 [00:20<00:24, 52892.51it/s] 40%|████      | 886997/2196017 [00:20<00:24, 53052.48it/s] 41%|████      | 892304/2196017 [00:21<00:24, 52980.20it/s] 41%|████      | 897646/2196017 [00:21<00:24, 53111.20it/s] 41%|████      | 902958/2196017 [00:21<00:24, 52893.40it/s] 41%|████▏     | 908280/2196017 [00:21<00:24, 52988.71it/s] 42%|████▏     | 913649/2196017 [00:21<00:24, 53194.99it/s] 42%|████▏     | 918970/2196017 [00:21<00:24, 53193.27it/s] 42%|████▏     | 924290/2196017 [00:21<00:23, 53066.76it/s] 42%|████▏     | 929690/2196017 [00:21<00:23, 53343.30it/s] 43%|████▎     | 935025/2196017 [00:21<00:23, 53321.87it/s] 43%|████▎     | 940460/2196017 [00:21<00:23, 53626.18it/s] 43%|████▎     | 945888/2196017 [00:22<00:23, 53819.35it/s] 43%|████▎     | 951294/2196017 [00:22<00:23, 53888.53it/s] 44%|████▎     | 956695/2196017 [00:22<00:22, 53923.19it/s] 44%|████▍     | 962088/2196017 [00:22<00:23, 53649.07it/s] 44%|████▍     | 967487/2196017 [00:22<00:22, 53748.73it/s] 44%|████▍     | 972923/2196017 [00:22<00:22, 53929.84it/s] 45%|████▍     | 978317/2196017 [00:22<00:22, 53738.05it/s] 45%|████▍     | 983692/2196017 [00:22<00:22, 53506.89it/s] 45%|████▌     | 989044/2196017 [00:22<00:22, 53347.78it/s] 45%|████▌     | 994455/2196017 [00:23<00:22, 53571.77it/s] 46%|████▌     | 999874/2196017 [00:23<00:22, 53752.99it/s] 46%|████▌     | 1005250/2196017 [00:23<00:22, 53549.22it/s] 46%|████▌     | 1010634/2196017 [00:23<00:22, 53633.92it/s] 46%|████▋     | 1015998/2196017 [00:23<00:22, 53570.32it/s] 47%|████▋     | 1021358/2196017 [00:23<00:21, 53577.51it/s] 47%|████▋     | 1026716/2196017 [00:23<00:21, 53577.28it/s] 47%|████▋     | 1032079/2196017 [00:23<00:21, 53590.76it/s] 47%|████▋     | 1037439/2196017 [00:23<00:21, 53525.33it/s] 47%|████▋     | 1042843/2196017 [00:23<00:21, 53676.62it/s] 48%|████▊     | 1048211/2196017 [00:24<00:21, 53440.90it/s] 48%|████▊     | 1053638/2196017 [00:24<00:21, 53686.63it/s] 48%|████▊     | 1059022/2196017 [00:24<00:21, 53730.65it/s] 48%|████▊     | 1064396/2196017 [00:24<00:21, 53535.22it/s] 49%|████▊     | 1069805/2196017 [00:24<00:20, 53699.97it/s] 49%|████▉     | 1075176/2196017 [00:24<00:20, 53427.09it/s] 49%|████▉     | 1080520/2196017 [00:24<00:20, 53194.70it/s] 49%|████▉     | 1085841/2196017 [00:24<00:21, 52771.14it/s] 50%|████▉     | 1091190/2196017 [00:24<00:20, 52982.79it/s] 50%|████▉     | 1096615/2196017 [00:24<00:20, 53354.57it/s] 50%|█████     | 1102030/2196017 [00:25<00:20, 53589.53it/s] 50%|█████     | 1107391/2196017 [00:25<00:20, 53291.29it/s] 51%|█████     | 1112822/2196017 [00:25<00:20, 53589.25it/s] 51%|█████     | 1118243/2196017 [00:25<00:20, 53771.48it/s] 51%|█████     | 1123622/2196017 [00:25<00:20, 53604.21it/s] 51%|█████▏    | 1128984/2196017 [00:25<00:19, 53577.35it/s] 52%|█████▏    | 1134424/2196017 [00:25<00:19, 53820.43it/s] 52%|█████▏    | 1139807/2196017 [00:25<00:19, 53790.04it/s] 52%|█████▏    | 1145187/2196017 [00:25<00:19, 53788.12it/s] 52%|█████▏    | 1150637/2196017 [00:25<00:19, 53998.40it/s] 53%|█████▎    | 1156074/2196017 [00:26<00:19, 54107.17it/s] 53%|█████▎    | 1161486/2196017 [00:26<00:19, 53812.29it/s] 53%|█████▎    | 1166868/2196017 [00:26<00:19, 53663.10it/s] 53%|█████▎    | 1172292/2196017 [00:26<00:19, 53833.59it/s] 54%|█████▎    | 1177676/2196017 [00:26<00:18, 53818.63it/s] 54%|█████▍    | 1183125/2196017 [00:26<00:18, 54015.86it/s] 54%|█████▍    | 1188560/2196017 [00:26<00:18, 54113.53it/s] 54%|█████▍    | 1193972/2196017 [00:26<00:18, 54044.02it/s] 55%|█████▍    | 1199423/2196017 [00:26<00:18, 54182.53it/s] 55%|█████▍    | 1204842/2196017 [00:26<00:18, 54124.55it/s] 55%|█████▌    | 1210255/2196017 [00:27<00:18, 53729.44it/s] 55%|█████▌    | 1215652/2196017 [00:27<00:18, 53798.79it/s] 56%|█████▌    | 1221059/2196017 [00:27<00:18, 53878.00it/s] 56%|█████▌    | 1226498/2196017 [00:27<00:17, 54029.83it/s] 56%|█████▌    | 1231955/2196017 [00:27<00:17, 54189.77it/s] 56%|█████▋    | 1237375/2196017 [00:27<00:17, 54022.86it/s] 57%|█████▋    | 1242792/2196017 [00:27<00:17, 54065.20it/s] 57%|█████▋    | 1248199/2196017 [00:27<00:17, 53834.25it/s] 57%|█████▋    | 1253583/2196017 [00:27<00:17, 53655.90it/s] 57%|█████▋    | 1258994/2196017 [00:27<00:17, 53791.03it/s] 58%|█████▊    | 1264435/2196017 [00:28<00:17, 53974.26it/s] 58%|█████▊    | 1269850/2196017 [00:28<00:17, 54026.18it/s] 58%|█████▊    | 1275311/2196017 [00:28<00:16, 54199.49it/s] 58%|█████▊    | 1280732/2196017 [00:28<00:16, 54051.48it/s] 59%|█████▊    | 1286138/2196017 [00:28<00:16, 53942.63it/s] 59%|█████▉    | 1291586/2196017 [00:28<00:16, 54102.17it/s] 59%|█████▉    | 1297037/2196017 [00:28<00:16, 54223.35it/s] 59%|█████▉    | 1302460/2196017 [00:28<00:16, 53833.84it/s] 60%|█████▉    | 1307845/2196017 [00:28<00:16, 53715.59it/s] 60%|█████▉    | 1313292/2196017 [00:28<00:16, 53938.77it/s] 60%|██████    | 1318788/2196017 [00:29<00:16, 54240.23it/s] 60%|██████    | 1324213/2196017 [00:29<00:16, 54018.99it/s] 61%|██████    | 1329616/2196017 [00:29<00:16, 54003.85it/s] 61%|██████    | 1335060/2196017 [00:29<00:15, 54132.93it/s] 61%|██████    | 1340474/2196017 [00:29<00:15, 53985.22it/s] 61%|██████▏   | 1345915/2196017 [00:29<00:15, 54109.97it/s] 62%|██████▏   | 1351407/2196017 [00:29<00:15, 54347.71it/s] 62%|██████▏   | 1356843/2196017 [00:29<00:15, 54146.41it/s] 62%|██████▏   | 1362262/2196017 [00:29<00:15, 54156.09it/s] 62%|██████▏   | 1367694/2196017 [00:29<00:15, 54204.44it/s] 63%|██████▎   | 1373131/2196017 [00:30<00:15, 54253.01it/s] 63%|██████▎   | 1378557/2196017 [00:30<00:15, 54208.17it/s] 63%|██████▎   | 1383978/2196017 [00:30<00:14, 54186.06it/s] 63%|██████▎   | 1389401/2196017 [00:30<00:14, 54197.94it/s] 64%|██████▎   | 1394859/2196017 [00:30<00:14, 54311.97it/s] 64%|██████▍   | 1400291/2196017 [00:30<00:14, 54231.90it/s] 64%|██████▍   | 1405721/2196017 [00:30<00:14, 54248.60it/s] 64%|██████▍   | 1411146/2196017 [00:30<00:14, 54199.65it/s] 65%|██████▍   | 1416573/2196017 [00:30<00:14, 54218.16it/s] 65%|██████▍   | 1422009/2196017 [00:30<00:14, 54259.72it/s] 65%|██████▌   | 1427436/2196017 [00:31<00:14, 53845.01it/s] 65%|██████▌   | 1432874/2196017 [00:31<00:14, 54001.69it/s] 65%|██████▌   | 1438344/2196017 [00:31<00:13, 54206.82it/s] 66%|██████▌   | 1443815/2196017 [00:31<00:13, 54356.70it/s] 66%|██████▌   | 1449271/2196017 [00:31<00:13, 54414.71it/s] 66%|██████▌   | 1454713/2196017 [00:31<00:13, 54352.68it/s] 66%|██████▋   | 1460149/2196017 [00:31<00:13, 54190.18it/s] 67%|██████▋   | 1465647/2196017 [00:31<00:13, 54423.74it/s] 67%|██████▋   | 1471090/2196017 [00:31<00:13, 54218.64it/s] 67%|██████▋   | 1476568/2196017 [00:31<00:13, 54384.77it/s] 67%|██████▋   | 1482007/2196017 [00:32<00:13, 54324.23it/s] 68%|██████▊   | 1487440/2196017 [00:32<00:13, 54083.49it/s] 68%|██████▊   | 1492911/2196017 [00:32<00:12, 54268.17it/s] 68%|██████▊   | 1498424/2196017 [00:32<00:12, 54522.08it/s] 68%|██████▊   | 1503877/2196017 [00:32<00:12, 54394.73it/s] 69%|██████▊   | 1509317/2196017 [00:32<00:12, 54342.93it/s] 69%|██████▉   | 1514752/2196017 [00:32<00:12, 54001.60it/s] 69%|██████▉   | 1520202/2196017 [00:32<00:12, 54148.14it/s] 69%|██████▉   | 1525618/2196017 [00:32<00:12, 53673.18it/s] 70%|██████▉   | 1530989/2196017 [00:32<00:12, 53681.78it/s] 70%|██████▉   | 1536432/2196017 [00:33<00:12, 53901.72it/s] 70%|███████   | 1541946/2196017 [00:33<00:12, 54264.52it/s] 70%|███████   | 1547462/2196017 [00:33<00:11, 54528.30it/s] 71%|███████   | 1552969/2196017 [00:33<00:11, 54686.90it/s] 71%|███████   | 1558439/2196017 [00:33<00:11, 54439.12it/s] 71%|███████   | 1563884/2196017 [00:33<00:11, 54271.54it/s] 71%|███████▏  | 1569355/2196017 [00:33<00:11, 54400.11it/s] 72%|███████▏  | 1574796/2196017 [00:33<00:11, 54394.15it/s] 72%|███████▏  | 1580249/2196017 [00:33<00:11, 54433.10it/s] 72%|███████▏  | 1585717/2196017 [00:33<00:11, 54506.44it/s] 72%|███████▏  | 1591168/2196017 [00:34<00:11, 54467.44it/s] 73%|███████▎  | 1596622/2196017 [00:34<00:11, 54462.23it/s] 73%|███████▎  | 1602069/2196017 [00:34<00:10, 54293.69it/s] 73%|███████▎  | 1607552/2196017 [00:34<00:10, 54452.99it/s] 73%|███████▎  | 1613039/2196017 [00:34<00:10, 54577.21it/s] 74%|███████▎  | 1618504/2196017 [00:34<00:10, 54598.30it/s] 74%|███████▍  | 1623969/2196017 [00:34<00:10, 54611.82it/s] 74%|███████▍  | 1629445/2196017 [00:34<00:10, 54655.90it/s] 74%|███████▍  | 1634911/2196017 [00:34<00:10, 54589.79it/s] 75%|███████▍  | 1640433/2196017 [00:34<00:10, 54774.40it/s] 75%|███████▍  | 1645911/2196017 [00:35<00:10, 54576.44it/s] 75%|███████▌  | 1651369/2196017 [00:35<00:09, 54516.27it/s] 75%|███████▌  | 1656821/2196017 [00:35<00:09, 54396.87it/s] 76%|███████▌  | 1662261/2196017 [00:35<00:09, 54321.83it/s] 76%|███████▌  | 1667709/2196017 [00:35<00:09, 54367.14it/s] 76%|███████▌  | 1673164/2196017 [00:35<00:09, 54419.64it/s] 76%|███████▋  | 1678607/2196017 [00:35<00:09, 54130.91it/s] 77%|███████▋  | 1684082/2196017 [00:35<00:09, 54313.13it/s] 77%|███████▋  | 1689514/2196017 [00:35<00:09, 54290.63it/s] 77%|███████▋  | 1694967/2196017 [00:35<00:09, 54360.96it/s] 77%|███████▋  | 1700448/2196017 [00:36<00:09, 54492.47it/s] 78%|███████▊  | 1705898/2196017 [00:36<00:09, 54407.82it/s] 78%|███████▊  | 1711380/2196017 [00:36<00:08, 54529.09it/s] 78%|███████▊  | 1716834/2196017 [00:36<00:08, 54360.97it/s] 78%|███████▊  | 1722271/2196017 [00:36<00:08, 53942.96it/s] 79%|███████▊  | 1727679/2196017 [00:36<00:08, 53983.05it/s] 79%|███████▉  | 1733098/2196017 [00:36<00:08, 54043.02it/s] 79%|███████▉  | 1738503/2196017 [00:36<00:08, 54036.43it/s] 79%|███████▉  | 1743907/2196017 [00:36<00:08, 53698.89it/s] 80%|███████▉  | 1749292/2196017 [00:36<00:08, 53743.72it/s] 80%|███████▉  | 1754705/2196017 [00:37<00:08, 53858.97it/s] 80%|████████  | 1760131/2196017 [00:37<00:08, 53977.13it/s] 80%|████████  | 1765581/2196017 [00:37<00:07, 54131.18it/s] 81%|████████  | 1770995/2196017 [00:37<00:07, 54057.33it/s] 81%|████████  | 1776428/2196017 [00:37<00:07, 54135.70it/s] 81%|████████  | 1781842/2196017 [00:37<00:07, 54065.62it/s] 81%|████████▏ | 1787348/2196017 [00:37<00:07, 54359.47it/s] 82%|████████▏ | 1792815/2196017 [00:37<00:07, 54451.34it/s] 82%|████████▏ | 1798261/2196017 [00:37<00:07, 54309.89it/s] 82%|████████▏ | 1803730/2196017 [00:37<00:07, 54422.26it/s] 82%|████████▏ | 1809188/2196017 [00:38<00:07, 54468.18it/s] 83%|████████▎ | 1814657/2196017 [00:38<00:06, 54533.39it/s] 83%|████████▎ | 1820111/2196017 [00:38<00:06, 54493.18it/s] 83%|████████▎ | 1825561/2196017 [00:38<00:06, 54354.63it/s] 83%|████████▎ | 1830997/2196017 [00:38<00:06, 54289.47it/s] 84%|████████▎ | 1836444/2196017 [00:38<00:06, 54340.69it/s] 84%|████████▍ | 1841879/2196017 [00:38<00:06, 54213.34it/s] 84%|████████▍ | 1847301/2196017 [00:38<00:06, 54153.12it/s] 84%|████████▍ | 1852771/2196017 [00:38<00:06, 54315.39it/s] 85%|████████▍ | 1858227/2196017 [00:38<00:06, 54387.12it/s] 85%|████████▍ | 1863666/2196017 [00:39<00:06, 54288.48it/s] 85%|████████▌ | 1869096/2196017 [00:39<00:06, 54037.36it/s] 85%|████████▌ | 1874613/2196017 [00:39<00:05, 54370.95it/s] 86%|████████▌ | 1880082/2196017 [00:39<00:05, 54465.32it/s] 86%|████████▌ | 1885551/2196017 [00:39<00:05, 54531.85it/s] 86%|████████▌ | 1891091/2196017 [00:39<00:05, 54787.81it/s] 86%|████████▋ | 1896571/2196017 [00:39<00:05, 54674.65it/s] 87%|████████▋ | 1902039/2196017 [00:39<00:05, 54651.53it/s] 87%|████████▋ | 1907505/2196017 [00:39<00:05, 54438.16it/s] 87%|████████▋ | 1912950/2196017 [00:39<00:05, 54360.17it/s] 87%|████████▋ | 1918424/2196017 [00:40<00:05, 54473.23it/s] 88%|████████▊ | 1923916/2196017 [00:40<00:04, 54604.03it/s] 88%|████████▊ | 1929377/2196017 [00:40<00:04, 54467.74it/s] 88%|████████▊ | 1934911/2196017 [00:40<00:04, 54726.30it/s] 88%|████████▊ | 1940385/2196017 [00:40<00:04, 54679.43it/s] 89%|████████▊ | 1945854/2196017 [00:40<00:04, 54603.11it/s] 89%|████████▉ | 1951315/2196017 [00:40<00:04, 54562.11it/s] 89%|████████▉ | 1956772/2196017 [00:40<00:04, 54376.35it/s] 89%|████████▉ | 1962262/2196017 [00:40<00:04, 54532.25it/s] 90%|████████▉ | 1967716/2196017 [00:40<00:04, 54062.84it/s] 90%|████████▉ | 1973124/2196017 [00:41<00:04, 53904.10it/s] 90%|█████████ | 1978576/2196017 [00:41<00:04, 54084.47it/s] 90%|█████████ | 1983986/2196017 [00:41<00:03, 53982.29it/s] 91%|█████████ | 1989386/2196017 [00:41<00:03, 53987.07it/s] 91%|█████████ | 1994865/2196017 [00:41<00:03, 54222.72it/s] 91%|█████████ | 2000311/2196017 [00:41<00:03, 54290.95it/s] 91%|█████████▏| 2005748/2196017 [00:41<00:03, 54312.84it/s] 92%|█████████▏| 2011272/2196017 [00:41<00:03, 54585.25it/s] 92%|█████████▏| 2016771/2196017 [00:41<00:03, 54704.85it/s] 92%|█████████▏| 2022298/2196017 [00:41<00:03, 54870.94it/s] 92%|█████████▏| 2027790/2196017 [00:42<00:03, 54885.15it/s] 93%|█████████▎| 2033279/2196017 [00:42<00:02, 54798.87it/s] 93%|█████████▎| 2038819/2196017 [00:42<00:02, 54977.69it/s] 93%|█████████▎| 2044318/2196017 [00:42<00:02, 54590.14it/s] 93%|█████████▎| 2049855/2196017 [00:42<00:02, 54821.30it/s] 94%|█████████▎| 2055403/2196017 [00:42<00:02, 55014.78it/s] 94%|█████████▍| 2060906/2196017 [00:42<00:02, 54951.92it/s] 94%|█████████▍| 2066441/2196017 [00:42<00:02, 55067.94it/s] 94%|█████████▍| 2071966/2196017 [00:42<00:02, 55119.85it/s] 95%|█████████▍| 2077479/2196017 [00:42<00:02, 55001.17it/s] 95%|█████████▍| 2083016/2196017 [00:43<00:02, 55108.96it/s] 95%|█████████▌| 2088528/2196017 [00:43<00:01, 54932.64it/s] 95%|█████████▌| 2094022/2196017 [00:43<00:01, 54931.99it/s] 96%|█████████▌| 2099518/2196017 [00:43<00:01, 54937.58it/s] 96%|█████████▌| 2105012/2196017 [00:43<00:01, 54928.97it/s] 96%|█████████▌| 2110510/2196017 [00:43<00:01, 54943.19it/s] 96%|█████████▋| 2116016/2196017 [00:43<00:01, 54976.82it/s] 97%|█████████▋| 2121514/2196017 [00:43<00:01, 54946.23it/s] 97%|█████████▋| 2127009/2196017 [00:43<00:01, 54685.40it/s] 97%|█████████▋| 2132478/2196017 [00:43<00:01, 54363.92it/s] 97%|█████████▋| 2137942/2196017 [00:44<00:01, 54445.96it/s] 98%|█████████▊| 2143404/2196017 [00:44<00:00, 54495.97it/s] 98%|█████████▊| 2148854/2196017 [00:44<00:00, 54450.27it/s] 98%|█████████▊| 2154381/2196017 [00:44<00:00, 54692.67it/s] 98%|█████████▊| 2159879/2196017 [00:44<00:00, 54774.94it/s] 99%|█████████▊| 2165357/2196017 [00:44<00:00, 54700.07it/s] 99%|█████████▉| 2170905/2196017 [00:44<00:00, 54930.12it/s] 99%|█████████▉| 2176420/2196017 [00:44<00:00, 54995.09it/s] 99%|█████████▉| 2181979/2196017 [00:44<00:00, 55170.51it/s]100%|█████████▉| 2187497/2196017 [00:44<00:00, 54774.86it/s]100%|█████████▉| 2192976/2196017 [00:45<00:00, 54564.50it/s]100%|██████████| 2196017/2196017 [00:45<00:00, 48637.23it/s]
[2022-05-31 11:03:23,342] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 11:03:30,337] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f912e0ffa60>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f912e0ffa60>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 11:03:30,347] INFO: Vocab size: 64518
[2022-05-31 11:03:30,348] INFO: Nb labels: 2
[2022-05-31 11:03:30,348] INFO: Total params: 21123803
[2022-05-31 11:03:30,348] INFO: Learnable params: 1768403
[2022-05-31 11:03:30,351] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  2%|▏         | 142/8214 [00:00<00:05, 1416.41ex/s]  6%|▌         | 493/8214 [00:00<00:04, 1724.72ex/s] 10%|▉         | 816/8214 [00:00<00:03, 2003.67ex/s] 12%|█▏        | 1007/8214 [00:00<00:06, 1181.33ex/s] 17%|█▋        | 1358/8214 [00:00<00:04, 1474.76ex/s] 20%|██        | 1683/8214 [00:00<00:03, 1762.83ex/s] 24%|██▍       | 2000/8214 [00:00<00:03, 1926.09ex/s] 29%|██▊       | 2343/8214 [00:01<00:02, 2217.47ex/s] 33%|███▎      | 2671/8214 [00:01<00:02, 2456.02ex/s] 37%|███▋      | 3000/8214 [00:01<00:02, 2484.16ex/s] 41%|████      | 3347/8214 [00:01<00:01, 2713.39ex/s] 45%|████▍     | 3682/8214 [00:01<00:01, 2877.14ex/s] 49%|████▊     | 3995/8214 [00:01<00:01, 2948.17ex/s] 52%|█████▏    | 4307/8214 [00:01<00:01, 2779.41ex/s] 57%|█████▋    | 4648/8214 [00:01<00:01, 2941.41ex/s] 61%|██████    | 4988/8214 [00:01<00:01, 3065.26ex/s] 65%|██████▍   | 5305/8214 [00:02<00:01, 2903.36ex/s] 69%|██████▊   | 5647/8214 [00:02<00:00, 3039.62ex/s] 73%|███████▎  | 5966/8214 [00:02<00:00, 3083.10ex/s] 76%|███████▋  | 6280/8214 [00:02<00:00, 2886.60ex/s] 81%|████████  | 6635/8214 [00:02<00:00, 3056.22ex/s] 85%|████████▍ | 6953/8214 [00:02<00:00, 3091.16ex/s] 88%|████████▊ | 7268/8214 [00:02<00:00, 2626.12ex/s] 93%|█████████▎| 7612/8214 [00:02<00:00, 2825.46ex/s] 97%|█████████▋| 7957/8214 [00:02<00:00, 2987.63ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2710.98ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 27%|██▋       | 363/1369 [00:00<00:00, 3627.05ex/s] 50%|█████     | 686/1369 [00:00<00:00, 3497.60ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2970.83ex/s] 98%|█████████▊| 1347/1369 [00:00<00:00, 3104.82ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3038.10ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  8%|▊         | 107/1369 [00:00<00:01, 1069.82ex/s] 12%|█▏        | 159/1369 [00:00<00:01, 799.53ex/s]  29%|██▉       | 397/1369 [00:00<00:00, 997.83ex/s] 36%|███▌      | 495/1369 [00:00<00:00, 978.79ex/s] 43%|████▎     | 592/1369 [00:00<00:01, 661.49ex/s] 67%|██████▋   | 921/1369 [00:00<00:00, 869.77ex/s] 80%|███████▉  | 1094/1369 [00:00<00:00, 1022.06ex/s]100%|██████████| 1369/1369 [00:00<00:00, 1439.30ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
numpy.__version__
1.21.4
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 82, in _make_variables
    scores.append(self._ravel(var._scores))
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 52, in _ravel
    return x.view(-1)
TypeError: Cannot interpret '-1' as a data type

                                                                   