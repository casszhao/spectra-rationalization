	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 13:29:48,706] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 13:29:54,274] INFO: Building board loggers...
[2022-05-31 13:29:54,274] INFO: Building callbacks...
[2022-05-31 13:29:54,275] INFO: Building model: spectra...
[2022-05-31 13:29:54,663] INFO: Created a temporary directory at /tmp/tmp6j6huwrf
[2022-05-31 13:29:54,664] INFO: Writing /tmp/tmp6j6huwrf/_remote_module_non_sriptable.py
[2022-05-31 13:29:55,322] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 13:30:05,633] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<86:19:08,  7.07it/s]  0%|          | 1075/2196017 [00:00<60:24:39, 10.09it/s]  0%|          | 2325/2196017 [00:00<42:16:41, 14.41it/s]  0%|          | 3647/2196017 [00:00<29:35:26, 20.58it/s]  0%|          | 4952/2196017 [00:00<20:42:54, 29.38it/s]  0%|          | 6341/2196017 [00:00<14:30:16, 41.93it/s]  0%|          | 7749/2196017 [00:00<10:09:34, 59.83it/s]  0%|          | 9190/2196017 [00:00<7:07:10, 85.32it/s]   0%|          | 10650/2196017 [00:00<4:59:34, 121.58it/s]  1%|          | 12126/2196017 [00:01<3:30:18, 173.08it/s]  1%|          | 13621/2196017 [00:01<2:27:50, 246.03it/s]  1%|          | 15164/2196017 [00:01<1:44:07, 349.08it/s]  1%|          | 16775/2196017 [00:01<1:13:30, 494.10it/s]  1%|          | 18417/2196017 [00:01<52:04, 696.86it/s]    1%|          | 20044/2196017 [00:01<37:05, 977.57it/s]  1%|          | 21761/2196017 [00:01<26:34, 1363.23it/s]  1%|          | 23547/2196017 [00:01<19:12, 1885.76it/s]  1%|          | 25234/2196017 [00:01<14:04, 2570.68it/s]  1%|          | 26998/2196017 [00:01<10:27, 3456.35it/s]  1%|▏         | 28748/2196017 [00:02<07:56, 4552.17it/s]  1%|▏         | 30561/2196017 [00:02<06:08, 5871.26it/s]  1%|▏         | 32443/2196017 [00:02<04:52, 7397.64it/s]  2%|▏         | 34357/2196017 [00:02<03:58, 9066.28it/s]  2%|▏         | 36276/2196017 [00:02<03:20, 10769.91it/s]  2%|▏         | 38195/2196017 [00:02<02:53, 12402.15it/s]  2%|▏         | 40131/2196017 [00:02<02:35, 13900.21it/s]  2%|▏         | 42140/2196017 [00:02<02:20, 15315.75it/s]  2%|▏         | 44232/2196017 [00:02<02:09, 16649.90it/s]  2%|▏         | 46461/2196017 [00:02<01:59, 18013.25it/s]  2%|▏         | 48625/2196017 [00:03<01:53, 18962.52it/s]  2%|▏         | 50731/2196017 [00:03<01:49, 19546.17it/s]  2%|▏         | 52896/2196017 [00:03<01:46, 20132.33it/s]  3%|▎         | 55048/2196017 [00:03<01:44, 20526.38it/s]  3%|▎         | 57405/2196017 [00:03<01:40, 21351.20it/s]  3%|▎         | 59750/2196017 [00:03<01:37, 21939.87it/s]  3%|▎         | 62168/2196017 [00:03<01:34, 22566.27it/s]  3%|▎         | 64684/2196017 [00:03<01:31, 23282.62it/s]  3%|▎         | 67275/2196017 [00:03<01:28, 24012.72it/s]  3%|▎         | 69913/2196017 [00:03<01:26, 24675.60it/s]  3%|▎         | 72523/2196017 [00:04<01:24, 25086.07it/s]  3%|▎         | 75215/2196017 [00:04<01:22, 25603.60it/s]  4%|▎         | 78091/2196017 [00:04<01:19, 26474.34it/s]  4%|▎         | 80968/2196017 [00:04<01:17, 27122.72it/s]  4%|▍         | 83810/2196017 [00:04<01:16, 27498.28it/s]  4%|▍         | 86747/2196017 [00:04<01:15, 28026.99it/s]  4%|▍         | 89612/2196017 [00:04<01:14, 28210.76it/s]  4%|▍         | 92536/2196017 [00:04<01:13, 28511.69it/s]  4%|▍         | 95598/2196017 [00:04<01:12, 29112.25it/s]  4%|▍         | 98558/2196017 [00:04<01:11, 29249.22it/s]  5%|▍         | 101694/2196017 [00:05<01:10, 29850.61it/s]  5%|▍         | 104990/2196017 [00:05<01:08, 30719.94it/s]  5%|▍         | 108356/2196017 [00:05<01:06, 31541.00it/s]  5%|▌         | 111661/2196017 [00:05<01:05, 31978.71it/s]  5%|▌         | 115110/2196017 [00:05<01:03, 32681.97it/s]  5%|▌         | 118626/2196017 [00:05<01:02, 33384.77it/s]  6%|▌         | 122174/2196017 [00:05<01:01, 33986.71it/s]  6%|▌         | 125614/2196017 [00:05<01:00, 34099.28it/s]  6%|▌         | 129223/2196017 [00:05<00:59, 34672.16it/s]  6%|▌         | 132863/2196017 [00:05<00:58, 35164.42it/s]  6%|▌         | 136557/2196017 [00:06<00:57, 35678.62it/s]  6%|▋         | 140321/2196017 [00:06<00:56, 36234.76it/s]  7%|▋         | 144153/2196017 [00:06<00:55, 36834.98it/s]  7%|▋         | 147965/2196017 [00:06<00:55, 37204.16it/s]  7%|▋         | 151836/2196017 [00:06<00:54, 37642.43it/s]  7%|▋         | 155756/2196017 [00:06<00:53, 38094.60it/s]  7%|▋         | 159784/2196017 [00:06<00:52, 38723.69it/s]  7%|▋         | 163709/2196017 [00:06<00:52, 38879.20it/s]  8%|▊         | 167605/2196017 [00:06<00:52, 38900.78it/s]  8%|▊         | 171622/2196017 [00:06<00:51, 39271.38it/s]  8%|▊         | 175612/2196017 [00:07<00:51, 39457.33it/s]  8%|▊         | 179731/2196017 [00:07<00:50, 39960.39it/s]  8%|▊         | 183915/2196017 [00:07<00:49, 40504.23it/s]  9%|▊         | 188147/2196017 [00:07<00:48, 41031.35it/s]  9%|▉         | 192298/2196017 [00:07<00:48, 41171.75it/s]  9%|▉         | 196548/2196017 [00:07<00:48, 41550.19it/s]  9%|▉         | 201041/2196017 [00:07<00:46, 42507.85it/s]  9%|▉         | 205469/2196017 [00:07<00:46, 43017.17it/s] 10%|▉         | 209901/2196017 [00:07<00:45, 43399.61it/s] 10%|▉         | 214277/2196017 [00:07<00:45, 43502.23it/s] 10%|▉         | 218699/2196017 [00:08<00:45, 43712.95it/s] 10%|█         | 223290/2196017 [00:08<00:44, 44347.90it/s] 10%|█         | 227901/2196017 [00:08<00:43, 44861.11it/s] 11%|█         | 232577/2196017 [00:08<00:43, 45413.74it/s] 11%|█         | 237124/2196017 [00:08<00:43, 45140.96it/s] 11%|█         | 241822/2196017 [00:08<00:42, 45677.29it/s] 11%|█         | 246422/2196017 [00:08<00:42, 45771.85it/s] 11%|█▏        | 251009/2196017 [00:08<00:42, 45799.69it/s] 12%|█▏        | 255592/2196017 [00:08<00:42, 45677.39it/s] 12%|█▏        | 260162/2196017 [00:08<00:42, 45519.92it/s] 12%|█▏        | 264716/2196017 [00:09<00:42, 45480.62it/s] 12%|█▏        | 269404/2196017 [00:09<00:41, 45890.82it/s] 12%|█▏        | 274163/2196017 [00:09<00:41, 46385.77it/s] 13%|█▎        | 278923/2196017 [00:09<00:41, 46741.99it/s] 13%|█▎        | 283600/2196017 [00:09<00:40, 46730.59it/s] 13%|█▎        | 288313/2196017 [00:09<00:40, 46849.01it/s] 13%|█▎        | 293084/2196017 [00:09<00:40, 47103.38it/s] 14%|█▎        | 297801/2196017 [00:09<00:40, 47119.05it/s] 14%|█▍        | 302592/2196017 [00:09<00:39, 47351.55it/s] 14%|█▍        | 307422/2196017 [00:09<00:39, 47630.62it/s] 14%|█▍        | 312269/2196017 [00:10<00:39, 47878.70it/s] 14%|█▍        | 317160/2196017 [00:10<00:38, 48183.41it/s] 15%|█▍        | 321980/2196017 [00:10<00:38, 48122.33it/s] 15%|█▍        | 326794/2196017 [00:10<00:38, 48119.31it/s] 15%|█▌        | 331607/2196017 [00:10<00:38, 48069.11it/s] 15%|█▌        | 336415/2196017 [00:10<00:38, 47948.50it/s] 16%|█▌        | 341234/2196017 [00:10<00:38, 48018.76it/s] 16%|█▌        | 346037/2196017 [00:10<00:38, 47933.50it/s] 16%|█▌        | 351063/2196017 [00:10<00:37, 48607.79it/s] 16%|█▌        | 355927/2196017 [00:10<00:37, 48580.99it/s] 16%|█▋        | 360787/2196017 [00:11<00:37, 48317.74it/s] 17%|█▋        | 365878/2196017 [00:11<00:37, 49067.01it/s] 17%|█▋        | 371051/2196017 [00:11<00:36, 49835.41it/s] 17%|█▋        | 376206/2196017 [00:11<00:36, 50335.95it/s] 17%|█▋        | 381365/2196017 [00:11<00:35, 50703.63it/s] 18%|█▊        | 386575/2196017 [00:11<00:35, 51112.69it/s] 18%|█▊        | 391702/2196017 [00:11<00:35, 51157.86it/s] 18%|█▊        | 396988/2196017 [00:11<00:34, 51656.86it/s] 18%|█▊        | 402200/2196017 [00:11<00:34, 51792.56it/s] 19%|█▊        | 407434/2196017 [00:11<00:34, 51953.13it/s] 19%|█▉        | 412631/2196017 [00:12<00:34, 51886.70it/s] 19%|█▉        | 417821/2196017 [00:12<00:34, 51736.94it/s] 19%|█▉        | 422996/2196017 [00:12<00:34, 51652.70it/s] 19%|█▉        | 428198/2196017 [00:12<00:34, 51760.78it/s] 20%|█▉        | 433435/2196017 [00:12<00:33, 51941.88it/s] 20%|█▉        | 438757/2196017 [00:12<00:33, 52316.41it/s] 20%|██        | 444151/2196017 [00:12<00:33, 52790.56it/s] 20%|██        | 449478/2196017 [00:12<00:32, 52933.35it/s] 21%|██        | 454773/2196017 [00:12<00:32, 52876.84it/s] 21%|██        | 460062/2196017 [00:12<00:33, 52336.68it/s] 21%|██        | 465321/2196017 [00:13<00:33, 52411.05it/s] 21%|██▏       | 470564/2196017 [00:13<00:32, 52386.93it/s] 22%|██▏       | 475896/2196017 [00:13<00:32, 52650.44it/s] 22%|██▏       | 481163/2196017 [00:13<00:32, 52362.62it/s] 22%|██▏       | 486406/2196017 [00:13<00:32, 52380.13it/s] 22%|██▏       | 491645/2196017 [00:13<00:32, 52319.20it/s] 23%|██▎       | 496894/2196017 [00:13<00:32, 52369.67it/s] 23%|██▎       | 502139/2196017 [00:13<00:32, 52392.71it/s] 23%|██▎       | 507400/2196017 [00:13<00:32, 52455.93it/s] 23%|██▎       | 512784/2196017 [00:13<00:31, 52861.59it/s] 24%|██▎       | 518095/2196017 [00:14<00:31, 52934.19it/s] 24%|██▍       | 523403/2196017 [00:14<00:31, 52976.95it/s] 24%|██▍       | 528755/2196017 [00:14<00:31, 53137.78it/s] 24%|██▍       | 534157/2196017 [00:14<00:31, 53398.85it/s] 25%|██▍       | 539500/2196017 [00:14<00:31, 53405.92it/s] 25%|██▍       | 544842/2196017 [00:14<00:31, 53114.27it/s] 25%|██▌       | 550203/2196017 [00:14<00:30, 53259.27it/s] 25%|██▌       | 555602/2196017 [00:14<00:30, 53475.21it/s] 26%|██▌       | 560951/2196017 [00:14<00:30, 52857.86it/s] 26%|██▌       | 566239/2196017 [00:14<00:30, 52703.41it/s] 26%|██▌       | 571521/2196017 [00:15<00:30, 52737.74it/s] 26%|██▋       | 576829/2196017 [00:15<00:30, 52838.05it/s] 27%|██▋       | 582181/2196017 [00:15<00:30, 53039.69it/s] 27%|██▋       | 587486/2196017 [00:15<00:30, 52939.48it/s] 27%|██▋       | 592781/2196017 [00:15<00:30, 52729.36it/s] 27%|██▋       | 598055/2196017 [00:15<00:30, 52651.35it/s] 27%|██▋       | 603321/2196017 [00:15<00:30, 52477.60it/s] 28%|██▊       | 608570/2196017 [00:15<00:30, 52293.12it/s] 28%|██▊       | 613859/2196017 [00:15<00:30, 52470.33it/s] 28%|██▊       | 619237/2196017 [00:15<00:29, 52855.72it/s] 28%|██▊       | 624599/2196017 [00:16<00:29, 53081.07it/s] 29%|██▊       | 629909/2196017 [00:16<00:29, 53067.41it/s] 29%|██▉       | 635217/2196017 [00:16<00:29, 52818.80it/s] 29%|██▉       | 640508/2196017 [00:16<00:29, 52844.86it/s] 29%|██▉       | 645793/2196017 [00:16<00:29, 52719.05it/s] 30%|██▉       | 651106/2196017 [00:16<00:29, 52840.33it/s] 30%|██▉       | 656393/2196017 [00:16<00:29, 52848.98it/s] 30%|███       | 661679/2196017 [00:16<00:29, 52694.02it/s] 30%|███       | 666949/2196017 [00:16<00:29, 52458.53it/s] 31%|███       | 672215/2196017 [00:16<00:29, 52516.73it/s] 31%|███       | 677517/2196017 [00:17<00:28, 52666.19it/s] 31%|███       | 682786/2196017 [00:17<00:28, 52671.01it/s] 31%|███▏      | 688203/2196017 [00:17<00:28, 53109.52it/s] 32%|███▏      | 693515/2196017 [00:17<00:28, 52843.94it/s] 32%|███▏      | 698801/2196017 [00:17<00:28, 52660.07it/s] 32%|███▏      | 704068/2196017 [00:17<00:28, 52552.79it/s] 32%|███▏      | 709396/2196017 [00:17<00:28, 52767.08it/s] 33%|███▎      | 714703/2196017 [00:17<00:28, 52855.12it/s] 33%|███▎      | 719990/2196017 [00:17<00:27, 52741.47it/s] 33%|███▎      | 725300/2196017 [00:17<00:27, 52843.20it/s] 33%|███▎      | 730585/2196017 [00:18<00:27, 52695.33it/s] 34%|███▎      | 735855/2196017 [00:18<00:27, 52580.81it/s] 34%|███▎      | 741114/2196017 [00:18<00:27, 52504.54it/s] 34%|███▍      | 746394/2196017 [00:18<00:27, 52590.45it/s] 34%|███▍      | 751654/2196017 [00:18<00:27, 52457.03it/s] 34%|███▍      | 756967/2196017 [00:18<00:27, 52654.57it/s] 35%|███▍      | 762473/2196017 [00:18<00:26, 53353.81it/s] 35%|███▍      | 768103/2196017 [00:18<00:26, 54204.72it/s] 35%|███▌      | 773695/2196017 [00:18<00:25, 54707.36it/s] 35%|███▌      | 779213/2196017 [00:18<00:25, 54846.95it/s] 36%|███▌      | 784702/2196017 [00:19<00:25, 54706.92it/s] 36%|███▌      | 790176/2196017 [00:19<00:25, 54662.96it/s] 36%|███▌      | 795644/2196017 [00:19<00:25, 54642.03it/s] 36%|███▋      | 801110/2196017 [00:19<00:25, 54612.71it/s] 37%|███▋      | 806610/2196017 [00:19<00:25, 54721.57it/s] 37%|███▋      | 812111/2196017 [00:19<00:25, 54807.64it/s] 37%|███▋      | 817593/2196017 [00:19<00:25, 54556.24it/s] 37%|███▋      | 823050/2196017 [00:19<00:25, 54355.03it/s] 38%|███▊      | 828487/2196017 [00:19<00:25, 54185.01it/s] 38%|███▊      | 833907/2196017 [00:19<00:25, 54098.76it/s] 38%|███▊      | 839412/2196017 [00:20<00:24, 54380.06it/s] 38%|███▊      | 844931/2196017 [00:20<00:24, 54618.89it/s] 39%|███▊      | 850453/2196017 [00:20<00:24, 54797.24it/s] 39%|███▉      | 855934/2196017 [00:20<00:24, 54700.27it/s] 39%|███▉      | 861405/2196017 [00:20<00:24, 54651.58it/s] 39%|███▉      | 867020/2196017 [00:20<00:24, 55090.49it/s] 40%|███▉      | 872531/2196017 [00:20<00:24, 54449.44it/s] 40%|███▉      | 878027/2196017 [00:20<00:24, 54600.00it/s] 40%|████      | 883507/2196017 [00:20<00:24, 54657.36it/s] 40%|████      | 889088/2196017 [00:20<00:23, 54996.86it/s] 41%|████      | 894590/2196017 [00:21<00:23, 54996.86it/s] 41%|████      | 900264/2196017 [00:21<00:23, 55505.94it/s] 41%|████      | 905817/2196017 [00:21<00:23, 55443.71it/s] 42%|████▏     | 911378/2196017 [00:21<00:23, 55492.36it/s] 42%|████▏     | 917025/2196017 [00:21<00:22, 55781.35it/s] 42%|████▏     | 922605/2196017 [00:21<00:22, 55507.05it/s] 42%|████▏     | 928302/2196017 [00:21<00:22, 55936.03it/s] 43%|████▎     | 933898/2196017 [00:21<00:22, 55710.16it/s] 43%|████▎     | 939528/2196017 [00:21<00:22, 55885.31it/s] 43%|████▎     | 945196/2196017 [00:22<00:22, 56121.23it/s] 43%|████▎     | 950864/2196017 [00:22<00:22, 56285.35it/s] 44%|████▎     | 956564/2196017 [00:22<00:21, 56496.83it/s] 44%|████▍     | 962215/2196017 [00:22<00:21, 56466.60it/s] 44%|████▍     | 967865/2196017 [00:22<00:21, 56474.77it/s] 44%|████▍     | 973513/2196017 [00:22<00:21, 56449.51it/s] 45%|████▍     | 979159/2196017 [00:22<00:21, 55851.81it/s] 45%|████▍     | 984746/2196017 [00:22<00:21, 55424.56it/s] 45%|████▌     | 990291/2196017 [00:22<00:21, 55065.60it/s] 45%|████▌     | 995891/2196017 [00:22<00:21, 55340.69it/s] 46%|████▌     | 1001473/2196017 [00:23<00:21, 55482.68it/s] 46%|████▌     | 1007106/2196017 [00:23<00:21, 55733.85it/s] 46%|████▌     | 1012688/2196017 [00:23<00:21, 55757.89it/s] 46%|████▋     | 1018378/2196017 [00:23<00:20, 56094.87it/s] 47%|████▋     | 1023989/2196017 [00:23<00:20, 55856.48it/s] 47%|████▋     | 1029576/2196017 [00:23<00:20, 55836.55it/s] 47%|████▋     | 1035239/2196017 [00:23<00:20, 56070.11it/s] 47%|████▋     | 1040919/2196017 [00:23<00:20, 56285.76it/s] 48%|████▊     | 1046576/2196017 [00:23<00:20, 56370.35it/s] 48%|████▊     | 1052223/2196017 [00:23<00:20, 56399.54it/s] 48%|████▊     | 1057864/2196017 [00:24<00:20, 56097.27it/s] 48%|████▊     | 1063475/2196017 [00:24<00:20, 55470.95it/s] 49%|████▊     | 1069025/2196017 [00:24<00:20, 55050.45it/s] 49%|████▉     | 1074586/2196017 [00:24<00:20, 55214.71it/s] 49%|████▉     | 1080130/2196017 [00:24<00:20, 55281.93it/s] 49%|████▉     | 1085660/2196017 [00:24<00:20, 55117.80it/s] 50%|████▉     | 1091269/2196017 [00:24<00:19, 55403.77it/s] 50%|████▉     | 1096884/2196017 [00:24<00:19, 55625.36it/s] 50%|█████     | 1102464/2196017 [00:24<00:19, 55676.27it/s] 50%|█████     | 1108055/2196017 [00:24<00:19, 55746.08it/s] 51%|█████     | 1113725/2196017 [00:25<00:19, 56028.21it/s] 51%|█████     | 1119329/2196017 [00:25<00:19, 55981.20it/s] 51%|█████     | 1124928/2196017 [00:25<00:19, 55693.57it/s] 51%|█████▏    | 1130632/2196017 [00:25<00:18, 56089.53it/s] 52%|█████▏    | 1136401/2196017 [00:25<00:18, 56558.06it/s] 52%|█████▏    | 1142059/2196017 [00:25<00:18, 56298.56it/s] 52%|█████▏    | 1147737/2196017 [00:25<00:18, 56439.86it/s] 53%|█████▎    | 1153454/2196017 [00:25<00:18, 56654.02it/s] 53%|█████▎    | 1159121/2196017 [00:25<00:18, 56610.41it/s] 53%|█████▎    | 1164783/2196017 [00:25<00:18, 56285.40it/s] 53%|█████▎    | 1170413/2196017 [00:26<00:18, 55896.58it/s] 54%|█████▎    | 1176004/2196017 [00:26<00:18, 55501.21it/s] 54%|█████▍    | 1181556/2196017 [00:26<00:18, 55495.87it/s] 54%|█████▍    | 1187204/2196017 [00:26<00:18, 55784.94it/s] 54%|█████▍    | 1192784/2196017 [00:26<00:17, 55763.00it/s] 55%|█████▍    | 1198362/2196017 [00:26<00:18, 55423.46it/s] 55%|█████▍    | 1203938/2196017 [00:26<00:17, 55523.85it/s] 55%|█████▌    | 1209533/2196017 [00:26<00:17, 55650.47it/s] 55%|█████▌    | 1215188/2196017 [00:26<00:17, 55915.07it/s] 56%|█████▌    | 1220858/2196017 [00:26<00:17, 56145.69it/s] 56%|█████▌    | 1226529/2196017 [00:27<00:17, 56312.70it/s] 56%|█████▌    | 1232280/2196017 [00:27<00:17, 56666.40it/s] 56%|█████▋    | 1237948/2196017 [00:27<00:16, 56665.47it/s] 57%|█████▋    | 1243631/2196017 [00:27<00:16, 56714.62it/s] 57%|█████▋    | 1249303/2196017 [00:27<00:16, 56449.51it/s] 57%|█████▋    | 1255014/2196017 [00:27<00:16, 56644.69it/s] 57%|█████▋    | 1260697/2196017 [00:27<00:16, 56700.13it/s] 58%|█████▊    | 1266368/2196017 [00:27<00:16, 56489.03it/s] 58%|█████▊    | 1272018/2196017 [00:27<00:16, 56412.66it/s] 58%|█████▊    | 1277719/2196017 [00:27<00:16, 56588.43it/s] 58%|█████▊    | 1283379/2196017 [00:28<00:16, 56063.24it/s] 59%|█████▊    | 1288987/2196017 [00:28<00:16, 55983.29it/s] 59%|█████▉    | 1294587/2196017 [00:28<00:16, 55817.32it/s] 59%|█████▉    | 1300170/2196017 [00:28<00:16, 55741.77it/s] 59%|█████▉    | 1305821/2196017 [00:28<00:15, 55968.35it/s] 60%|█████▉    | 1311552/2196017 [00:28<00:15, 56362.51it/s] 60%|█████▉    | 1317193/2196017 [00:28<00:15, 56373.83it/s] 60%|██████    | 1322832/2196017 [00:28<00:15, 56265.39it/s] 60%|██████    | 1328460/2196017 [00:28<00:15, 56032.41it/s] 61%|██████    | 1334064/2196017 [00:28<00:15, 55897.46it/s] 61%|██████    | 1339693/2196017 [00:29<00:15, 56012.91it/s] 61%|██████▏   | 1345373/2196017 [00:29<00:15, 56245.92it/s] 62%|██████▏   | 1351052/2196017 [00:29<00:14, 56407.46it/s] 62%|██████▏   | 1356802/2196017 [00:29<00:14, 56730.69it/s] 62%|██████▏   | 1362476/2196017 [00:29<00:14, 56652.79it/s] 62%|██████▏   | 1368224/2196017 [00:29<00:14, 56898.26it/s] 63%|██████▎   | 1373931/2196017 [00:29<00:14, 56947.25it/s] 63%|██████▎   | 1379627/2196017 [00:29<00:14, 56439.22it/s] 63%|██████▎   | 1385273/2196017 [00:29<00:14, 56261.21it/s] 63%|██████▎   | 1390901/2196017 [00:29<00:14, 54613.87it/s] 64%|██████▎   | 1396374/2196017 [00:30<00:14, 54580.61it/s] 64%|██████▍   | 1401948/2196017 [00:30<00:14, 54923.04it/s] 64%|██████▍   | 1407447/2196017 [00:30<00:14, 54573.13it/s] 64%|██████▍   | 1412910/2196017 [00:30<00:14, 54433.48it/s] 65%|██████▍   | 1418382/2196017 [00:30<00:14, 54516.73it/s] 65%|██████▍   | 1423837/2196017 [00:30<00:14, 54355.88it/s] 65%|██████▌   | 1429283/2196017 [00:30<00:14, 54385.42it/s] 65%|██████▌   | 1434785/2196017 [00:30<00:13, 54572.06it/s] 66%|██████▌   | 1440399/2196017 [00:30<00:13, 55031.37it/s] 66%|██████▌   | 1445964/2196017 [00:30<00:13, 55213.61it/s] 66%|██████▌   | 1451487/2196017 [00:31<00:13, 55105.13it/s] 66%|██████▋   | 1456999/2196017 [00:31<00:13, 55016.09it/s] 67%|██████▋   | 1462509/2196017 [00:31<00:13, 55040.27it/s] 67%|██████▋   | 1468014/2196017 [00:31<00:13, 54949.91it/s] 67%|██████▋   | 1473586/2196017 [00:31<00:13, 55177.42it/s] 67%|██████▋   | 1479105/2196017 [00:31<00:13, 55046.54it/s] 68%|██████▊   | 1484611/2196017 [00:31<00:12, 54972.28it/s] 68%|██████▊   | 1490109/2196017 [00:31<00:12, 54876.81it/s] 68%|██████▊   | 1495620/2196017 [00:31<00:12, 54945.63it/s] 68%|██████▊   | 1501115/2196017 [00:31<00:12, 54765.61it/s] 69%|██████▊   | 1506599/2196017 [00:32<00:12, 54786.12it/s] 69%|██████▉   | 1512078/2196017 [00:32<00:12, 54781.93it/s] 69%|██████▉   | 1517557/2196017 [00:32<00:12, 54712.68it/s] 69%|██████▉   | 1523029/2196017 [00:32<00:12, 54202.38it/s] 70%|██████▉   | 1528526/2196017 [00:32<00:12, 54428.65it/s] 70%|██████▉   | 1534000/2196017 [00:32<00:12, 54520.65it/s] 70%|███████   | 1539513/2196017 [00:32<00:12, 54700.19it/s] 70%|███████   | 1545000/2196017 [00:32<00:11, 54749.82it/s] 71%|███████   | 1550482/2196017 [00:32<00:11, 54770.33it/s] 71%|███████   | 1555974/2196017 [00:32<00:11, 54814.34it/s] 71%|███████   | 1561456/2196017 [00:33<00:11, 54798.77it/s] 71%|███████▏  | 1566981/2196017 [00:33<00:11, 54930.99it/s] 72%|███████▏  | 1572475/2196017 [00:33<00:11, 54881.16it/s] 72%|███████▏  | 1577982/2196017 [00:33<00:11, 54936.12it/s] 72%|███████▏  | 1583487/2196017 [00:33<00:11, 54968.56it/s] 72%|███████▏  | 1589076/2196017 [00:33<00:10, 55239.58it/s] 73%|███████▎  | 1594601/2196017 [00:33<00:10, 55211.92it/s] 73%|███████▎  | 1600126/2196017 [00:33<00:10, 55222.57it/s] 73%|███████▎  | 1605687/2196017 [00:33<00:10, 55337.85it/s] 73%|███████▎  | 1611221/2196017 [00:33<00:10, 55134.64it/s] 74%|███████▎  | 1616741/2196017 [00:34<00:10, 55148.45it/s] 74%|███████▍  | 1622277/2196017 [00:34<00:10, 55209.56it/s] 74%|███████▍  | 1627835/2196017 [00:34<00:10, 55320.11it/s] 74%|███████▍  | 1633400/2196017 [00:34<00:10, 55416.35it/s] 75%|███████▍  | 1638942/2196017 [00:34<00:10, 55291.70it/s] 75%|███████▍  | 1644472/2196017 [00:34<00:09, 55248.81it/s] 75%|███████▌  | 1649998/2196017 [00:34<00:09, 55034.14it/s] 75%|███████▌  | 1655502/2196017 [00:34<00:09, 54735.42it/s] 76%|███████▌  | 1660977/2196017 [00:34<00:09, 54551.43it/s] 76%|███████▌  | 1666433/2196017 [00:34<00:09, 54543.36it/s] 76%|███████▌  | 1671922/2196017 [00:35<00:09, 54646.25it/s] 76%|███████▋  | 1677414/2196017 [00:35<00:09, 54727.79it/s] 77%|███████▋  | 1683000/2196017 [00:35<00:09, 55060.33it/s] 77%|███████▋  | 1688687/2196017 [00:35<00:09, 55588.82it/s] 77%|███████▋  | 1694248/2196017 [00:35<00:09, 55498.12it/s] 77%|███████▋  | 1699897/2196017 [00:35<00:08, 55790.49it/s] 78%|███████▊  | 1705478/2196017 [00:35<00:08, 55666.83it/s] 78%|███████▊  | 1711046/2196017 [00:35<00:08, 55590.05it/s] 78%|███████▊  | 1716606/2196017 [00:35<00:08, 55559.48it/s] 78%|███████▊  | 1722173/2196017 [00:35<00:08, 55591.25it/s] 79%|███████▊  | 1727733/2196017 [00:36<00:08, 55486.75it/s] 79%|███████▉  | 1733282/2196017 [00:36<00:08, 55269.02it/s] 79%|███████▉  | 1738885/2196017 [00:36<00:08, 55493.58it/s] 79%|███████▉  | 1744471/2196017 [00:36<00:08, 55602.46it/s] 80%|███████▉  | 1750032/2196017 [00:36<00:08, 55375.63it/s] 80%|███████▉  | 1755571/2196017 [00:36<00:07, 55081.89it/s] 80%|████████  | 1761080/2196017 [00:36<00:07, 54912.01it/s] 80%|████████  | 1766618/2196017 [00:36<00:07, 55051.08it/s] 81%|████████  | 1772124/2196017 [00:36<00:07, 54677.13it/s] 81%|████████  | 1777643/2196017 [00:36<00:07, 54827.62it/s] 81%|████████  | 1783200/2196017 [00:37<00:07, 55045.30it/s] 81%|████████▏ | 1788706/2196017 [00:37<00:07, 55015.85it/s] 82%|████████▏ | 1794294/2196017 [00:37<00:07, 55270.02it/s] 82%|████████▏ | 1799822/2196017 [00:37<00:07, 55181.95it/s] 82%|████████▏ | 1805341/2196017 [00:37<00:07, 54935.68it/s] 82%|████████▏ | 1810836/2196017 [00:37<00:07, 54727.91it/s] 83%|████████▎ | 1816310/2196017 [00:37<00:06, 54696.62it/s] 83%|████████▎ | 1821838/2196017 [00:37<00:06, 54868.48it/s] 83%|████████▎ | 1827326/2196017 [00:37<00:06, 54643.11it/s] 83%|████████▎ | 1832791/2196017 [00:37<00:06, 54577.31it/s] 84%|████████▎ | 1838356/2196017 [00:38<00:06, 54892.99it/s] 84%|████████▍ | 1843955/2196017 [00:38<00:06, 55215.03it/s] 84%|████████▍ | 1849478/2196017 [00:38<00:06, 54765.01it/s] 84%|████████▍ | 1855036/2196017 [00:38<00:06, 55005.64it/s] 85%|████████▍ | 1860566/2196017 [00:38<00:06, 55093.40it/s] 85%|████████▍ | 1866077/2196017 [00:38<00:06, 54884.33it/s] 85%|████████▌ | 1871567/2196017 [00:38<00:05, 54793.28it/s] 85%|████████▌ | 1877047/2196017 [00:38<00:05, 54720.99it/s] 86%|████████▌ | 1882557/2196017 [00:38<00:05, 54832.21it/s] 86%|████████▌ | 1888060/2196017 [00:39<00:05, 54887.69it/s] 86%|████████▌ | 1893550/2196017 [00:39<00:05, 54800.36it/s] 86%|████████▋ | 1899031/2196017 [00:39<00:05, 54642.27it/s] 87%|████████▋ | 1904496/2196017 [00:39<00:05, 54643.90it/s] 87%|████████▋ | 1910015/2196017 [00:39<00:05, 54804.66it/s] 87%|████████▋ | 1915580/2196017 [00:39<00:05, 55054.20it/s] 87%|████████▋ | 1921086/2196017 [00:39<00:05, 54963.89it/s] 88%|████████▊ | 1926583/2196017 [00:39<00:04, 54961.18it/s] 88%|████████▊ | 1932157/2196017 [00:39<00:04, 55189.97it/s] 88%|████████▊ | 1937767/2196017 [00:39<00:04, 55459.84it/s] 88%|████████▊ | 1943314/2196017 [00:40<00:04, 55401.61it/s] 89%|████████▊ | 1948887/2196017 [00:40<00:04, 55497.84it/s] 89%|████████▉ | 1954500/2196017 [00:40<00:04, 55683.55it/s] 89%|████████▉ | 1960069/2196017 [00:40<00:04, 55411.07it/s] 90%|████████▉ | 1965611/2196017 [00:40<00:04, 55125.45it/s] 90%|████████▉ | 1971154/2196017 [00:40<00:04, 55216.20it/s] 90%|█████████ | 1976712/2196017 [00:40<00:03, 55323.99it/s] 90%|█████████ | 1982245/2196017 [00:40<00:03, 55179.95it/s] 91%|█████████ | 1987772/2196017 [00:40<00:03, 55206.75it/s] 91%|█████████ | 1993293/2196017 [00:40<00:03, 55096.58it/s] 91%|█████████ | 1998803/2196017 [00:41<00:03, 55082.14it/s] 91%|█████████▏| 2004317/2196017 [00:41<00:03, 55097.77it/s] 92%|█████████▏| 2009827/2196017 [00:41<00:03, 55036.41it/s] 92%|█████████▏| 2015331/2196017 [00:41<00:03, 54742.53it/s] 92%|█████████▏| 2020806/2196017 [00:41<00:03, 54666.47it/s] 92%|█████████▏| 2026273/2196017 [00:41<00:03, 54448.03it/s] 93%|█████████▎| 2031719/2196017 [00:41<00:03, 54450.15it/s] 93%|█████████▎| 2037277/2196017 [00:41<00:02, 54782.03it/s] 93%|█████████▎| 2042876/2196017 [00:41<00:02, 55138.00it/s] 93%|█████████▎| 2048528/2196017 [00:41<00:02, 55543.75it/s] 94%|█████████▎| 2054084/2196017 [00:42<00:02, 55401.38it/s] 94%|█████████▍| 2059661/2196017 [00:42<00:02, 55510.16it/s] 94%|█████████▍| 2065213/2196017 [00:42<00:02, 55237.08it/s] 94%|█████████▍| 2070738/2196017 [00:42<00:02, 55220.24it/s] 95%|█████████▍| 2076261/2196017 [00:42<00:02, 55102.55it/s] 95%|█████████▍| 2081830/2196017 [00:42<00:02, 55275.03it/s] 95%|█████████▌| 2087358/2196017 [00:42<00:01, 55274.20it/s] 95%|█████████▌| 2092913/2196017 [00:42<00:01, 55353.91it/s] 96%|█████████▌| 2098449/2196017 [00:42<00:01, 55294.77it/s] 96%|█████████▌| 2103979/2196017 [00:42<00:01, 55280.22it/s] 96%|█████████▌| 2109521/2196017 [00:43<00:01, 55320.44it/s] 96%|█████████▋| 2115054/2196017 [00:43<00:01, 55236.10it/s] 97%|█████████▋| 2120578/2196017 [00:43<00:01, 55134.25it/s] 97%|█████████▋| 2126115/2196017 [00:43<00:01, 55202.97it/s] 97%|█████████▋| 2131644/2196017 [00:43<00:01, 55228.23it/s] 97%|█████████▋| 2137167/2196017 [00:43<00:01, 55095.86it/s] 98%|█████████▊| 2142677/2196017 [00:43<00:00, 55003.45it/s] 98%|█████████▊| 2148178/2196017 [00:43<00:00, 54996.07it/s] 98%|█████████▊| 2153684/2196017 [00:43<00:00, 55012.42it/s] 98%|█████████▊| 2159186/2196017 [00:43<00:00, 54920.13it/s] 99%|█████████▊| 2164741/2196017 [00:44<00:00, 55106.23it/s] 99%|█████████▉| 2170252/2196017 [00:44<00:00, 54605.67it/s] 99%|█████████▉| 2175714/2196017 [00:44<00:00, 54488.45it/s] 99%|█████████▉| 2181411/2196017 [00:44<00:00, 55209.13it/s]100%|█████████▉| 2186955/2196017 [00:44<00:00, 55277.30it/s]100%|█████████▉| 2192498/2196017 [00:44<00:00, 55322.09it/s]100%|██████████| 2196017/2196017 [00:44<00:00, 49250.58it/s]
[2022-05-31 13:30:50,331] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 13:30:58,733] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f64502d5c10>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f64502d5c10>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 13:30:58,740] INFO: Vocab size: 64518
[2022-05-31 13:30:58,740] INFO: Nb labels: 2
[2022-05-31 13:30:58,740] INFO: Total params: 21123803
[2022-05-31 13:30:58,740] INFO: Learnable params: 1768403
[2022-05-31 13:30:58,743] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  2%|▏         | 156/8214 [00:00<00:05, 1558.10ex/s]  6%|▌         | 501/8214 [00:00<00:04, 1863.70ex/s] 10%|▉         | 816/8214 [00:00<00:03, 2123.44ex/s] 12%|█▏        | 1006/8214 [00:01<00:11, 628.24ex/s] 17%|█▋        | 1357/8214 [00:01<00:08, 833.41ex/s] 20%|██        | 1667/8214 [00:01<00:06, 1067.36ex/s] 24%|██▍       | 2000/8214 [00:01<00:04, 1294.94ex/s] 28%|██▊       | 2339/8214 [00:01<00:03, 1589.41ex/s] 32%|███▏      | 2668/8214 [00:01<00:02, 1880.11ex/s] 36%|███▋      | 2986/8214 [00:01<00:02, 2141.21ex/s] 40%|███▉      | 3283/8214 [00:01<00:02, 2228.86ex/s] 44%|████▍     | 3626/8214 [00:01<00:01, 2488.96ex/s] 48%|████▊     | 3954/8214 [00:02<00:01, 2681.81ex/s] 52%|█████▏    | 4262/8214 [00:02<00:01, 2637.46ex/s] 56%|█████▌    | 4604/8214 [00:02<00:01, 2830.18ex/s] 60%|██████    | 4939/8214 [00:02<00:01, 2968.00ex/s] 64%|██████▍   | 5255/8214 [00:02<00:01, 2829.79ex/s] 68%|██████▊   | 5590/8214 [00:02<00:00, 2966.75ex/s] 72%|███████▏  | 5919/8214 [00:02<00:00, 3056.49ex/s] 76%|███████▌  | 6234/8214 [00:02<00:00, 2785.39ex/s] 80%|████████  | 6584/8214 [00:02<00:00, 2967.07ex/s] 84%|████████▍ | 6905/8214 [00:03<00:00, 3035.21ex/s] 88%|████████▊ | 7217/8214 [00:03<00:00, 2892.52ex/s] 92%|█████████▏| 7567/8214 [00:03<00:00, 3050.73ex/s] 96%|█████████▋| 7907/8214 [00:03<00:00, 3145.58ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2362.50ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 26%|██▌       | 352/1369 [00:00<00:00, 3517.66ex/s] 50%|████▉     | 678/1369 [00:00<00:00, 3434.11ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2993.52ex/s] 98%|█████████▊| 1345/1369 [00:00<00:00, 3115.98ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3051.91ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  0%|          | 3/1369 [00:00<00:54, 25.27ex/s]  8%|▊         | 114/1369 [00:00<00:35, 35.39ex/s] 10%|█         | 143/1369 [00:00<00:25, 47.58ex/s] 13%|█▎        | 174/1369 [00:00<00:18, 63.67ex/s] 23%|██▎       | 319/1369 [00:00<00:11, 88.20ex/s] 34%|███▍      | 470/1369 [00:00<00:07, 122.86ex/s] 40%|███▉      | 544/1369 [00:00<00:05, 157.92ex/s] 64%|██████▎   | 871/1369 [00:01<00:02, 221.02ex/s] 76%|███████▌  | 1038/1369 [00:01<00:01, 298.78ex/s] 99%|█████████▉| 1356/1369 [00:01<00:00, 410.28ex/s]100%|██████████| 1369/1369 [00:01<00:00, 1074.22ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
numpy.__version__
1.21.4
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 88, in _make_variables
    return offset, pvars, self._cat(scores)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 49, in _cat
    return torch.cat(scores)
TypeError: expected Tensor as element 0 in argument 0, but got numpy.ndarray

                                                                   