	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 08:40:56,483] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  0%|          | 1/8214 [00:00<17:07,  7.99ex/s]  4%|▍         | 343/8214 [00:00<11:30, 11.40ex/s]  8%|▊         | 685/8214 [00:00<07:42, 16.27ex/s] 12%|█▏        | 1000/8214 [00:00<05:13, 23.03ex/s] 16%|█▋        | 1347/8214 [00:00<03:29, 32.81ex/s] 20%|██        | 1679/8214 [00:00<02:20, 46.68ex/s] 24%|██▍       | 2000/8214 [00:01<01:33, 66.15ex/s] 28%|██▊       | 2336/8214 [00:01<01:02, 93.71ex/s] 33%|███▎      | 2674/8214 [00:01<00:41, 132.29ex/s] 37%|███▋      | 3000/8214 [00:01<00:28, 184.92ex/s] 41%|████      | 3339/8214 [00:01<00:18, 258.13ex/s] 45%|████▍     | 3685/8214 [00:01<00:12, 357.31ex/s] 49%|████▊     | 4000/8214 [00:01<00:08, 481.48ex/s] 53%|█████▎    | 4345/8214 [00:01<00:05, 648.95ex/s] 57%|█████▋    | 4680/8214 [00:01<00:04, 855.90ex/s] 61%|██████    | 5000/8214 [00:02<00:03, 1063.83ex/s] 65%|██████▌   | 5346/8214 [00:02<00:02, 1342.42ex/s] 69%|██████▉   | 5686/8214 [00:02<00:01, 1640.01ex/s] 73%|███████▎  | 6006/8214 [00:02<00:01, 1829.43ex/s] 77%|███████▋  | 6351/8214 [00:02<00:00, 2128.62ex/s] 82%|████████▏ | 6696/8214 [00:02<00:00, 2402.52ex/s] 85%|████████▌ | 7018/8214 [00:02<00:00, 2409.71ex/s] 90%|████████▉ | 7371/8214 [00:02<00:00, 2663.00ex/s] 94%|█████████▍| 7714/8214 [00:02<00:00, 2851.87ex/s] 98%|█████████▊| 8037/8214 [00:03<00:00, 2730.68ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2664.19ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 26%|██▋       | 360/1369 [00:00<00:00, 3595.30ex/s] 51%|█████     | 695/1369 [00:00<00:00, 3517.98ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2973.52ex/s] 98%|█████████▊| 1346/1369 [00:00<00:00, 3103.27ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3055.38ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  8%|▊         | 114/1369 [00:00<00:02, 422.08ex/s] 23%|██▎       | 320/1369 [00:00<00:01, 550.64ex/s] 29%|██▉       | 397/1369 [00:00<00:01, 537.83ex/s] 34%|███▎      | 459/1369 [00:00<00:01, 472.65ex/s] 42%|████▏     | 581/1369 [00:00<00:01, 578.79ex/s] 65%|██████▌   | 895/1369 [00:00<00:00, 766.28ex/s] 76%|███████▌  | 1043/1369 [00:00<00:00, 895.73ex/s]100%|██████████| 1369/1369 [00:01<00:00, 1144.65ex/s]100%|██████████| 1369/1369 [00:01<00:00, 1246.25ex/s]
[2022-05-31 08:41:05,575] INFO: Building board loggers...
[2022-05-31 08:41:05,576] INFO: Building callbacks...
[2022-05-31 08:41:05,577] INFO: Building model: spectra...
[2022-05-31 08:41:05,790] INFO: Created a temporary directory at /tmp/tmpsfxmhkqn
[2022-05-31 08:41:05,791] INFO: Writing /tmp/tmpsfxmhkqn/_remote_module_non_sriptable.py
[2022-05-31 08:41:06,199] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 08:41:16,818] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<204:48:10,  2.98it/s]  0%|          | 999/2196017 [00:00<143:18:54,  4.25it/s]  0%|          | 2194/2196017 [00:00<100:16:52,  6.08it/s]  0%|          | 3460/2196017 [00:00<70:10:15,  8.68it/s]   0%|          | 4739/2196017 [00:00<49:06:18, 12.40it/s]  0%|          | 6112/2196017 [00:00<34:21:55, 17.70it/s]  0%|          | 7475/2196017 [00:00<24:03:15, 25.27it/s]  0%|          | 8868/2196017 [00:01<16:50:25, 36.08it/s]  0%|          | 10305/2196017 [00:01<11:47:35, 51.48it/s]  1%|          | 11784/2196017 [00:01<8:15:42, 73.44it/s]   1%|          | 13301/2196017 [00:01<5:47:28, 104.69it/s]  1%|          | 14848/2196017 [00:01<4:03:46, 149.13it/s]  1%|          | 16441/2196017 [00:01<2:51:11, 212.19it/s]  1%|          | 18002/2196017 [00:01<2:00:27, 301.37it/s]  1%|          | 19511/2196017 [00:01<1:25:00, 426.74it/s]  1%|          | 21126/2196017 [00:01<1:00:08, 602.80it/s]  1%|          | 22871/2196017 [00:01<42:40, 848.57it/s]    1%|          | 24504/2196017 [00:02<30:31, 1185.82it/s]  1%|          | 26219/2196017 [00:02<21:58, 1645.26it/s]  1%|▏         | 27954/2196017 [00:02<15:59, 2258.58it/s]  1%|▏         | 29704/2196017 [00:02<11:48, 3057.31it/s]  1%|▏         | 31537/2196017 [00:02<08:51, 4076.08it/s]  2%|▏         | 33466/2196017 [00:02<06:45, 5339.24it/s]  2%|▏         | 35389/2196017 [00:02<05:16, 6816.33it/s]  2%|▏         | 37296/2196017 [00:02<04:15, 8443.83it/s]  2%|▏         | 39243/2196017 [00:02<03:32, 10171.88it/s]  2%|▏         | 41212/2196017 [00:02<03:01, 11894.93it/s]  2%|▏         | 43244/2196017 [00:03<02:38, 13584.09it/s]  2%|▏         | 45404/2196017 [00:03<02:20, 15285.63it/s]  2%|▏         | 47598/2196017 [00:03<02:07, 16815.08it/s]  2%|▏         | 49717/2196017 [00:03<01:59, 17923.72it/s]  2%|▏         | 51882/2196017 [00:03<01:53, 18898.67it/s]  2%|▏         | 54065/2196017 [00:03<01:48, 19687.06it/s]  3%|▎         | 56314/2196017 [00:03<01:44, 20450.88it/s]  3%|▎         | 58593/2196017 [00:03<01:41, 21100.27it/s]  3%|▎         | 60906/2196017 [00:03<01:38, 21664.30it/s]  3%|▎         | 63337/2196017 [00:03<01:35, 22390.76it/s]  3%|▎         | 65812/2196017 [00:04<01:32, 23044.87it/s]  3%|▎         | 68269/2196017 [00:04<01:30, 23476.80it/s]  3%|▎         | 70853/2196017 [00:04<01:28, 24135.58it/s]  3%|▎         | 73415/2196017 [00:04<01:26, 24560.60it/s]  3%|▎         | 76144/2196017 [00:04<01:23, 25319.69it/s]  4%|▎         | 78932/2196017 [00:04<01:21, 26033.45it/s]  4%|▎         | 81756/2196017 [00:04<01:19, 26657.54it/s]  4%|▍         | 84565/2196017 [00:04<01:17, 27071.59it/s]  4%|▍         | 87454/2196017 [00:04<01:16, 27588.38it/s]  4%|▍         | 90346/2196017 [00:04<01:15, 27974.66it/s]  4%|▍         | 93344/2196017 [00:05<01:13, 28546.36it/s]  4%|▍         | 96362/2196017 [00:05<01:12, 29016.53it/s]  5%|▍         | 99273/2196017 [00:05<01:12, 29031.34it/s]  5%|▍         | 102436/2196017 [00:05<01:10, 29758.19it/s]  5%|▍         | 105745/2196017 [00:05<01:08, 30677.18it/s]  5%|▍         | 108956/2196017 [00:05<01:07, 31092.15it/s]  5%|▌         | 112259/2196017 [00:05<01:05, 31648.39it/s]  5%|▌         | 115640/2196017 [00:05<01:04, 32267.12it/s]  5%|▌         | 118958/2196017 [00:05<01:03, 32534.01it/s]  6%|▌         | 122340/2196017 [00:05<01:03, 32909.01it/s]  6%|▌         | 125733/2196017 [00:06<01:02, 33207.34it/s]  6%|▌         | 129232/2196017 [00:06<01:01, 33722.62it/s]  6%|▌         | 132814/2196017 [00:06<01:00, 34324.46it/s]  6%|▌         | 136412/2196017 [00:06<00:59, 34793.84it/s]  6%|▋         | 140085/2196017 [00:06<00:58, 35351.43it/s]  7%|▋         | 143710/2196017 [00:06<00:57, 35613.07it/s]  7%|▋         | 147388/2196017 [00:06<00:56, 35948.42it/s]  7%|▋         | 151175/2196017 [00:06<00:56, 36498.45it/s]  7%|▋         | 154999/2196017 [00:06<00:55, 37003.02it/s]  7%|▋         | 158995/2196017 [00:06<00:53, 37832.01it/s]  7%|▋         | 162925/2196017 [00:07<00:53, 38252.88it/s]  8%|▊         | 166894/2196017 [00:07<00:52, 38672.85it/s]  8%|▊         | 170878/2196017 [00:07<00:51, 39015.43it/s]  8%|▊         | 174845/2196017 [00:07<00:51, 39203.94it/s]  8%|▊         | 178862/2196017 [00:07<00:51, 39488.66it/s]  8%|▊         | 182921/2196017 [00:07<00:50, 39812.30it/s]  9%|▊         | 187103/2196017 [00:07<00:49, 40382.78it/s]  9%|▊         | 191208/2196017 [00:07<00:49, 40580.44it/s]  9%|▉         | 195376/2196017 [00:07<00:48, 40900.48it/s]  9%|▉         | 199642/2196017 [00:07<00:48, 41410.82it/s]  9%|▉         | 203934/2196017 [00:08<00:47, 41848.00it/s]  9%|▉         | 208222/2196017 [00:08<00:47, 42146.85it/s] 10%|▉         | 212440/2196017 [00:08<00:47, 42125.90it/s] 10%|▉         | 216704/2196017 [00:08<00:46, 42277.10it/s] 10%|█         | 221035/2196017 [00:08<00:46, 42571.02it/s] 10%|█         | 225294/2196017 [00:08<00:47, 41747.94it/s] 10%|█         | 229504/2196017 [00:08<00:47, 41834.00it/s] 11%|█         | 233778/2196017 [00:08<00:46, 42100.27it/s] 11%|█         | 238056/2196017 [00:08<00:46, 42301.35it/s] 11%|█         | 242546/2196017 [00:08<00:45, 43046.90it/s] 11%|█▏        | 247074/2196017 [00:09<00:44, 43692.46it/s] 11%|█▏        | 251633/2196017 [00:09<00:43, 44244.14it/s] 12%|█▏        | 256207/2196017 [00:09<00:43, 44681.38it/s] 12%|█▏        | 260754/2196017 [00:09<00:43, 44913.22it/s] 12%|█▏        | 265420/2196017 [00:09<00:42, 45422.87it/s] 12%|█▏        | 270021/2196017 [00:09<00:42, 45592.47it/s] 13%|█▎        | 274677/2196017 [00:09<00:41, 45877.39it/s] 13%|█▎        | 279346/2196017 [00:09<00:41, 46117.16it/s] 13%|█▎        | 284090/2196017 [00:09<00:41, 46503.83it/s] 13%|█▎        | 288743/2196017 [00:09<00:41, 46279.44it/s] 13%|█▎        | 293430/2196017 [00:10<00:40, 46454.66it/s] 14%|█▎        | 298078/2196017 [00:10<00:40, 46451.98it/s] 14%|█▍        | 302800/2196017 [00:10<00:40, 46677.55it/s] 14%|█▍        | 307684/2196017 [00:10<00:39, 47303.86it/s] 14%|█▍        | 312536/2196017 [00:10<00:39, 47661.79it/s] 14%|█▍        | 317372/2196017 [00:10<00:39, 47868.84it/s] 15%|█▍        | 322205/2196017 [00:10<00:39, 47997.37it/s] 15%|█▍        | 327115/2196017 [00:10<00:38, 48322.23it/s] 15%|█▌        | 331949/2196017 [00:10<00:38, 48193.24it/s] 15%|█▌        | 336813/2196017 [00:10<00:38, 48311.31it/s] 16%|█▌        | 341708/2196017 [00:11<00:38, 48499.08it/s] 16%|█▌        | 346559/2196017 [00:11<00:38, 48244.60it/s] 16%|█▌        | 351419/2196017 [00:11<00:38, 48348.73it/s] 16%|█▌        | 356255/2196017 [00:11<00:38, 48241.83it/s] 16%|█▋        | 361080/2196017 [00:11<00:38, 48215.33it/s] 17%|█▋        | 365972/2196017 [00:11<00:37, 48424.05it/s] 17%|█▋        | 370842/2196017 [00:11<00:37, 48506.32it/s] 17%|█▋        | 375795/2196017 [00:11<00:37, 48808.03it/s] 17%|█▋        | 380711/2196017 [00:11<00:37, 48911.79it/s] 18%|█▊        | 385773/2196017 [00:11<00:36, 49409.76it/s] 18%|█▊        | 390728/2196017 [00:12<00:36, 49451.30it/s] 18%|█▊        | 395716/2196017 [00:12<00:36, 49576.72it/s] 18%|█▊        | 400741/2196017 [00:12<00:36, 49776.04it/s] 18%|█▊        | 405736/2196017 [00:12<00:35, 49825.06it/s] 19%|█▊        | 410720/2196017 [00:12<00:35, 49634.23it/s] 19%|█▉        | 415706/2196017 [00:12<00:35, 49697.40it/s] 19%|█▉        | 420677/2196017 [00:12<00:35, 49698.10it/s] 19%|█▉        | 425740/2196017 [00:12<00:35, 49973.75it/s] 20%|█▉        | 430811/2196017 [00:12<00:35, 50191.53it/s] 20%|█▉        | 435889/2196017 [00:12<00:34, 50364.47it/s] 20%|██        | 441003/2196017 [00:13<00:34, 50592.87it/s] 20%|██        | 446149/2196017 [00:13<00:34, 50848.90it/s] 21%|██        | 451235/2196017 [00:13<00:34, 50743.77it/s] 21%|██        | 456310/2196017 [00:13<00:34, 50553.53it/s] 21%|██        | 461366/2196017 [00:13<00:34, 50499.32it/s] 21%|██        | 466463/2196017 [00:13<00:34, 50637.39it/s] 21%|██▏       | 471621/2196017 [00:13<00:33, 50915.58it/s] 22%|██▏       | 476812/2196017 [00:13<00:33, 51209.14it/s] 22%|██▏       | 481934/2196017 [00:13<00:33, 51194.58it/s] 22%|██▏       | 487072/2196017 [00:13<00:33, 51248.36it/s] 22%|██▏       | 492228/2196017 [00:14<00:33, 51340.19it/s] 23%|██▎       | 497415/2196017 [00:14<00:32, 51495.92it/s] 23%|██▎       | 502569/2196017 [00:14<00:32, 51506.80it/s] 23%|██▎       | 507720/2196017 [00:14<00:32, 51410.33it/s] 23%|██▎       | 512876/2196017 [00:14<00:32, 51452.84it/s] 24%|██▎       | 518058/2196017 [00:14<00:32, 51561.03it/s] 24%|██▍       | 523215/2196017 [00:14<00:32, 51536.72it/s] 24%|██▍       | 528425/2196017 [00:14<00:32, 51704.32it/s] 24%|██▍       | 533655/2196017 [00:14<00:32, 51880.29it/s] 25%|██▍       | 538844/2196017 [00:14<00:31, 51798.46it/s] 25%|██▍       | 544025/2196017 [00:15<00:31, 51766.54it/s] 25%|██▌       | 549204/2196017 [00:15<00:31, 51772.67it/s] 25%|██▌       | 554432/2196017 [00:15<00:31, 51921.37it/s] 25%|██▌       | 559674/2196017 [00:15<00:31, 52067.31it/s] 26%|██▌       | 564881/2196017 [00:15<00:31, 51877.75it/s] 26%|██▌       | 570070/2196017 [00:15<00:31, 51532.63it/s] 26%|██▌       | 575225/2196017 [00:15<00:31, 51438.65it/s] 26%|██▋       | 580380/2196017 [00:15<00:31, 51469.96it/s] 27%|██▋       | 585618/2196017 [00:15<00:31, 51739.32it/s] 27%|██▋       | 590846/2196017 [00:15<00:30, 51898.00it/s] 27%|██▋       | 596037/2196017 [00:16<00:30, 51715.14it/s] 27%|██▋       | 601256/2196017 [00:16<00:30, 51856.63it/s] 28%|██▊       | 606443/2196017 [00:16<00:30, 51721.58it/s] 28%|██▊       | 611616/2196017 [00:16<00:30, 51529.95it/s] 28%|██▊       | 616876/2196017 [00:16<00:30, 51845.94it/s] 28%|██▊       | 622071/2196017 [00:16<00:30, 51874.76it/s] 29%|██▊       | 627394/2196017 [00:16<00:30, 52273.09it/s] 29%|██▉       | 632686/2196017 [00:16<00:29, 52463.46it/s] 29%|██▉       | 637964/2196017 [00:16<00:29, 52556.62it/s] 29%|██▉       | 643221/2196017 [00:16<00:29, 52478.42it/s] 30%|██▉       | 648491/2196017 [00:17<00:29, 52544.64it/s] 30%|██▉       | 653763/2196017 [00:17<00:29, 52596.69it/s] 30%|███       | 659091/2196017 [00:17<00:29, 52797.49it/s] 30%|███       | 664372/2196017 [00:17<00:29, 52624.42it/s] 30%|███       | 669635/2196017 [00:17<00:29, 52202.43it/s] 31%|███       | 674942/2196017 [00:17<00:28, 52458.01it/s] 31%|███       | 680365/2196017 [00:17<00:28, 52976.05it/s] 31%|███       | 685802/2196017 [00:17<00:28, 53385.56it/s] 31%|███▏      | 691246/2196017 [00:17<00:28, 53696.31it/s] 32%|███▏      | 696618/2196017 [00:17<00:28, 53348.55it/s] 32%|███▏      | 701955/2196017 [00:18<00:28, 53233.69it/s] 32%|███▏      | 707280/2196017 [00:18<00:28, 53158.01it/s] 32%|███▏      | 712597/2196017 [00:18<00:27, 53092.93it/s] 33%|███▎      | 717907/2196017 [00:18<00:27, 52969.45it/s] 33%|███▎      | 723293/2196017 [00:18<00:27, 53231.15it/s] 33%|███▎      | 728653/2196017 [00:18<00:27, 53340.98it/s] 33%|███▎      | 733988/2196017 [00:18<00:27, 53122.02it/s] 34%|███▎      | 739301/2196017 [00:18<00:27, 53121.81it/s] 34%|███▍      | 744614/2196017 [00:18<00:27, 53083.24it/s] 34%|███▍      | 749936/2196017 [00:18<00:27, 53122.92it/s] 34%|███▍      | 755249/2196017 [00:19<00:27, 52844.10it/s] 35%|███▍      | 760534/2196017 [00:19<00:27, 52503.09it/s] 35%|███▍      | 765851/2196017 [00:19<00:27, 52700.63it/s] 35%|███▌      | 771180/2196017 [00:19<00:26, 52874.09it/s] 35%|███▌      | 776534/2196017 [00:19<00:26, 53070.67it/s] 36%|███▌      | 781842/2196017 [00:19<00:26, 52890.97it/s] 36%|███▌      | 787132/2196017 [00:19<00:26, 52627.41it/s] 36%|███▌      | 792396/2196017 [00:19<00:26, 52533.86it/s] 36%|███▋      | 797650/2196017 [00:19<00:26, 52474.77it/s] 37%|███▋      | 802898/2196017 [00:19<00:26, 52190.76it/s] 37%|███▋      | 808131/2196017 [00:20<00:26, 52231.35it/s] 37%|███▋      | 813355/2196017 [00:20<00:26, 52098.00it/s] 37%|███▋      | 818566/2196017 [00:20<00:26, 51842.91it/s] 38%|███▊      | 823751/2196017 [00:20<00:26, 51816.59it/s] 38%|███▊      | 828946/2196017 [00:20<00:26, 51856.00it/s] 38%|███▊      | 834132/2196017 [00:20<00:26, 51828.63it/s] 38%|███▊      | 839346/2196017 [00:20<00:26, 51920.93it/s] 38%|███▊      | 844539/2196017 [00:20<00:26, 51740.31it/s] 39%|███▊      | 849714/2196017 [00:20<00:26, 51726.03it/s] 39%|███▉      | 854908/2196017 [00:20<00:25, 51787.36it/s] 39%|███▉      | 860087/2196017 [00:21<00:25, 51695.14it/s] 39%|███▉      | 865257/2196017 [00:21<00:25, 51606.00it/s] 40%|███▉      | 870418/2196017 [00:21<00:25, 51490.69it/s] 40%|███▉      | 875591/2196017 [00:21<00:25, 51562.01it/s] 40%|████      | 880790/2196017 [00:21<00:25, 51686.92it/s] 40%|████      | 885959/2196017 [00:21<00:25, 51676.59it/s] 41%|████      | 891170/2196017 [00:21<00:25, 51805.02it/s] 41%|████      | 896351/2196017 [00:21<00:25, 51798.82it/s] 41%|████      | 901562/2196017 [00:21<00:24, 51868.05it/s] 41%|████▏     | 906756/2196017 [00:21<00:24, 51888.25it/s] 42%|████▏     | 911945/2196017 [00:22<00:24, 51710.78it/s] 42%|████▏     | 917157/2196017 [00:22<00:24, 51832.55it/s] 42%|████▏     | 922341/2196017 [00:22<00:24, 51727.30it/s] 42%|████▏     | 927567/2196017 [00:22<00:24, 51884.39it/s] 42%|████▏     | 932756/2196017 [00:22<00:24, 51793.11it/s] 43%|████▎     | 937988/2196017 [00:22<00:24, 51948.86it/s] 43%|████▎     | 943214/2196017 [00:22<00:24, 52039.68it/s] 43%|████▎     | 948419/2196017 [00:22<00:24, 51884.20it/s] 43%|████▎     | 953608/2196017 [00:22<00:24, 51602.85it/s] 44%|████▎     | 958822/2196017 [00:23<00:23, 51762.22it/s] 44%|████▍     | 963999/2196017 [00:23<00:23, 51707.99it/s] 44%|████▍     | 969205/2196017 [00:23<00:23, 51812.00it/s] 44%|████▍     | 974496/2196017 [00:23<00:23, 52135.79it/s] 45%|████▍     | 979711/2196017 [00:23<00:23, 51535.70it/s] 45%|████▍     | 984944/2196017 [00:23<00:23, 51770.18it/s] 45%|████▌     | 990206/2196017 [00:23<00:23, 52021.95it/s] 45%|████▌     | 995519/2196017 [00:23<00:22, 52346.95it/s] 46%|████▌     | 1000793/2196017 [00:23<00:22, 52462.47it/s] 46%|████▌     | 1006070/2196017 [00:23<00:22, 52552.08it/s] 46%|████▌     | 1011327/2196017 [00:24<00:22, 52520.22it/s] 46%|████▋     | 1016580/2196017 [00:24<00:22, 52175.40it/s] 47%|████▋     | 1021799/2196017 [00:24<00:22, 51991.37it/s] 47%|████▋     | 1026999/2196017 [00:24<00:22, 51796.94it/s] 47%|████▋     | 1032180/2196017 [00:24<00:22, 51757.53it/s] 47%|████▋     | 1037443/2196017 [00:24<00:22, 52014.43it/s] 47%|████▋     | 1042764/2196017 [00:24<00:22, 52364.38it/s] 48%|████▊     | 1048002/2196017 [00:24<00:21, 52286.44it/s] 48%|████▊     | 1053312/2196017 [00:24<00:21, 52525.82it/s] 48%|████▊     | 1058649/2196017 [00:24<00:21, 52774.14it/s] 48%|████▊     | 1063946/2196017 [00:25<00:21, 52832.38it/s] 49%|████▊     | 1069255/2196017 [00:25<00:21, 52908.59it/s] 49%|████▉     | 1074547/2196017 [00:25<00:21, 52691.32it/s] 49%|████▉     | 1079817/2196017 [00:25<00:21, 52569.65it/s] 49%|████▉     | 1085162/2196017 [00:25<00:21, 52830.04it/s] 50%|████▉     | 1090466/2196017 [00:25<00:20, 52891.70it/s] 50%|████▉     | 1095756/2196017 [00:25<00:20, 52822.12it/s] 50%|█████     | 1101055/2196017 [00:25<00:20, 52869.67it/s] 50%|█████     | 1106343/2196017 [00:25<00:20, 52641.63it/s] 51%|█████     | 1111611/2196017 [00:25<00:20, 52651.23it/s] 51%|█████     | 1116934/2196017 [00:26<00:20, 52821.56it/s] 51%|█████     | 1122217/2196017 [00:26<00:20, 52593.61it/s] 51%|█████▏    | 1127477/2196017 [00:26<00:20, 52377.68it/s] 52%|█████▏    | 1132811/2196017 [00:26<00:20, 52660.64it/s] 52%|█████▏    | 1138103/2196017 [00:26<00:20, 52737.86it/s] 52%|█████▏    | 1143378/2196017 [00:26<00:20, 52458.01it/s] 52%|█████▏    | 1148691/2196017 [00:26<00:19, 52657.61it/s] 53%|█████▎    | 1153983/2196017 [00:26<00:19, 52734.83it/s] 53%|█████▎    | 1159279/2196017 [00:26<00:19, 52801.52it/s] 53%|█████▎    | 1164591/2196017 [00:26<00:19, 52894.38it/s] 53%|█████▎    | 1169881/2196017 [00:27<00:19, 52783.09it/s] 54%|█████▎    | 1175160/2196017 [00:27<00:19, 52694.47it/s] 54%|█████▍    | 1180430/2196017 [00:27<00:19, 52495.69it/s] 54%|█████▍    | 1185701/2196017 [00:27<00:19, 52557.19it/s] 54%|█████▍    | 1190957/2196017 [00:27<00:19, 52279.70it/s] 54%|█████▍    | 1196186/2196017 [00:27<00:19, 52260.79it/s] 55%|█████▍    | 1201441/2196017 [00:27<00:19, 52345.30it/s] 55%|█████▍    | 1206676/2196017 [00:27<00:18, 52190.28it/s] 55%|█████▌    | 1211935/2196017 [00:27<00:18, 52309.20it/s] 55%|█████▌    | 1217196/2196017 [00:27<00:18, 52396.82it/s] 56%|█████▌    | 1222490/2196017 [00:28<00:18, 52556.45it/s] 56%|█████▌    | 1227781/2196017 [00:28<00:18, 52659.63it/s] 56%|█████▌    | 1233118/2196017 [00:28<00:18, 52870.39it/s] 56%|█████▋    | 1238424/2196017 [00:28<00:18, 52924.54it/s] 57%|█████▋    | 1243768/2196017 [00:28<00:17, 53075.73it/s] 57%|█████▋    | 1249076/2196017 [00:28<00:17, 52970.27it/s] 57%|█████▋    | 1254436/2196017 [00:28<00:17, 53156.63it/s] 57%|█████▋    | 1259797/2196017 [00:28<00:17, 53289.38it/s] 58%|█████▊    | 1265127/2196017 [00:28<00:17, 53165.44it/s] 58%|█████▊    | 1270444/2196017 [00:28<00:17, 52906.11it/s] 58%|█████▊    | 1275736/2196017 [00:29<00:17, 52809.53it/s] 58%|█████▊    | 1281018/2196017 [00:29<00:17, 52703.91it/s] 59%|█████▊    | 1286289/2196017 [00:29<00:17, 52013.42it/s] 59%|█████▉    | 1291566/2196017 [00:29<00:17, 52235.68it/s] 59%|█████▉    | 1296850/2196017 [00:29<00:17, 52413.64it/s] 59%|█████▉    | 1302151/2196017 [00:29<00:16, 52590.55it/s] 60%|█████▉    | 1307483/2196017 [00:29<00:16, 52804.08it/s] 60%|█████▉    | 1312893/2196017 [00:29<00:16, 53184.44it/s] 60%|██████    | 1318280/2196017 [00:29<00:16, 53385.82it/s] 60%|██████    | 1323620/2196017 [00:29<00:16, 53352.97it/s] 61%|██████    | 1328957/2196017 [00:30<00:16, 53241.32it/s] 61%|██████    | 1334283/2196017 [00:30<00:16, 53245.00it/s] 61%|██████    | 1339608/2196017 [00:30<00:16, 53146.54it/s] 61%|██████    | 1344923/2196017 [00:30<00:16, 53029.11it/s] 61%|██████▏   | 1350227/2196017 [00:30<00:16, 52807.87it/s] 62%|██████▏   | 1355511/2196017 [00:30<00:15, 52815.03it/s] 62%|██████▏   | 1360808/2196017 [00:30<00:15, 52859.86it/s] 62%|██████▏   | 1366095/2196017 [00:30<00:15, 52752.87it/s] 62%|██████▏   | 1371421/2196017 [00:30<00:15, 52902.50it/s] 63%|██████▎   | 1376730/2196017 [00:30<00:15, 52956.43it/s] 63%|██████▎   | 1382072/2196017 [00:31<00:15, 53092.56it/s] 63%|██████▎   | 1387382/2196017 [00:31<00:15, 53085.58it/s] 63%|██████▎   | 1392746/2196017 [00:31<00:15, 53249.50it/s] 64%|██████▎   | 1398072/2196017 [00:31<00:15, 53134.11it/s] 64%|██████▍   | 1403386/2196017 [00:31<00:14, 53114.09it/s] 64%|██████▍   | 1408698/2196017 [00:31<00:14, 53029.40it/s] 64%|██████▍   | 1414002/2196017 [00:31<00:14, 53001.59it/s] 65%|██████▍   | 1419368/2196017 [00:31<00:14, 53161.20it/s] 65%|██████▍   | 1424685/2196017 [00:31<00:14, 52988.21it/s] 65%|██████▌   | 1429985/2196017 [00:31<00:14, 52890.43it/s] 65%|██████▌   | 1435295/2196017 [00:32<00:14, 52952.35it/s] 66%|██████▌   | 1440591/2196017 [00:32<00:14, 52878.08it/s] 66%|██████▌   | 1445879/2196017 [00:32<00:14, 52799.52it/s] 66%|██████▌   | 1451243/2196017 [00:32<00:14, 53048.26it/s] 66%|██████▋   | 1456578/2196017 [00:32<00:13, 53137.42it/s] 67%|██████▋   | 1461968/2196017 [00:32<00:13, 53363.44it/s] 67%|██████▋   | 1467322/2196017 [00:32<00:13, 53415.46it/s] 67%|██████▋   | 1472729/2196017 [00:32<00:13, 53608.69it/s] 67%|██████▋   | 1478106/2196017 [00:32<00:13, 53656.96it/s] 68%|██████▊   | 1483472/2196017 [00:32<00:13, 53501.64it/s] 68%|██████▊   | 1488823/2196017 [00:33<00:13, 53080.59it/s] 68%|██████▊   | 1494133/2196017 [00:33<00:13, 52961.30it/s] 68%|██████▊   | 1499430/2196017 [00:33<00:13, 52911.32it/s] 69%|██████▊   | 1504722/2196017 [00:33<00:13, 52733.29it/s] 69%|██████▉   | 1509996/2196017 [00:33<00:13, 52497.39it/s] 69%|██████▉   | 1515293/2196017 [00:33<00:12, 52637.18it/s] 69%|██████▉   | 1520558/2196017 [00:33<00:12, 52278.62it/s] 69%|██████▉   | 1525794/2196017 [00:33<00:12, 52299.88it/s] 70%|██████▉   | 1531157/2196017 [00:33<00:12, 52691.88it/s] 70%|██████▉   | 1536468/2196017 [00:33<00:12, 52815.44it/s] 70%|███████   | 1541778/2196017 [00:34<00:12, 52898.35it/s] 70%|███████   | 1547158/2196017 [00:34<00:12, 53163.64it/s] 71%|███████   | 1552476/2196017 [00:34<00:12, 53081.33it/s] 71%|███████   | 1557785/2196017 [00:34<00:12, 53015.78it/s] 71%|███████   | 1563087/2196017 [00:34<00:11, 52972.69it/s] 71%|███████▏  | 1568479/2196017 [00:34<00:11, 53251.84it/s] 72%|███████▏  | 1573805/2196017 [00:34<00:11, 53035.98it/s] 72%|███████▏  | 1579110/2196017 [00:34<00:11, 52929.22it/s] 72%|███████▏  | 1584472/2196017 [00:34<00:11, 53132.86it/s] 72%|███████▏  | 1589865/2196017 [00:34<00:11, 53367.61it/s] 73%|███████▎  | 1595203/2196017 [00:35<00:11, 52678.91it/s] 73%|███████▎  | 1600474/2196017 [00:35<00:11, 52666.30it/s] 73%|███████▎  | 1605786/2196017 [00:35<00:11, 52799.13it/s] 73%|███████▎  | 1611100/2196017 [00:35<00:11, 52900.76it/s] 74%|███████▎  | 1616420/2196017 [00:35<00:10, 52989.06it/s] 74%|███████▍  | 1621740/2196017 [00:35<00:10, 53049.46it/s] 74%|███████▍  | 1627046/2196017 [00:35<00:10, 53031.51it/s] 74%|███████▍  | 1632404/2196017 [00:35<00:10, 53193.72it/s] 75%|███████▍  | 1637739/2196017 [00:35<00:10, 53237.67it/s] 75%|███████▍  | 1643064/2196017 [00:35<00:10, 53214.78it/s] 75%|███████▌  | 1648386/2196017 [00:36<00:10, 53081.93it/s] 75%|███████▌  | 1653695/2196017 [00:36<00:10, 53003.97it/s] 76%|███████▌  | 1658996/2196017 [00:36<00:10, 52828.02it/s] 76%|███████▌  | 1664342/2196017 [00:36<00:10, 53013.35it/s] 76%|███████▌  | 1669676/2196017 [00:36<00:09, 53108.29it/s] 76%|███████▋  | 1675013/2196017 [00:36<00:09, 53184.92it/s] 77%|███████▋  | 1680332/2196017 [00:36<00:09, 53119.40it/s] 77%|███████▋  | 1685726/2196017 [00:36<00:09, 53359.68it/s] 77%|███████▋  | 1691089/2196017 [00:36<00:09, 53438.18it/s] 77%|███████▋  | 1696434/2196017 [00:36<00:09, 53366.25it/s] 77%|███████▋  | 1701771/2196017 [00:37<00:09, 53236.37it/s] 78%|███████▊  | 1707095/2196017 [00:37<00:09, 53105.07it/s] 78%|███████▊  | 1712406/2196017 [00:37<00:09, 53046.51it/s] 78%|███████▊  | 1717746/2196017 [00:37<00:08, 53152.04it/s] 78%|███████▊  | 1723062/2196017 [00:37<00:08, 53095.02it/s] 79%|███████▊  | 1728386/2196017 [00:37<00:08, 53136.05it/s] 79%|███████▉  | 1733724/2196017 [00:37<00:08, 53208.90it/s] 79%|███████▉  | 1739055/2196017 [00:37<00:08, 53239.02it/s] 79%|███████▉  | 1744387/2196017 [00:37<00:08, 53260.79it/s] 80%|███████▉  | 1749714/2196017 [00:37<00:08, 53117.05it/s] 80%|███████▉  | 1755026/2196017 [00:38<00:08, 52914.57it/s] 80%|████████  | 1760318/2196017 [00:38<00:08, 52879.22it/s] 80%|████████  | 1765607/2196017 [00:38<00:08, 52813.62it/s] 81%|████████  | 1770889/2196017 [00:38<00:08, 52763.06it/s] 81%|████████  | 1776166/2196017 [00:38<00:07, 52712.56it/s] 81%|████████  | 1781448/2196017 [00:38<00:07, 52744.54it/s] 81%|████████▏ | 1786795/2196017 [00:38<00:07, 52958.13it/s] 82%|████████▏ | 1792092/2196017 [00:38<00:07, 52631.68it/s] 82%|████████▏ | 1797362/2196017 [00:38<00:07, 52650.97it/s] 82%|████████▏ | 1802628/2196017 [00:38<00:07, 52636.19it/s] 82%|████████▏ | 1807892/2196017 [00:39<00:07, 52490.33it/s] 83%|████████▎ | 1813142/2196017 [00:39<00:07, 52370.70it/s] 83%|████████▎ | 1818380/2196017 [00:39<00:07, 51508.13it/s] 83%|████████▎ | 1823535/2196017 [00:39<00:07, 50904.56it/s] 83%|████████▎ | 1828630/2196017 [00:39<00:07, 49540.53it/s] 84%|████████▎ | 1833687/2196017 [00:39<00:07, 49844.60it/s] 84%|████████▎ | 1838829/2196017 [00:39<00:07, 50306.66it/s] 84%|████████▍ | 1844019/2196017 [00:39<00:06, 50774.20it/s] 84%|████████▍ | 1849277/2196017 [00:39<00:06, 51301.18it/s] 84%|████████▍ | 1854504/2196017 [00:39<00:06, 51586.89it/s] 85%|████████▍ | 1859789/2196017 [00:40<00:06, 51959.01it/s] 85%|████████▍ | 1865038/2196017 [00:40<00:06, 52116.78it/s] 85%|████████▌ | 1870314/2196017 [00:40<00:06, 52305.96it/s] 85%|████████▌ | 1875629/2196017 [00:40<00:06, 52554.95it/s] 86%|████████▌ | 1880887/2196017 [00:40<00:05, 52552.85it/s] 86%|████████▌ | 1886144/2196017 [00:40<00:05, 52500.61it/s] 86%|████████▌ | 1891433/2196017 [00:40<00:05, 52614.55it/s] 86%|████████▋ | 1896696/2196017 [00:40<00:05, 52517.84it/s] 87%|████████▋ | 1901949/2196017 [00:40<00:05, 51884.78it/s] 87%|████████▋ | 1907140/2196017 [00:41<00:05, 51732.20it/s] 87%|████████▋ | 1912349/2196017 [00:41<00:05, 51839.00it/s] 87%|████████▋ | 1917538/2196017 [00:41<00:05, 51852.71it/s] 88%|████████▊ | 1922778/2196017 [00:41<00:05, 52014.75it/s] 88%|████████▊ | 1928059/2196017 [00:41<00:05, 52249.52it/s] 88%|████████▊ | 1933334/2196017 [00:41<00:05, 52397.45it/s] 88%|████████▊ | 1938577/2196017 [00:41<00:04, 52404.34it/s] 89%|████████▊ | 1943831/2196017 [00:41<00:04, 52444.42it/s] 89%|████████▉ | 1949117/2196017 [00:41<00:04, 52566.36it/s] 89%|████████▉ | 1954374/2196017 [00:41<00:04, 52481.70it/s] 89%|████████▉ | 1959641/2196017 [00:42<00:04, 52537.73it/s] 89%|████████▉ | 1964895/2196017 [00:42<00:04, 52426.31it/s] 90%|████████▉ | 1970138/2196017 [00:42<00:04, 52338.56it/s] 90%|████████▉ | 1975373/2196017 [00:42<00:04, 52340.77it/s] 90%|█████████ | 1980702/2196017 [00:42<00:04, 52621.47it/s] 90%|█████████ | 1985965/2196017 [00:42<00:03, 52562.80it/s] 91%|█████████ | 1991224/2196017 [00:42<00:03, 52568.19it/s] 91%|█████████ | 1996482/2196017 [00:42<00:03, 52386.16it/s] 91%|█████████ | 2001721/2196017 [00:42<00:03, 52377.85it/s] 91%|█████████▏| 2006959/2196017 [00:42<00:03, 52314.26it/s] 92%|█████████▏| 2012240/2196017 [00:43<00:03, 52461.12it/s] 92%|█████████▏| 2017515/2196017 [00:43<00:03, 52546.94it/s] 92%|█████████▏| 2022809/2196017 [00:43<00:03, 52662.54it/s] 92%|█████████▏| 2028076/2196017 [00:43<00:03, 52318.79it/s] 93%|█████████▎| 2033309/2196017 [00:43<00:03, 51892.43it/s] 93%|█████████▎| 2038555/2196017 [00:43<00:03, 52059.31it/s] 93%|█████████▎| 2043918/2196017 [00:43<00:02, 52516.59it/s] 93%|█████████▎| 2049308/2196017 [00:43<00:02, 52907.47it/s] 94%|█████████▎| 2054670/2196017 [00:43<00:02, 53116.88it/s] 94%|█████████▍| 2059984/2196017 [00:43<00:02, 53036.11it/s] 94%|█████████▍| 2065289/2196017 [00:44<00:02, 52760.07it/s] 94%|█████████▍| 2070567/2196017 [00:44<00:02, 52709.87it/s] 95%|█████████▍| 2075839/2196017 [00:44<00:02, 52711.26it/s] 95%|█████████▍| 2081117/2196017 [00:44<00:02, 52730.26it/s] 95%|█████████▌| 2086391/2196017 [00:44<00:02, 52731.76it/s] 95%|█████████▌| 2091667/2196017 [00:44<00:01, 52739.38it/s] 95%|█████████▌| 2096990/2196017 [00:44<00:01, 52885.10it/s] 96%|█████████▌| 2102315/2196017 [00:44<00:01, 52991.31it/s] 96%|█████████▌| 2107683/2196017 [00:44<00:01, 53195.80it/s] 96%|█████████▌| 2113061/2196017 [00:44<00:01, 53367.54it/s] 96%|█████████▋| 2118400/2196017 [00:45<00:01, 53373.30it/s] 97%|█████████▋| 2123738/2196017 [00:45<00:01, 53180.78it/s] 97%|█████████▋| 2129100/2196017 [00:45<00:01, 53309.49it/s] 97%|█████████▋| 2134432/2196017 [00:45<00:01, 53295.66it/s] 97%|█████████▋| 2139762/2196017 [00:45<00:01, 53284.78it/s] 98%|█████████▊| 2145091/2196017 [00:45<00:00, 53223.78it/s] 98%|█████████▊| 2150414/2196017 [00:45<00:00, 53079.32it/s] 98%|█████████▊| 2155738/2196017 [00:45<00:00, 53126.68it/s] 98%|█████████▊| 2161052/2196017 [00:45<00:00, 53128.71it/s] 99%|█████████▊| 2166365/2196017 [00:45<00:00, 52969.42it/s] 99%|█████████▉| 2171687/2196017 [00:46<00:00, 53042.59it/s] 99%|█████████▉| 2176992/2196017 [00:46<00:00, 53020.03it/s] 99%|█████████▉| 2182349/2196017 [00:46<00:00, 53181.88it/s]100%|█████████▉| 2187688/2196017 [00:46<00:00, 53243.02it/s]100%|█████████▉| 2193071/2196017 [00:46<00:00, 53417.48it/s]100%|██████████| 2196017/2196017 [00:46<00:00, 47253.79it/s]
[2022-05-31 08:42:03,416] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 08:42:11,959] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f1e3cec4460>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f1e3cec4460>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 08:42:12,325] INFO: Vocab size: 64518
[2022-05-31 08:42:12,325] INFO: Nb labels: 2
[2022-05-31 08:42:12,326] INFO: Total params: 21123803
[2022-05-31 08:42:12,326] INFO: Learnable params: 1768403
[2022-05-31 08:42:12,373] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  4%|▍         | 337/8214 [00:00<00:02, 3368.28ex/s]  8%|▊         | 618/8214 [00:00<00:02, 3177.61ex/s] 12%|█▏        | 953/8214 [00:00<00:02, 3225.45ex/s] 14%|█▍        | 1162/8214 [00:00<00:07, 914.91ex/s] 18%|█▊        | 1488/8214 [00:01<00:05, 1166.51ex/s] 22%|██▏       | 1799/8214 [00:01<00:04, 1435.32ex/s] 25%|██▍       | 2038/8214 [00:01<00:03, 1598.26ex/s] 29%|██▉       | 2369/8214 [00:01<00:03, 1890.59ex/s] 33%|███▎      | 2698/8214 [00:01<00:02, 2166.61ex/s] 37%|███▋      | 3000/8214 [00:01<00:02, 2206.57ex/s] 41%|████      | 3335/8214 [00:01<00:01, 2457.78ex/s] 45%|████▍     | 3671/8214 [00:01<00:01, 2672.87ex/s] 49%|████▊     | 3995/8214 [00:01<00:01, 2819.97ex/s] 52%|█████▏    | 4304/8214 [00:01<00:01, 2711.20ex/s] 56%|█████▋    | 4632/8214 [00:02<00:01, 2859.59ex/s] 60%|██████    | 4954/8214 [00:02<00:01, 2957.69ex/s] 64%|██████▍   | 5262/8214 [00:02<00:01, 2739.24ex/s] 68%|██████▊   | 5590/8214 [00:02<00:00, 2880.33ex/s] 72%|███████▏  | 5916/8214 [00:02<00:00, 2981.63ex/s] 76%|███████▌  | 6223/8214 [00:02<00:00, 2798.53ex/s] 80%|███████▉  | 6561/8214 [00:02<00:00, 2950.22ex/s] 84%|████████▍ | 6881/8214 [00:02<00:00, 3019.66ex/s] 88%|████████▊ | 7189/8214 [00:02<00:00, 2742.31ex/s] 92%|█████████▏| 7528/8214 [00:03<00:00, 2907.30ex/s] 96%|█████████▌| 7851/8214 [00:03<00:00, 2994.53ex/s] 99%|█████████▉| 8158/8214 [00:03<00:00, 2789.96ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2476.90ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 25%|██▌       | 345/1369 [00:00<00:00, 3445.38ex/s] 49%|████▉     | 671/1369 [00:00<00:00, 3383.52ex/s] 72%|███████▏  | 988/1369 [00:00<00:00, 3316.28ex/s] 88%|████████▊ | 1202/1369 [00:00<00:00, 2701.32ex/s]100%|██████████| 1369/1369 [00:00<00:00, 2849.55ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  0%|          | 1/1369 [00:00<02:57,  7.72ex/s] 13%|█▎        | 181/1369 [00:00<01:47, 11.00ex/s] 23%|██▎       | 320/1369 [00:00<01:07, 15.65ex/s] 38%|███▊      | 525/1369 [00:00<00:37, 22.28ex/s] 61%|██████    | 829/1369 [00:00<00:17, 31.73ex/s] 72%|███████▏  | 992/1369 [00:01<00:09, 41.43ex/s] 81%|████████  | 1111/1369 [00:01<00:04, 57.92ex/s]100%|██████████| 1369/1369 [00:01<00:00, 710.30ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 112, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 90, in solve
    pfg.set_max_iterations_ad3(max_iter)
  File "lpsmap/ad3qp/factor_graph.pyx", line 390, in lpsmap.ad3qp.factor_graph.PFactorGraph.set_max_iterations_ad3
ValueError: only one element tensors can be converted to Python scalars

                                                                   