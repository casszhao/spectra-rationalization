	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 11:14:46,225] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 11:14:51,832] INFO: Building board loggers...
[2022-05-31 11:14:51,833] INFO: Building callbacks...
[2022-05-31 11:14:51,834] INFO: Building model: spectra...
[2022-05-31 11:14:52,183] INFO: Created a temporary directory at /tmp/tmpyxo_9kpy
[2022-05-31 11:14:52,183] INFO: Writing /tmp/tmpyxo_9kpy/_remote_module_non_sriptable.py
[2022-05-31 11:14:52,772] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 11:15:05,453] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt

  0%|          | 0/2196017 [00:00<?, ?it/s]
  0%|          | 1/2196017 [00:01<1165:12:13,  1.91s/it]
  0%|          | 320/2196017 [00:02<815:35:05,  1.34s/it]
  0%|          | 1226/2196017 [00:02<570:41:38,  1.07it/s]
  0%|          | 2598/2196017 [00:02<399:14:57,  1.53it/s]
  0%|          | 3882/2196017 [00:02<279:19:30,  2.18it/s]
  0%|          | 5282/2196017 [00:02<195:24:56,  3.11it/s]
  0%|          | 6654/2196017 [00:02<136:43:07,  4.45it/s]
  0%|          | 8070/2196017 [00:02<95:39:14,  6.35it/s] 
  0%|          | 9509/2196017 [00:02<66:55:35,  9.08it/s]
  1%|          | 11022/2196017 [00:02<46:49:41, 12.96it/s]
  1%|          | 12565/2196017 [00:02<32:46:06, 18.51it/s]
  1%|          | 14129/2196017 [00:03<22:55:59, 26.43it/s]
  1%|          | 15776/2196017 [00:03<16:03:07, 37.73it/s]
  1%|          | 17411/2196017 [00:03<11:14:20, 53.84it/s]
  1%|          | 19018/2196017 [00:03<7:52:22, 76.81it/s] 
  1%|          | 20717/2196017 [00:03<5:31:02, 109.52it/s]
  1%|          | 22451/2196017 [00:03<3:52:10, 156.03it/s]
  1%|          | 24223/2196017 [00:03<2:43:00, 222.06it/s]
  1%|          | 25975/2196017 [00:03<1:54:37, 315.52it/s]
  1%|▏         | 27841/2196017 [00:03<1:20:45, 447.50it/s]
  1%|▏         | 29593/2196017 [00:03<57:07, 632.12it/s]  
  1%|▏         | 31429/2196017 [00:04<40:32, 889.89it/s]
  2%|▏         | 33422/2196017 [00:04<28:53, 1247.40it/s]
  2%|▏         | 35365/2196017 [00:04<20:45, 1734.24it/s]
  2%|▏         | 37231/2196017 [00:04<15:06, 2382.41it/s]
  2%|▏         | 39229/2196017 [00:04<11:06, 3237.97it/s]
  2%|▏         | 41213/2196017 [00:04<08:18, 4323.21it/s]
  2%|▏         | 43208/2196017 [00:04<06:20, 5651.18it/s]
  2%|▏         | 45431/2196017 [00:04<04:55, 7279.55it/s]
  2%|▏         | 47681/2196017 [00:04<03:55, 9132.80it/s]
  2%|▏         | 49778/2196017 [00:04<03:15, 10987.63it/s]
  2%|▏         | 52034/2196017 [00:05<02:45, 12985.07it/s]
  2%|▏         | 54284/2196017 [00:05<02:24, 14870.66it/s]
  3%|▎         | 56627/2196017 [00:05<02:08, 16700.54it/s]
  3%|▎         | 58930/2196017 [00:05<01:57, 18200.70it/s]
  3%|▎         | 61292/2196017 [00:05<01:49, 19544.68it/s]
  3%|▎         | 63695/2196017 [00:05<01:43, 20698.76it/s]
  3%|▎         | 66257/2196017 [00:05<01:36, 21963.60it/s]
  3%|▎         | 68965/2196017 [00:05<01:31, 23277.25it/s]
  3%|▎         | 71818/2196017 [00:05<01:26, 24635.43it/s]
  3%|▎         | 74678/2196017 [00:05<01:22, 25703.53it/s]
  4%|▎         | 77661/2196017 [00:06<01:19, 26807.55it/s]
  4%|▎         | 80661/2196017 [00:06<01:16, 27686.15it/s]
  4%|▍         | 83568/2196017 [00:06<01:15, 28086.08it/s]
  4%|▍         | 86636/2196017 [00:06<01:13, 28810.39it/s]
  4%|▍         | 89645/2196017 [00:06<01:12, 29174.00it/s]
  4%|▍         | 92845/2196017 [00:06<01:10, 29961.91it/s]
  4%|▍         | 96005/2196017 [00:06<01:09, 30432.82it/s]
  5%|▍         | 99180/2196017 [00:06<01:08, 30815.27it/s]
  5%|▍         | 102584/2196017 [00:06<01:06, 31715.34it/s]
  5%|▍         | 105920/2196017 [00:06<01:04, 32190.57it/s]
  5%|▍         | 109283/2196017 [00:07<01:03, 32608.22it/s]
  5%|▌         | 112719/2196017 [00:07<01:02, 33108.80it/s]
  5%|▌         | 116222/2196017 [00:07<01:01, 33662.49it/s]
  5%|▌         | 119831/2196017 [00:07<01:00, 34354.85it/s]
  6%|▌         | 123311/2196017 [00:07<01:00, 34486.42it/s]
  6%|▌         | 126848/2196017 [00:07<00:59, 34741.56it/s]
  6%|▌         | 130450/2196017 [00:07<00:58, 35115.20it/s]
  6%|▌         | 133990/2196017 [00:07<00:58, 35199.69it/s]
  6%|▋         | 137746/2196017 [00:07<00:57, 35874.09it/s]
  6%|▋         | 141345/2196017 [00:07<00:57, 35907.08it/s]
  7%|▋         | 145146/2196017 [00:08<00:56, 36512.64it/s]
  7%|▋         | 148984/2196017 [00:08<00:55, 37047.95it/s]
  7%|▋         | 152852/2196017 [00:08<00:54, 37521.44it/s]
  7%|▋         | 156776/2196017 [00:08<00:53, 38020.34it/s]
  7%|▋         | 160839/2196017 [00:08<00:52, 38765.98it/s]
  8%|▊         | 165025/2196017 [00:08<00:51, 39644.47it/s]
  8%|▊         | 169107/2196017 [00:08<00:50, 39988.51it/s]
  8%|▊         | 173152/2196017 [00:08<00:50, 40122.47it/s]
  8%|▊         | 177175/2196017 [00:08<00:50, 40143.36it/s]
  8%|▊         | 181303/2196017 [00:08<00:49, 40476.09it/s]
  8%|▊         | 185469/2196017 [00:09<00:49, 40823.32it/s]
  9%|▊         | 189716/2196017 [00:09<00:48, 41302.13it/s]
  9%|▉         | 193850/2196017 [00:09<00:48, 41142.66it/s]
  9%|▉         | 198128/2196017 [00:09<00:48, 41619.69it/s]
  9%|▉         | 202294/2196017 [00:09<00:48, 41358.84it/s]
  9%|▉         | 206628/2196017 [00:09<00:47, 41932.76it/s]
 10%|▉         | 210920/2196017 [00:09<00:47, 42222.24it/s]
 10%|▉         | 215565/2196017 [00:09<00:45, 43407.30it/s]
 10%|█         | 219917/2196017 [00:09<00:45, 43352.41it/s]
 10%|█         | 224335/2196017 [00:09<00:45, 43594.11it/s]
 10%|█         | 228700/2196017 [00:10<00:45, 43334.95it/s]
 11%|█         | 233190/2196017 [00:10<00:44, 43792.38it/s]
 11%|█         | 237574/2196017 [00:10<00:44, 43649.65it/s]
 11%|█         | 242125/2196017 [00:10<00:44, 44190.13it/s]
 11%|█         | 246550/2196017 [00:10<00:44, 44202.59it/s]
 11%|█▏        | 251143/2196017 [00:10<00:43, 44705.50it/s]
 12%|█▏        | 255779/2196017 [00:10<00:44, 43176.76it/s]
 12%|█▏        | 260241/2196017 [00:10<00:44, 43598.32it/s]
 12%|█▏        | 265120/2196017 [00:10<00:42, 45035.29it/s]
 12%|█▏        | 269989/2196017 [00:10<00:41, 46071.31it/s]
 13%|█▎        | 274686/2196017 [00:11<00:41, 46336.48it/s]
 13%|█▎        | 279344/2196017 [00:11<00:41, 46409.18it/s]
 13%|█▎        | 284212/2196017 [00:11<00:40, 47067.39it/s]
 13%|█▎        | 288928/2196017 [00:11<00:40, 46713.24it/s]
 13%|█▎        | 293607/2196017 [00:11<00:40, 46683.79it/s]
 14%|█▎        | 298433/2196017 [00:11<00:40, 47144.73it/s]
 14%|█▍        | 303152/2196017 [00:11<00:40, 46771.62it/s]
 14%|█▍        | 307949/2196017 [00:11<00:40, 47122.82it/s]
 14%|█▍        | 312901/2196017 [00:11<00:39, 47815.58it/s]
 14%|█▍        | 317751/2196017 [00:11<00:39, 48016.47it/s]
 15%|█▍        | 322693/2196017 [00:12<00:38, 48428.32it/s]
 15%|█▍        | 327585/2196017 [00:12<00:38, 48573.83it/s]
 15%|█▌        | 332603/2196017 [00:12<00:37, 49043.83it/s]
 15%|█▌        | 337714/2196017 [00:12<00:37, 49644.91it/s]
 16%|█▌        | 342683/2196017 [00:12<00:37, 49460.46it/s]
 16%|█▌        | 347664/2196017 [00:12<00:37, 49549.48it/s]
 16%|█▌        | 352860/2196017 [00:12<00:36, 50247.89it/s]
 16%|█▋        | 358095/2196017 [00:12<00:36, 50860.39it/s]
 17%|█▋        | 363520/2196017 [00:12<00:35, 51831.46it/s]
 17%|█▋        | 368790/2196017 [00:12<00:35, 52087.58it/s]
 17%|█▋        | 374089/2196017 [00:13<00:34, 52354.04it/s]
 17%|█▋        | 379329/2196017 [00:13<00:35, 51602.66it/s]
 18%|█▊        | 384495/2196017 [00:13<00:35, 51301.54it/s]
 18%|█▊        | 389727/2196017 [00:13<00:35, 51601.37it/s]
 18%|█▊        | 394963/2196017 [00:13<00:34, 51810.23it/s]
 18%|█▊        | 400163/2196017 [00:13<00:34, 51864.44it/s]
 18%|█▊        | 405535/2196017 [00:13<00:34, 52406.39it/s]
 19%|█▊        | 410779/2196017 [00:13<00:34, 52365.94it/s]
 19%|█▉        | 416018/2196017 [00:13<00:34, 52293.04it/s]
 19%|█▉        | 421350/2196017 [00:13<00:33, 52596.26it/s]
 19%|█▉        | 426927/2196017 [00:14<00:33, 53508.89it/s]
 20%|█▉        | 432311/2196017 [00:14<00:32, 53607.58it/s]
 20%|█▉        | 437813/2196017 [00:14<00:32, 54021.22it/s]
 20%|██        | 443306/2196017 [00:14<00:32, 54289.16it/s]
 20%|██        | 448738/2196017 [00:14<00:32, 54076.54it/s]
 21%|██        | 454267/2196017 [00:14<00:31, 54433.20it/s]
 21%|██        | 459713/2196017 [00:14<00:32, 53656.12it/s]
 21%|██        | 465083/2196017 [00:14<00:32, 53222.18it/s]
 21%|██▏       | 470409/2196017 [00:14<00:32, 53229.27it/s]
 22%|██▏       | 475785/2196017 [00:14<00:32, 53386.64it/s]
 22%|██▏       | 481137/2196017 [00:15<00:32, 53425.64it/s]
 22%|██▏       | 486675/2196017 [00:15<00:31, 53996.80it/s]
 22%|██▏       | 492139/2196017 [00:15<00:31, 54188.10it/s]
 23%|██▎       | 497588/2196017 [00:15<00:31, 54276.44it/s]
 23%|██▎       | 503017/2196017 [00:15<00:31, 53922.48it/s]
 23%|██▎       | 508411/2196017 [00:15<00:31, 53854.04it/s]
 23%|██▎       | 513885/2196017 [00:15<00:31, 54114.98it/s]
 24%|██▎       | 519298/2196017 [00:15<00:31, 53772.19it/s]
 24%|██▍       | 524677/2196017 [00:15<00:31, 53356.28it/s]
 24%|██▍       | 530184/2196017 [00:15<00:30, 53857.34it/s]
 24%|██▍       | 535572/2196017 [00:16<00:30, 53765.96it/s]
 25%|██▍       | 541030/2196017 [00:16<00:30, 54006.29it/s]
 25%|██▍       | 546433/2196017 [00:16<00:30, 53815.51it/s]
 25%|██▌       | 551842/2196017 [00:16<00:30, 53897.12it/s]
 25%|██▌       | 557410/2196017 [00:16<00:30, 54418.41it/s]
 26%|██▌       | 562854/2196017 [00:16<00:30, 54342.60it/s]
 26%|██▌       | 568290/2196017 [00:16<00:30, 53740.04it/s]
 26%|██▌       | 573667/2196017 [00:16<00:30, 53717.93it/s]
 26%|██▋       | 579326/2196017 [00:16<00:29, 54547.58it/s]
 27%|██▋       | 584836/2196017 [00:16<00:29, 54711.38it/s]
 27%|██▋       | 590366/2196017 [00:17<00:29, 54886.04it/s]
 27%|██▋       | 595880/2196017 [00:17<00:29, 54960.19it/s]
 27%|██▋       | 601412/2196017 [00:17<00:28, 55067.19it/s]
 28%|██▊       | 606920/2196017 [00:17<00:29, 54485.41it/s]
 28%|██▊       | 612371/2196017 [00:17<00:29, 53856.67it/s]
 28%|██▊       | 617760/2196017 [00:17<00:29, 53686.85it/s]
 28%|██▊       | 623158/2196017 [00:17<00:29, 53773.33it/s]
 29%|██▊       | 628538/2196017 [00:17<00:29, 53706.15it/s]
 29%|██▉       | 633999/2196017 [00:17<00:28, 53971.57it/s]
 29%|██▉       | 639398/2196017 [00:17<00:28, 53972.14it/s]
 29%|██▉       | 644912/2196017 [00:18<00:28, 54315.90it/s]
 30%|██▉       | 650498/2196017 [00:18<00:28, 54769.76it/s]
 30%|██▉       | 656022/2196017 [00:18<00:28, 54906.34it/s]
 30%|███       | 661514/2196017 [00:18<00:28, 54532.02it/s]
 30%|███       | 666969/2196017 [00:18<00:28, 53770.60it/s]
 31%|███       | 672350/2196017 [00:18<00:28, 53317.23it/s]
 31%|███       | 677708/2196017 [00:18<00:28, 53392.19it/s]
 31%|███       | 683297/2196017 [00:18<00:27, 54117.71it/s]
 31%|███▏      | 688780/2196017 [00:18<00:27, 54328.04it/s]
 32%|███▏      | 694477/2196017 [00:19<00:27, 55092.95it/s]
 32%|███▏      | 699991/2196017 [00:19<00:27, 54948.82it/s]
 32%|███▏      | 705584/2196017 [00:19<00:26, 55236.39it/s]
 32%|███▏      | 711111/2196017 [00:19<00:26, 55183.83it/s]
 33%|███▎      | 716632/2196017 [00:19<00:27, 54285.48it/s]
 33%|███▎      | 722066/2196017 [00:19<00:27, 53828.95it/s]
 33%|███▎      | 727454/2196017 [00:19<00:27, 53162.03it/s]
 33%|███▎      | 732775/2196017 [00:19<00:27, 52382.63it/s]
 34%|███▎      | 738020/2196017 [00:19<00:28, 51694.45it/s]
 34%|███▍      | 743196/2196017 [00:19<00:28, 51454.04it/s]
 34%|███▍      | 748399/2196017 [00:20<00:28, 51623.26it/s]
 34%|███▍      | 753700/2196017 [00:20<00:27, 52029.87it/s]
 35%|███▍      | 758924/2196017 [00:20<00:27, 52091.52it/s]
 35%|███▍      | 764136/2196017 [00:20<00:27, 52085.18it/s]
 35%|███▌      | 769347/2196017 [00:20<00:27, 51983.95it/s]
 35%|███▌      | 774547/2196017 [00:20<00:27, 51725.20it/s]
 36%|███▌      | 779817/2196017 [00:20<00:27, 52010.87it/s]
 36%|███▌      | 785020/2196017 [00:20<00:27, 51788.65it/s]
 36%|███▌      | 790200/2196017 [00:20<00:27, 51692.77it/s]
 36%|███▌      | 795371/2196017 [00:20<00:27, 51512.23it/s]
 36%|███▋      | 800550/2196017 [00:21<00:27, 51594.38it/s]
 37%|███▋      | 805710/2196017 [00:21<00:26, 51546.90it/s]
 37%|███▋      | 810866/2196017 [00:21<00:26, 51400.21it/s]
 37%|███▋      | 816077/2196017 [00:21<00:26, 51608.67it/s]
 37%|███▋      | 821306/2196017 [00:21<00:26, 51809.75it/s]
 38%|███▊      | 826488/2196017 [00:21<00:26, 51454.21it/s]
 38%|███▊      | 831635/2196017 [00:21<00:26, 51000.74it/s]
 38%|███▊      | 836760/2196017 [00:21<00:26, 51073.20it/s]
 38%|███▊      | 841869/2196017 [00:21<00:26, 50992.38it/s]
 39%|███▊      | 847017/2196017 [00:21<00:26, 51135.49it/s]
 39%|███▉      | 852267/2196017 [00:22<00:26, 51535.87it/s]
 39%|███▉      | 857506/2196017 [00:22<00:25, 51786.73it/s]
 39%|███▉      | 862867/2196017 [00:22<00:25, 52318.49it/s]
 40%|███▉      | 868101/2196017 [00:22<00:25, 51855.75it/s]
 40%|███▉      | 873289/2196017 [00:22<00:25, 51188.27it/s]
 40%|████      | 878515/2196017 [00:22<00:25, 51504.00it/s]
 40%|████      | 883947/2196017 [00:22<00:25, 52316.41it/s]
 40%|████      | 889184/2196017 [00:22<00:25, 52224.06it/s]
 41%|████      | 894483/2196017 [00:22<00:24, 52450.55it/s]
 41%|████      | 899885/2196017 [00:22<00:24, 52911.00it/s]
 41%|████      | 905180/2196017 [00:23<00:24, 52628.46it/s]
 41%|████▏     | 910531/2196017 [00:23<00:24, 52887.85it/s]
 42%|████▏     | 915822/2196017 [00:23<00:24, 52885.70it/s]
 42%|████▏     | 921334/2196017 [00:23<00:23, 53536.38it/s]
 42%|████▏     | 926766/2196017 [00:23<00:23, 53768.83it/s]
 42%|████▏     | 932305/2196017 [00:23<00:23, 54244.84it/s]
 43%|████▎     | 937733/2196017 [00:23<00:23, 54197.08it/s]
 43%|████▎     | 943256/2196017 [00:23<00:22, 54502.28it/s]
 43%|████▎     | 948784/2196017 [00:23<00:22, 54731.29it/s]
 43%|████▎     | 954298/2196017 [00:23<00:22, 54852.85it/s]
 44%|████▎     | 959785/2196017 [00:24<00:22, 54491.37it/s]
 44%|████▍     | 965236/2196017 [00:24<00:22, 53819.86it/s]
 44%|████▍     | 970621/2196017 [00:24<00:22, 53342.87it/s]
 44%|████▍     | 975959/2196017 [00:24<00:22, 53335.26it/s]
 45%|████▍     | 981295/2196017 [00:24<00:22, 53081.26it/s]
 45%|████▍     | 986605/2196017 [00:24<00:22, 52839.79it/s]
 45%|████▌     | 991891/2196017 [00:24<00:22, 52723.98it/s]
 45%|████▌     | 997165/2196017 [00:24<00:22, 52726.80it/s]
 46%|████▌     | 1002599/2196017 [00:24<00:22, 53198.84it/s]
 46%|████▌     | 1008271/2196017 [00:24<00:21, 54206.35it/s]
 46%|████▌     | 1013732/2196017 [00:25<00:21, 54326.68it/s]
 46%|████▋     | 1019169/2196017 [00:25<00:21, 54074.78it/s]
 47%|████▋     | 1024580/2196017 [00:25<00:21, 53452.33it/s]
 47%|████▋     | 1029930/2196017 [00:25<00:21, 53299.19it/s]
 47%|████▋     | 1035263/2196017 [00:25<00:21, 53110.61it/s]
 47%|████▋     | 1040715/2196017 [00:25<00:21, 53523.89it/s]
 48%|████▊     | 1046070/2196017 [00:25<00:21, 53493.56it/s]
 48%|████▊     | 1051488/2196017 [00:25<00:21, 53697.33it/s]
 48%|████▊     | 1056860/2196017 [00:25<00:21, 53683.69it/s]
 48%|████▊     | 1062230/2196017 [00:25<00:21, 52879.59it/s]
 49%|████▊     | 1067676/2196017 [00:26<00:21, 53342.48it/s]
 49%|████▉     | 1073014/2196017 [00:26<00:21, 52717.83it/s]
 49%|████▉     | 1078391/2196017 [00:26<00:21, 53028.29it/s]
 49%|████▉     | 1083852/2196017 [00:26<00:20, 53493.00it/s]
 50%|████▉     | 1089205/2196017 [00:26<00:20, 53145.37it/s]
 50%|████▉     | 1094646/2196017 [00:26<00:20, 53516.22it/s]
 50%|█████     | 1100031/2196017 [00:26<00:20, 53614.56it/s]
 50%|█████     | 1105505/2196017 [00:26<00:20, 53946.03it/s]
 51%|█████     | 1111080/2196017 [00:26<00:19, 54474.25it/s]
 51%|█████     | 1116724/2196017 [00:26<00:19, 55049.11it/s]
 51%|█████     | 1122233/2196017 [00:27<00:19, 55028.70it/s]
 51%|█████▏    | 1127739/2196017 [00:27<00:19, 54786.51it/s]
 52%|█████▏    | 1133296/2196017 [00:27<00:19, 55004.59it/s]
 52%|█████▏    | 1138798/2196017 [00:27<00:19, 54800.12it/s]
 52%|█████▏    | 1144352/2196017 [00:27<00:19, 55018.42it/s]
 52%|█████▏    | 1149958/2196017 [00:27<00:18, 55325.97it/s]
 53%|█████▎    | 1155562/2196017 [00:27<00:18, 55536.74it/s]
 53%|█████▎    | 1161244/2196017 [00:27<00:18, 55913.83it/s]
 53%|█████▎    | 1166837/2196017 [00:27<00:18, 55542.56it/s]
 53%|█████▎    | 1172393/2196017 [00:27<00:18, 55508.19it/s]
 54%|█████▎    | 1177945/2196017 [00:28<00:18, 55241.92it/s]
 54%|█████▍    | 1183471/2196017 [00:28<00:18, 54922.05it/s]
 54%|█████▍    | 1188965/2196017 [00:28<00:18, 54856.68it/s]
 54%|█████▍    | 1194538/2196017 [00:28<00:18, 55114.29it/s]
 55%|█████▍    | 1200139/2196017 [00:28<00:17, 55378.07it/s]
 55%|█████▍    | 1205773/2196017 [00:28<00:17, 55661.08it/s]
 55%|█████▌    | 1211341/2196017 [00:28<00:17, 55604.94it/s]
 55%|█████▌    | 1216903/2196017 [00:28<00:17, 54900.82it/s]
 56%|█████▌    | 1222396/2196017 [00:28<00:17, 54350.70it/s]
 56%|█████▌    | 1227835/2196017 [00:29<00:17, 54288.37it/s]
 56%|█████▌    | 1233385/2196017 [00:29<00:17, 54643.86it/s]
 56%|█████▋    | 1238852/2196017 [00:29<00:17, 54447.09it/s]
 57%|█████▋    | 1244301/2196017 [00:29<00:17, 54457.41it/s]
 57%|█████▋    | 1249779/2196017 [00:29<00:17, 54551.62it/s]
 57%|█████▋    | 1255444/2196017 [00:29<00:17, 55147.28it/s]
 57%|█████▋    | 1261010/2196017 [00:29<00:16, 55298.47it/s]
 58%|█████▊    | 1266542/2196017 [00:29<00:17, 54457.64it/s]
 58%|█████▊    | 1272188/2196017 [00:29<00:16, 55043.02it/s]
 58%|█████▊    | 1277697/2196017 [00:29<00:16, 54867.41it/s]
 58%|█████▊    | 1283187/2196017 [00:30<00:16, 54485.27it/s]
 59%|█████▊    | 1288679/2196017 [00:30<00:16, 54614.79it/s]
 59%|█████▉    | 1294298/2196017 [00:30<00:16, 55077.82it/s]
 59%|█████▉    | 1299827/2196017 [00:30<00:16, 55139.55it/s]
 59%|█████▉    | 1305343/2196017 [00:30<00:16, 55131.70it/s]
 60%|█████▉    | 1310858/2196017 [00:30<00:16, 54712.98it/s]
 60%|█████▉    | 1316365/2196017 [00:30<00:16, 54817.74it/s]
 60%|██████    | 1321848/2196017 [00:30<00:16, 54482.15it/s]
 60%|██████    | 1327386/2196017 [00:30<00:15, 54745.89it/s]
 61%|██████    | 1333151/2196017 [00:30<00:15, 55583.38it/s]
 61%|██████    | 1338899/2196017 [00:31<00:15, 56137.58it/s]
 61%|██████    | 1344682/2196017 [00:31<00:15, 56634.31it/s]
 61%|██████▏   | 1350373/2196017 [00:31<00:14, 56714.77it/s]
 62%|██████▏   | 1356172/2196017 [00:31<00:14, 57090.18it/s]
 62%|██████▏   | 1361893/2196017 [00:31<00:14, 57124.26it/s]
 62%|██████▏   | 1367608/2196017 [00:31<00:14, 56432.43it/s]
 63%|██████▎   | 1373255/2196017 [00:31<00:14, 56102.86it/s]
 63%|██████▎   | 1378868/2196017 [00:31<00:14, 55305.85it/s]
 63%|██████▎   | 1384403/2196017 [00:31<00:14, 54773.01it/s]
 63%|██████▎   | 1389885/2196017 [00:31<00:14, 54545.72it/s]
 64%|██████▎   | 1395442/2196017 [00:32<00:14, 54846.75it/s]
 64%|██████▍   | 1401051/2196017 [00:32<00:14, 55213.02it/s]
 64%|██████▍   | 1406575/2196017 [00:32<00:14, 55053.48it/s]
 64%|██████▍   | 1412083/2196017 [00:32<00:14, 54833.85it/s]
 65%|██████▍   | 1417722/2196017 [00:32<00:14, 55289.33it/s]
 65%|██████▍   | 1423435/2196017 [00:32<00:13, 55826.94it/s]
 65%|██████▌   | 1429021/2196017 [00:32<00:13, 55132.17it/s]
 65%|██████▌   | 1434538/2196017 [00:32<00:13, 55092.76it/s]
 66%|██████▌   | 1440086/2196017 [00:32<00:13, 55207.67it/s]
 66%|██████▌   | 1445609/2196017 [00:32<00:13, 54783.36it/s]
 66%|██████▌   | 1451090/2196017 [00:33<00:13, 54739.86it/s]
 66%|██████▋   | 1456566/2196017 [00:33<00:13, 54511.57it/s]
 67%|██████▋   | 1462019/2196017 [00:33<00:13, 54489.25it/s]
 67%|██████▋   | 1467570/2196017 [00:33<00:13, 54789.05it/s]
 67%|██████▋   | 1473050/2196017 [00:33<00:13, 54508.60it/s]
 67%|██████▋   | 1478546/2196017 [00:33<00:13, 54642.13it/s]
 68%|██████▊   | 1484012/2196017 [00:33<00:13, 54163.17it/s]
 68%|██████▊   | 1489430/2196017 [00:33<00:13, 53686.61it/s]
 68%|██████▊   | 1494824/2196017 [00:33<00:13, 53760.67it/s]
 68%|██████▊   | 1500285/2196017 [00:33<00:12, 54011.40it/s]
 69%|██████▊   | 1505746/2196017 [00:34<00:12, 54187.00it/s]
 69%|██████▉   | 1511166/2196017 [00:34<00:12, 53909.59it/s]
 69%|██████▉   | 1516711/2196017 [00:34<00:12, 54360.30it/s]
 69%|██████▉   | 1522427/2196017 [00:34<00:12, 55169.63it/s]
 70%|██████▉   | 1528148/2196017 [00:34<00:11, 55764.29it/s]
 70%|██████▉   | 1533832/2196017 [00:34<00:11, 56080.26it/s]
 70%|███████   | 1539603/2196017 [00:34<00:11, 56559.37it/s]
 70%|███████   | 1545642/2196017 [00:34<00:11, 57656.29it/s]
 71%|███████   | 1551563/2196017 [00:34<00:11, 58105.59it/s]
 71%|███████   | 1557380/2196017 [00:34<00:11, 57309.86it/s]
 71%|███████   | 1563118/2196017 [00:35<00:11, 57053.04it/s]
 71%|███████▏  | 1568977/2196017 [00:35<00:10, 57181.34it/s]
 72%|███████▏  | 1574699/2196017 [00:35<00:10, 56614.64it/s]
 72%|███████▏  | 1580365/2196017 [00:35<00:10, 56538.78it/s]
 72%|███████▏  | 1586022/2196017 [00:35<00:10, 56431.75it/s]
 72%|███████▏  | 1591668/2196017 [00:35<00:10, 56127.26it/s]
 73%|███████▎  | 1597283/2196017 [00:35<00:10, 55516.99it/s]
 73%|███████▎  | 1603167/2196017 [00:35<00:10, 56471.42it/s]
 73%|███████▎  | 1608821/2196017 [00:35<00:10, 56295.90it/s]
 74%|███████▎  | 1614455/2196017 [00:35<00:10, 56066.62it/s]
 74%|███████▍  | 1620065/2196017 [00:36<00:10, 55611.45it/s]
 74%|███████▍  | 1625630/2196017 [00:36<00:10, 55005.52it/s]
 74%|███████▍  | 1631225/2196017 [00:36<00:10, 55283.64it/s]
 75%|███████▍  | 1636757/2196017 [00:36<00:10, 55190.16it/s]
 75%|███████▍  | 1642279/2196017 [00:36<00:10, 55164.18it/s]
 75%|███████▌  | 1647797/2196017 [00:36<00:09, 55090.07it/s]
 75%|███████▌  | 1653308/2196017 [00:36<00:09, 54973.45it/s]
 76%|███████▌  | 1658807/2196017 [00:36<00:09, 54967.07it/s]
 76%|███████▌  | 1664305/2196017 [00:36<00:09, 54748.62it/s]
 76%|███████▌  | 1669781/2196017 [00:36<00:09, 54634.52it/s]
 76%|███████▋  | 1675245/2196017 [00:37<00:09, 54108.90it/s]
 77%|███████▋  | 1680700/2196017 [00:37<00:09, 54239.34it/s]
 77%|███████▋  | 1686439/2196017 [00:37<00:09, 55147.13it/s]
 77%|███████▋  | 1691993/2196017 [00:37<00:09, 55262.10it/s]
 77%|███████▋  | 1697755/2196017 [00:37<00:08, 55946.83it/s]
 78%|███████▊  | 1703519/2196017 [00:37<00:08, 56441.85it/s]
 78%|███████▊  | 1709292/2196017 [00:37<00:08, 56820.91it/s]
 78%|███████▊  | 1714978/2196017 [00:37<00:08, 56810.96it/s]
 78%|███████▊  | 1720662/2196017 [00:37<00:08, 56720.00it/s]
 79%|███████▊  | 1726336/2196017 [00:37<00:08, 56397.74it/s]
 79%|███████▉  | 1731978/2196017 [00:38<00:08, 56345.65it/s]
 79%|███████▉  | 1737614/2196017 [00:38<00:08, 55449.52it/s]
 79%|███████▉  | 1743163/2196017 [00:38<00:08, 55256.77it/s]
 80%|███████▉  | 1748707/2196017 [00:38<00:08, 55311.51it/s]
 80%|███████▉  | 1754368/2196017 [00:38<00:07, 55691.99it/s]
 80%|████████  | 1759940/2196017 [00:38<00:07, 55370.19it/s]
 80%|████████  | 1765690/2196017 [00:38<00:07, 55990.83it/s]
 81%|████████  | 1771322/2196017 [00:38<00:07, 56088.20it/s]
 81%|████████  | 1777013/2196017 [00:38<00:07, 56329.74it/s]
 81%|████████  | 1782648/2196017 [00:39<00:07, 56032.92it/s]
 81%|████████▏ | 1788253/2196017 [00:39<00:07, 55860.06it/s]
 82%|████████▏ | 1793841/2196017 [00:39<00:07, 55680.00it/s]
 82%|████████▏ | 1799518/2196017 [00:39<00:07, 56000.70it/s]
 82%|████████▏ | 1805120/2196017 [00:39<00:07, 55633.50it/s]
 82%|████████▏ | 1810685/2196017 [00:39<00:06, 55561.82it/s]
 83%|████████▎ | 1816243/2196017 [00:39<00:06, 55143.23it/s]
 83%|████████▎ | 1821759/2196017 [00:39<00:06, 54850.53it/s]
 83%|████████▎ | 1827246/2196017 [00:39<00:06, 54488.26it/s]
 83%|████████▎ | 1832697/2196017 [00:39<00:06, 54181.64it/s]
 84%|████████▎ | 1838117/2196017 [00:40<00:06, 54124.85it/s]
 84%|████████▍ | 1843531/2196017 [00:40<00:06, 53705.90it/s]
 84%|████████▍ | 1848938/2196017 [00:40<00:06, 53814.21it/s]
 84%|████████▍ | 1854321/2196017 [00:40<00:06, 53747.47it/s]
 85%|████████▍ | 1859947/2196017 [00:40<00:06, 54475.32it/s]
 85%|████████▍ | 1865673/2196017 [00:40<00:05, 55281.73it/s]
 85%|████████▌ | 1871354/2196017 [00:40<00:05, 55731.09it/s]
 85%|████████▌ | 1876932/2196017 [00:40<00:05, 53561.48it/s]
 86%|████████▌ | 1882310/2196017 [00:40<00:05, 53563.07it/s]
 86%|████████▌ | 1887725/2196017 [00:40<00:05, 53735.69it/s]
 86%|████████▌ | 1893110/2196017 [00:41<00:05, 53545.16it/s]
 86%|████████▋ | 1898523/2196017 [00:41<00:05, 53717.12it/s]
 87%|████████▋ | 1903901/2196017 [00:41<00:05, 53663.19it/s]
 87%|████████▋ | 1909354/2196017 [00:41<00:05, 53918.44it/s]
 87%|████████▋ | 1914749/2196017 [00:41<00:05, 53717.22it/s]
 87%|████████▋ | 1920238/2196017 [00:41<00:05, 54061.07it/s]
 88%|████████▊ | 1925647/2196017 [00:41<00:05, 53671.93it/s]
 88%|████████▊ | 1931194/2196017 [00:41<00:04, 54197.76it/s]
 88%|████████▊ | 1936923/2196017 [00:41<00:04, 55087.66it/s]
 88%|████████▊ | 1942438/2196017 [00:41<00:04, 54636.26it/s]
 89%|████████▊ | 1947913/2196017 [00:42<00:04, 54669.88it/s]
 89%|████████▉ | 1953384/2196017 [00:42<00:04, 54497.72it/s]
 89%|████████▉ | 1958837/2196017 [00:42<00:04, 54439.97it/s]
 89%|████████▉ | 1964355/2196017 [00:42<00:04, 54659.47it/s]
 90%|████████▉ | 1969823/2196017 [00:42<00:04, 54084.57it/s]
 90%|████████▉ | 1975234/2196017 [00:42<00:04, 53433.99it/s]
 90%|█████████ | 1980754/2196017 [00:42<00:03, 53949.45it/s]
 90%|█████████ | 1986341/2196017 [00:42<00:03, 54509.53it/s]
 91%|█████████ | 1991796/2196017 [00:42<00:03, 53981.61it/s]
 91%|█████████ | 1997199/2196017 [00:42<00:03, 53392.58it/s]
 91%|█████████ | 2002737/2196017 [00:43<00:03, 53971.24it/s]
 91%|█████████▏| 2008235/2196017 [00:43<00:03, 54268.59it/s]
 92%|█████████▏| 2013878/2196017 [00:43<00:03, 54899.29it/s]
 92%|█████████▏| 2019373/2196017 [00:43<00:03, 54542.00it/s]
 92%|█████████▏| 2025034/2196017 [00:43<00:03, 55143.07it/s]
 92%|█████████▏| 2030606/2196017 [00:43<00:02, 55314.51it/s]
 93%|█████████▎| 2036141/2196017 [00:43<00:02, 54753.45it/s]
 93%|█████████▎| 2041752/2196017 [00:43<00:02, 55152.26it/s]
 93%|█████████▎| 2047400/2196017 [00:43<00:02, 55541.34it/s]
 93%|█████████▎| 2053009/2196017 [00:43<00:02, 55703.95it/s]
 94%|█████████▎| 2058582/2196017 [00:44<00:02, 54881.58it/s]
 94%|█████████▍| 2064075/2196017 [00:44<00:02, 54618.68it/s]
 94%|█████████▍| 2069541/2196017 [00:44<00:02, 54453.42it/s]
 94%|█████████▍| 2074989/2196017 [00:44<00:02, 54448.48it/s]
 95%|█████████▍| 2080552/2196017 [00:44<00:02, 54794.25it/s]
 95%|█████████▍| 2086115/2196017 [00:44<00:01, 55041.76it/s]
 95%|█████████▌| 2091733/2196017 [00:44<00:01, 55376.03it/s]
 96%|█████████▌| 2097384/2196017 [00:44<00:01, 55708.96it/s]
 96%|█████████▌| 2103154/2196017 [00:44<00:01, 56289.66it/s]
 96%|█████████▌| 2108786/2196017 [00:44<00:01, 54795.17it/s]
 96%|█████████▋| 2114276/2196017 [00:45<00:01, 54624.71it/s]
 97%|█████████▋| 2119788/2196017 [00:45<00:01, 54771.33it/s]
 97%|█████████▋| 2125375/2196017 [00:45<00:01, 55096.07it/s]
 97%|█████████▋| 2130889/2196017 [00:45<00:01, 54472.24it/s]
 97%|█████████▋| 2136341/2196017 [00:45<00:01, 54375.72it/s]
 98%|█████████▊| 2141782/2196017 [00:45<00:01, 53762.95it/s]
 98%|█████████▊| 2147163/2196017 [00:45<00:00, 53299.15it/s]
 98%|█████████▊| 2152497/2196017 [00:45<00:00, 52902.90it/s]
 98%|█████████▊| 2157791/2196017 [00:45<00:00, 52540.34it/s]
 98%|█████████▊| 2163061/2196017 [00:46<00:00, 52585.75it/s]
 99%|█████████▊| 2168363/2196017 [00:46<00:00, 52714.65it/s]
 99%|█████████▉| 2173636/2196017 [00:46<00:00, 52685.74it/s]
 99%|█████████▉| 2178906/2196017 [00:46<00:00, 52218.40it/s]
 99%|█████████▉| 2184171/2196017 [00:46<00:00, 52345.32it/s]
100%|█████████▉| 2189448/2196017 [00:46<00:00, 52470.19it/s]
100%|█████████▉| 2194720/2196017 [00:46<00:00, 52541.04it/s]
100%|██████████| 2196017/2196017 [00:46<00:00, 46986.67it/s]
[2022-05-31 11:15:53,124] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 11:16:04,562] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f8bfb979b80>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f8bfb979b80>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 11:16:04,752] INFO: Vocab size: 64518
[2022-05-31 11:16:04,752] INFO: Nb labels: 2
[2022-05-31 11:16:04,753] INFO: Total params: 21123803
[2022-05-31 11:16:04,753] INFO: Learnable params: 1768403
[2022-05-31 11:16:04,757] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)

  0%|          | 0/8214 [00:00<?, ?ex/s]
  0%|          | 1/8214 [00:00<36:42,  3.73ex/s]
  4%|▍         | 339/8214 [00:00<24:38,  5.33ex/s]
  8%|▊         | 672/8214 [00:00<16:31,  7.60ex/s]
 12%|█▏        | 986/8214 [00:00<11:06, 10.85ex/s]
 15%|█▍        | 1200/8214 [00:01<07:43, 15.14ex/s]
 18%|█▊        | 1512/8214 [00:01<05:10, 21.58ex/s]
 22%|██▏       | 1833/8214 [00:01<03:27, 30.74ex/s]
 25%|██▌       | 2071/8214 [00:01<02:20, 43.64ex/s]
 29%|██▉       | 2391/8214 [00:02<01:33, 61.98ex/s]
 33%|███▎      | 2718/8214 [00:02<01:02, 87.83ex/s]
 37%|███▋      | 3000/8214 [00:02<00:42, 123.45ex/s]
 41%|████      | 3329/8214 [00:02<00:28, 173.56ex/s]
 45%|████▍     | 3664/8214 [00:02<00:18, 242.55ex/s]
 49%|████▊     | 3990/8214 [00:02<00:12, 335.78ex/s]
 52%|█████▏    | 4297/8214 [00:02<00:08, 453.61ex/s]
 56%|█████▌    | 4619/8214 [00:02<00:05, 611.09ex/s]
 60%|██████    | 4940/8214 [00:02<00:04, 807.11ex/s]
 64%|██████▍   | 5246/8214 [00:03<00:02, 1011.21ex/s]
 68%|██████▊   | 5572/8214 [00:03<00:02, 1274.86ex/s]
 72%|███████▏  | 5894/8214 [00:03<00:01, 1556.90ex/s]
 75%|███████▌  | 6201/8214 [00:03<00:01, 1714.31ex/s]
 80%|███████▉  | 6553/8214 [00:03<00:00, 2025.44ex/s]
 84%|████████▍ | 6882/8214 [00:03<00:00, 2288.43ex/s]
 88%|████████▊ | 7193/8214 [00:03<00:00, 2338.42ex/s]
 92%|█████████▏| 7520/8214 [00:03<00:00, 2555.85ex/s]
 95%|█████████▌| 7839/8214 [00:03<00:00, 2717.23ex/s]
 99%|█████████▉| 8146/8214 [00:04<00:00, 2630.46ex/s]
100%|██████████| 8214/8214 [00:04<00:00, 2015.38ex/s]

  0%|          | 0/1369 [00:00<?, ?ex/s]
 26%|██▌       | 356/1369 [00:00<00:00, 3556.45ex/s]
 51%|█████     | 693/1369 [00:00<00:00, 3497.01ex/s]
 73%|███████▎  | 1000/1369 [00:00<00:00, 2976.89ex/s]
 97%|█████████▋| 1334/1369 [00:00<00:00, 3077.06ex/s]
100%|██████████| 1369/1369 [00:00<00:00, 3041.55ex/s]

  0%|          | 0/1369 [00:00<?, ?ex/s]
  7%|▋         | 95/1369 [00:00<00:01, 948.95ex/s]
 13%|█▎        | 174/1369 [00:00<00:01, 789.24ex/s]
 23%|██▎       | 320/1369 [00:00<00:01, 823.12ex/s]
 32%|███▏      | 432/1369 [00:00<00:01, 874.53ex/s]
 38%|███▊      | 525/1369 [00:00<00:00, 870.98ex/s]
 61%|██████▏   | 840/1369 [00:00<00:00, 1112.25ex/s]
 75%|███████▍  | 1020/1369 [00:00<00:00, 1255.56ex/s]
 97%|█████████▋| 1331/1369 [00:00<00:00, 1528.77ex/s]
100%|██████████| 1369/1369 [00:00<00:00, 1474.95ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
numpy.__version__
1.21.4
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])

Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]
Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 82, in _make_variables
    scores.append(self._ravel(var._scores))
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 52, in _ravel
    return x.view(-1)
TypeError: Cannot interpret '-1' as a data type


                                                                   