	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 09:49:56,792] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 09:50:02,277] INFO: Building board loggers...
[2022-05-31 09:50:02,277] INFO: Building callbacks...
[2022-05-31 09:50:02,278] INFO: Building model: spectra...
[2022-05-31 09:50:02,653] INFO: Created a temporary directory at /tmp/tmpvnmg54tw
[2022-05-31 09:50:02,653] INFO: Writing /tmp/tmpvnmg54tw/_remote_module_non_sriptable.py
[2022-05-31 09:50:03,590] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 09:50:13,958] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<92:49:57,  6.57it/s]  0%|          | 1082/2196017 [00:00<64:58:04,  9.38it/s]  0%|          | 2349/2196017 [00:00<45:27:56, 13.40it/s]  0%|          | 3671/2196017 [00:00<31:49:14, 19.14it/s]  0%|          | 5007/2196017 [00:00<22:16:28, 27.32it/s]  0%|          | 6419/2196017 [00:00<15:35:42, 39.00it/s]  0%|          | 7842/2196017 [00:00<10:55:20, 55.65it/s]  0%|          | 9289/2196017 [00:00<7:39:11, 79.37it/s]   0%|          | 10781/2196017 [00:00<5:21:56, 113.13it/s]  1%|          | 12306/2196017 [00:01<3:45:55, 161.10it/s]  1%|          | 13860/2196017 [00:01<2:38:44, 229.12it/s]  1%|          | 15465/2196017 [00:01<1:51:42, 325.32it/s]  1%|          | 17043/2196017 [00:01<1:18:49, 460.68it/s]  1%|          | 18697/2196017 [00:01<55:47, 650.34it/s]    1%|          | 20307/2196017 [00:01<39:42, 913.25it/s]  1%|          | 22037/2196017 [00:01<28:24, 1275.76it/s]  1%|          | 23793/2196017 [00:01<20:29, 1767.44it/s]  1%|          | 25535/2196017 [00:01<14:57, 2419.65it/s]  1%|          | 27336/2196017 [00:01<11:03, 3268.36it/s]  1%|▏         | 29113/2196017 [00:02<08:20, 4327.73it/s]  1%|▏         | 30993/2196017 [00:02<06:24, 5627.13it/s]  2%|▏         | 32955/2196017 [00:02<05:02, 7158.65it/s]  2%|▏         | 34963/2196017 [00:02<04:03, 8870.50it/s]  2%|▏         | 36889/2196017 [00:02<03:24, 10583.09it/s]  2%|▏         | 38859/2196017 [00:02<02:55, 12289.02it/s]  2%|▏         | 40888/2196017 [00:02<02:34, 13936.64it/s]  2%|▏         | 42948/2196017 [00:02<02:19, 15433.83it/s]  2%|▏         | 45122/2196017 [00:02<02:07, 16903.28it/s]  2%|▏         | 47420/2196017 [00:02<01:57, 18358.97it/s]  2%|▏         | 49591/2196017 [00:03<01:51, 19245.96it/s]  2%|▏         | 51846/2196017 [00:03<01:46, 20127.17it/s]  2%|▏         | 54097/2196017 [00:03<01:43, 20787.13it/s]  3%|▎         | 56443/2196017 [00:03<01:39, 21518.25it/s]  3%|▎         | 58813/2196017 [00:03<01:36, 22128.93it/s]  3%|▎         | 61233/2196017 [00:03<01:33, 22711.08it/s]  3%|▎         | 63691/2196017 [00:03<01:31, 23235.16it/s]  3%|▎         | 66279/2196017 [00:03<01:28, 23969.44it/s]  3%|▎         | 68854/2196017 [00:03<01:26, 24472.79it/s]  3%|▎         | 71506/2196017 [00:03<01:24, 25052.48it/s]  3%|▎         | 74205/2196017 [00:04<01:22, 25603.52it/s]  4%|▎         | 77037/2196017 [00:04<01:20, 26362.10it/s]  4%|▎         | 79977/2196017 [00:04<01:17, 27204.19it/s]  4%|▍         | 82833/2196017 [00:04<01:16, 27596.60it/s]  4%|▍         | 85824/2196017 [00:04<01:14, 28247.54it/s]  4%|▍         | 88792/2196017 [00:04<01:13, 28661.78it/s]  4%|▍         | 91827/2196017 [00:04<01:12, 29141.19it/s]  4%|▍         | 94923/2196017 [00:04<01:10, 29663.58it/s]  4%|▍         | 98000/2196017 [00:04<01:09, 29984.37it/s]  5%|▍         | 101197/2196017 [00:04<01:08, 30552.32it/s]  5%|▍         | 104614/2196017 [00:05<01:06, 31553.12it/s]  5%|▍         | 107983/2196017 [00:05<01:04, 32164.85it/s]  5%|▌         | 111357/2196017 [00:05<01:03, 32620.91it/s]  5%|▌         | 114886/2196017 [00:05<01:02, 33370.30it/s]  5%|▌         | 118444/2196017 [00:05<01:01, 33994.84it/s]  6%|▌         | 122005/2196017 [00:05<01:00, 34463.54it/s]  6%|▌         | 125530/2196017 [00:05<00:59, 34694.97it/s]  6%|▌         | 129232/2196017 [00:05<00:58, 35350.41it/s]  6%|▌         | 132980/2196017 [00:05<00:57, 35963.30it/s]  6%|▌         | 136778/2196017 [00:05<00:56, 36543.71it/s]  6%|▋         | 140541/2196017 [00:06<00:55, 36855.78it/s]  7%|▋         | 144444/2196017 [00:06<00:54, 37480.54it/s]  7%|▋         | 148257/2196017 [00:06<00:54, 37671.51it/s]  7%|▋         | 152228/2196017 [00:06<00:53, 38258.77it/s]  7%|▋         | 156198/2196017 [00:06<00:52, 38678.51it/s]  7%|▋         | 160351/2196017 [00:06<00:51, 39491.15it/s]  7%|▋         | 164467/2196017 [00:06<00:50, 39976.68it/s]  8%|▊         | 168557/2196017 [00:06<00:50, 40249.17it/s]  8%|▊         | 172758/2196017 [00:06<00:49, 40750.68it/s]  8%|▊         | 176948/2196017 [00:06<00:49, 41088.43it/s]  8%|▊         | 181110/2196017 [00:07<00:48, 41246.25it/s]  8%|▊         | 185457/2196017 [00:07<00:47, 41888.61it/s]  9%|▊         | 189761/2196017 [00:07<00:47, 42226.36it/s]  9%|▉         | 194054/2196017 [00:07<00:47, 42434.22it/s]  9%|▉         | 198476/2196017 [00:07<00:46, 42953.35it/s]  9%|▉         | 202900/2196017 [00:07<00:45, 43330.73it/s]  9%|▉         | 207350/2196017 [00:07<00:45, 43674.59it/s] 10%|▉         | 211792/2196017 [00:07<00:45, 43895.18it/s] 10%|▉         | 216229/2196017 [00:07<00:44, 44034.51it/s] 10%|█         | 220733/2196017 [00:07<00:44, 44330.70it/s] 10%|█         | 225260/2196017 [00:08<00:44, 44608.14it/s] 10%|█         | 229907/2196017 [00:08<00:43, 45150.19it/s] 11%|█         | 234567/2196017 [00:08<00:43, 45573.48it/s] 11%|█         | 239148/2196017 [00:08<00:42, 45642.11it/s] 11%|█         | 243831/2196017 [00:08<00:42, 45992.05it/s] 11%|█▏        | 248514/2196017 [00:08<00:42, 46238.29it/s] 12%|█▏        | 253292/2196017 [00:08<00:41, 46686.03it/s] 12%|█▏        | 257963/2196017 [00:08<00:41, 46529.55it/s] 12%|█▏        | 262636/2196017 [00:08<00:41, 46587.85it/s] 12%|█▏        | 267401/2196017 [00:08<00:41, 46899.79it/s] 12%|█▏        | 272093/2196017 [00:09<00:41, 46874.59it/s] 13%|█▎        | 276825/2196017 [00:09<00:40, 47006.24it/s] 13%|█▎        | 281681/2196017 [00:09<00:40, 47461.05it/s] 13%|█▎        | 286513/2196017 [00:09<00:40, 47714.61it/s] 13%|█▎        | 291286/2196017 [00:09<00:39, 47635.34it/s] 13%|█▎        | 296051/2196017 [00:09<00:40, 47370.85it/s] 14%|█▎        | 300864/2196017 [00:09<00:39, 47594.40it/s] 14%|█▍        | 305662/2196017 [00:09<00:39, 47707.00it/s] 14%|█▍        | 310618/2196017 [00:09<00:39, 48246.89it/s] 14%|█▍        | 315445/2196017 [00:09<00:39, 48217.91it/s] 15%|█▍        | 320317/2196017 [00:10<00:38, 48367.08it/s] 15%|█▍        | 325262/2196017 [00:10<00:38, 48686.82it/s] 15%|█▌        | 330132/2196017 [00:10<00:38, 48677.00it/s] 15%|█▌        | 335004/2196017 [00:10<00:38, 48678.04it/s] 15%|█▌        | 339873/2196017 [00:10<00:38, 48669.81it/s] 16%|█▌        | 344741/2196017 [00:10<00:38, 48553.05it/s] 16%|█▌        | 349718/2196017 [00:10<00:37, 48911.79it/s] 16%|█▌        | 354634/2196017 [00:10<00:37, 48985.06it/s] 16%|█▋        | 359535/2196017 [00:10<00:37, 48990.03it/s] 17%|█▋        | 364593/2196017 [00:10<00:37, 49453.98it/s] 17%|█▋        | 369713/2196017 [00:11<00:36, 49963.08it/s] 17%|█▋        | 374861/2196017 [00:11<00:36, 50408.31it/s] 17%|█▋        | 379941/2196017 [00:11<00:35, 50522.72it/s] 18%|█▊        | 385095/2196017 [00:11<00:35, 50821.02it/s] 18%|█▊        | 390224/2196017 [00:11<00:35, 50959.34it/s] 18%|█▊        | 395322/2196017 [00:11<00:35, 50902.58it/s] 18%|█▊        | 400489/2196017 [00:11<00:35, 51130.27it/s] 18%|█▊        | 405628/2196017 [00:11<00:34, 51205.81it/s] 19%|█▊        | 410750/2196017 [00:11<00:35, 50951.60it/s] 19%|█▉        | 415864/2196017 [00:11<00:34, 51006.68it/s] 19%|█▉        | 420966/2196017 [00:12<00:34, 50966.73it/s] 19%|█▉        | 426102/2196017 [00:12<00:34, 51082.10it/s] 20%|█▉        | 431211/2196017 [00:12<00:34, 50927.47it/s] 20%|█▉        | 436353/2196017 [00:12<00:34, 51071.82it/s] 20%|██        | 441497/2196017 [00:12<00:34, 51179.51it/s] 20%|██        | 446695/2196017 [00:12<00:34, 51416.56it/s] 21%|██        | 451838/2196017 [00:12<00:33, 51315.58it/s] 21%|██        | 456970/2196017 [00:12<00:34, 51011.00it/s] 21%|██        | 462072/2196017 [00:12<00:34, 49778.99it/s] 21%|██▏       | 467057/2196017 [00:12<00:34, 49525.39it/s] 21%|██▏       | 472119/2196017 [00:13<00:34, 49846.43it/s] 22%|██▏       | 477305/2196017 [00:13<00:34, 50433.66it/s] 22%|██▏       | 482353/2196017 [00:13<00:34, 50020.13it/s] 22%|██▏       | 487359/2196017 [00:13<00:34, 49760.37it/s] 22%|██▏       | 492339/2196017 [00:13<00:34, 49756.76it/s] 23%|██▎       | 497322/2196017 [00:13<00:34, 49778.65it/s] 23%|██▎       | 502335/2196017 [00:13<00:33, 49881.78it/s] 23%|██▎       | 507339/2196017 [00:13<00:33, 49926.87it/s] 23%|██▎       | 512421/2196017 [00:13<00:33, 50190.48it/s] 24%|██▎       | 517441/2196017 [00:13<00:33, 49785.32it/s] 24%|██▍       | 522449/2196017 [00:14<00:33, 49872.56it/s] 24%|██▍       | 527553/2196017 [00:14<00:33, 50213.06it/s] 24%|██▍       | 532704/2196017 [00:14<00:32, 50593.11it/s] 24%|██▍       | 537769/2196017 [00:14<00:32, 50608.66it/s] 25%|██▍       | 542831/2196017 [00:14<00:32, 50438.22it/s] 25%|██▍       | 547961/2196017 [00:14<00:32, 50692.53it/s] 25%|██▌       | 553142/2196017 [00:14<00:32, 51022.19it/s] 25%|██▌       | 558278/2196017 [00:14<00:32, 51120.75it/s] 26%|██▌       | 563391/2196017 [00:14<00:32, 50904.31it/s] 26%|██▌       | 568483/2196017 [00:14<00:32, 50450.81it/s] 26%|██▌       | 573530/2196017 [00:15<00:32, 50304.39it/s] 26%|██▋       | 578562/2196017 [00:15<00:32, 50216.01it/s] 27%|██▋       | 583702/2196017 [00:15<00:31, 50563.10it/s] 27%|██▋       | 588830/2196017 [00:15<00:31, 50775.82it/s] 27%|██▋       | 593956/2196017 [00:15<00:31, 50919.40it/s] 27%|██▋       | 599049/2196017 [00:15<00:31, 50917.24it/s] 28%|██▊       | 604144/2196017 [00:15<00:31, 50926.57it/s] 28%|██▊       | 609238/2196017 [00:15<00:31, 50370.91it/s] 28%|██▊       | 614444/2196017 [00:15<00:31, 50863.44it/s] 28%|██▊       | 619533/2196017 [00:15<00:31, 50606.73it/s] 28%|██▊       | 624614/2196017 [00:16<00:31, 50665.61it/s] 29%|██▊       | 629815/2196017 [00:16<00:30, 51056.24it/s] 29%|██▉       | 634923/2196017 [00:16<00:30, 50946.23it/s] 29%|██▉       | 640114/2196017 [00:16<00:30, 51229.75it/s] 29%|██▉       | 645239/2196017 [00:16<00:30, 51122.81it/s] 30%|██▉       | 650365/2196017 [00:16<00:30, 51163.43it/s] 30%|██▉       | 655551/2196017 [00:16<00:29, 51370.33it/s] 30%|███       | 660689/2196017 [00:16<00:30, 51131.57it/s] 30%|███       | 665803/2196017 [00:16<00:30, 50570.85it/s] 31%|███       | 670862/2196017 [00:17<00:30, 50444.48it/s] 31%|███       | 675978/2196017 [00:17<00:30, 50655.07it/s] 31%|███       | 681108/2196017 [00:17<00:29, 50845.45it/s] 31%|███       | 686194/2196017 [00:17<00:29, 50593.92it/s] 31%|███▏      | 691329/2196017 [00:17<00:29, 50818.09it/s] 32%|███▏      | 696412/2196017 [00:17<00:29, 50369.29it/s] 32%|███▏      | 701555/2196017 [00:17<00:29, 50681.18it/s] 32%|███▏      | 706807/2196017 [00:17<00:29, 51217.68it/s] 32%|███▏      | 711964/2196017 [00:17<00:28, 51320.25it/s] 33%|███▎      | 717131/2196017 [00:17<00:28, 51423.34it/s] 33%|███▎      | 722275/2196017 [00:18<00:28, 51396.41it/s] 33%|███▎      | 727501/2196017 [00:18<00:28, 51644.64it/s] 33%|███▎      | 732734/2196017 [00:18<00:28, 51846.42it/s] 34%|███▎      | 737951/2196017 [00:18<00:28, 51940.91it/s] 34%|███▍      | 743156/2196017 [00:18<00:27, 51971.11it/s] 34%|███▍      | 748354/2196017 [00:18<00:28, 51671.11it/s] 34%|███▍      | 753522/2196017 [00:18<00:28, 51459.16it/s] 35%|███▍      | 758669/2196017 [00:18<00:27, 51454.00it/s] 35%|███▍      | 763822/2196017 [00:18<00:27, 51475.61it/s] 35%|███▌      | 769032/2196017 [00:18<00:27, 51658.99it/s] 35%|███▌      | 774230/2196017 [00:19<00:27, 51753.34it/s] 35%|███▌      | 779484/2196017 [00:19<00:27, 51984.99it/s] 36%|███▌      | 784710/2196017 [00:19<00:27, 52065.28it/s] 36%|███▌      | 789917/2196017 [00:19<00:27, 52039.46it/s] 36%|███▌      | 795231/2196017 [00:19<00:26, 52363.57it/s] 36%|███▋      | 800469/2196017 [00:19<00:26, 52330.75it/s] 37%|███▋      | 805721/2196017 [00:19<00:26, 52385.53it/s] 37%|███▋      | 810960/2196017 [00:19<00:26, 52270.88it/s] 37%|███▋      | 816188/2196017 [00:19<00:26, 52193.86it/s] 37%|███▋      | 821408/2196017 [00:19<00:26, 51992.50it/s] 38%|███▊      | 826608/2196017 [00:20<00:26, 51831.70it/s] 38%|███▊      | 831792/2196017 [00:20<00:26, 51118.35it/s] 38%|███▊      | 837016/2196017 [00:20<00:26, 51447.16it/s] 38%|███▊      | 842218/2196017 [00:20<00:26, 51615.28it/s] 39%|███▊      | 847399/2196017 [00:20<00:26, 51671.49it/s] 39%|███▉      | 852625/2196017 [00:20<00:25, 51845.19it/s] 39%|███▉      | 857811/2196017 [00:20<00:25, 51759.11it/s] 39%|███▉      | 863041/2196017 [00:20<00:25, 51918.04it/s] 40%|███▉      | 868234/2196017 [00:20<00:25, 51774.98it/s] 40%|███▉      | 873413/2196017 [00:20<00:25, 51764.92it/s] 40%|████      | 878590/2196017 [00:21<00:25, 50745.06it/s] 40%|████      | 883775/2196017 [00:21<00:25, 51070.17it/s] 40%|████      | 888966/2196017 [00:21<00:25, 51316.95it/s] 41%|████      | 894191/2196017 [00:21<00:25, 51593.18it/s] 41%|████      | 899436/2196017 [00:21<00:25, 51844.57it/s] 41%|████      | 904623/2196017 [00:21<00:24, 51737.98it/s] 41%|████▏     | 909800/2196017 [00:21<00:24, 51746.71it/s] 42%|████▏     | 914976/2196017 [00:21<00:24, 51389.31it/s] 42%|████▏     | 920117/2196017 [00:21<00:24, 51182.97it/s] 42%|████▏     | 925237/2196017 [00:21<00:24, 50997.47it/s] 42%|████▏     | 930379/2196017 [00:22<00:24, 51120.28it/s] 43%|████▎     | 935492/2196017 [00:22<00:24, 51025.70it/s] 43%|████▎     | 940695/2196017 [00:22<00:24, 51321.25it/s] 43%|████▎     | 945828/2196017 [00:22<00:24, 51309.43it/s] 43%|████▎     | 950976/2196017 [00:22<00:24, 51358.96it/s] 44%|████▎     | 956260/2196017 [00:22<00:23, 51794.31it/s] 44%|████▍     | 961441/2196017 [00:22<00:23, 51596.91it/s] 44%|████▍     | 966629/2196017 [00:22<00:23, 51679.13it/s] 44%|████▍     | 971889/2196017 [00:22<00:23, 51949.73it/s] 44%|████▍     | 977085/2196017 [00:22<00:23, 51914.03it/s] 45%|████▍     | 982277/2196017 [00:23<00:23, 51904.96it/s] 45%|████▍     | 987468/2196017 [00:23<00:23, 51762.81it/s] 45%|████▌     | 992736/2196017 [00:23<00:23, 52034.42it/s] 45%|████▌     | 998009/2196017 [00:23<00:22, 52240.07it/s] 46%|████▌     | 1003299/2196017 [00:23<00:22, 52434.39it/s] 46%|████▌     | 1008544/2196017 [00:23<00:22, 51944.31it/s] 46%|████▌     | 1013793/2196017 [00:23<00:22, 52105.50it/s] 46%|████▋     | 1019005/2196017 [00:23<00:22, 51983.07it/s] 47%|████▋     | 1024205/2196017 [00:23<00:22, 51923.59it/s] 47%|████▋     | 1029398/2196017 [00:23<00:22, 51906.78it/s] 47%|████▋     | 1034599/2196017 [00:24<00:22, 51936.35it/s] 47%|████▋     | 1039793/2196017 [00:24<00:22, 51858.12it/s] 48%|████▊     | 1045075/2196017 [00:24<00:22, 52140.68it/s] 48%|████▊     | 1050290/2196017 [00:24<00:22, 51795.07it/s] 48%|████▊     | 1055483/2196017 [00:24<00:22, 51833.68it/s] 48%|████▊     | 1060745/2196017 [00:24<00:21, 52065.56it/s] 49%|████▊     | 1066036/2196017 [00:24<00:21, 52313.59it/s] 49%|████▉     | 1071333/2196017 [00:24<00:21, 52507.69it/s] 49%|████▉     | 1076585/2196017 [00:24<00:21, 52510.76it/s] 49%|████▉     | 1081837/2196017 [00:24<00:21, 52400.64it/s] 50%|████▉     | 1087078/2196017 [00:25<00:21, 51416.15it/s] 50%|████▉     | 1092258/2196017 [00:25<00:21, 51530.21it/s] 50%|████▉     | 1097471/2196017 [00:25<00:21, 51708.38it/s] 50%|█████     | 1102659/2196017 [00:25<00:21, 51756.40it/s] 50%|█████     | 1107865/2196017 [00:25<00:20, 51846.57it/s] 51%|█████     | 1113234/2196017 [00:25<00:20, 52384.13it/s] 51%|█████     | 1118475/2196017 [00:25<00:20, 52241.19it/s] 51%|█████     | 1123706/2196017 [00:25<00:20, 52258.50it/s] 51%|█████▏    | 1128959/2196017 [00:25<00:20, 52338.14it/s] 52%|█████▏    | 1134246/2196017 [00:25<00:20, 52495.69it/s] 52%|█████▏    | 1139497/2196017 [00:26<00:20, 52482.89it/s] 52%|█████▏    | 1144773/2196017 [00:26<00:19, 52564.90it/s] 52%|█████▏    | 1150108/2196017 [00:26<00:19, 52797.79it/s] 53%|█████▎    | 1155389/2196017 [00:26<00:19, 52721.16it/s] 53%|█████▎    | 1160662/2196017 [00:26<00:19, 52629.01it/s] 53%|█████▎    | 1165926/2196017 [00:26<00:19, 52174.68it/s] 53%|█████▎    | 1171215/2196017 [00:26<00:19, 52386.32it/s] 54%|█████▎    | 1176506/2196017 [00:26<00:19, 52539.89it/s] 54%|█████▍    | 1181761/2196017 [00:26<00:19, 52511.32it/s] 54%|█████▍    | 1187079/2196017 [00:26<00:19, 52707.36it/s] 54%|█████▍    | 1192351/2196017 [00:27<00:19, 52601.55it/s] 55%|█████▍    | 1197612/2196017 [00:27<00:19, 52404.30it/s] 55%|█████▍    | 1202853/2196017 [00:27<00:18, 52359.03it/s] 55%|█████▌    | 1208090/2196017 [00:27<00:18, 52133.08it/s] 55%|█████▌    | 1213355/2196017 [00:27<00:18, 52285.54it/s] 55%|█████▌    | 1218584/2196017 [00:27<00:18, 52031.83it/s] 56%|█████▌    | 1223788/2196017 [00:27<00:18, 51988.68it/s] 56%|█████▌    | 1229041/2196017 [00:27<00:18, 52148.28it/s] 56%|█████▌    | 1234257/2196017 [00:27<00:18, 52079.08it/s] 56%|█████▋    | 1239466/2196017 [00:27<00:18, 52060.74it/s] 57%|█████▋    | 1244700/2196017 [00:28<00:18, 52143.32it/s] 57%|█████▋    | 1249915/2196017 [00:28<00:18, 51919.39it/s] 57%|█████▋    | 1255219/2196017 [00:28<00:18, 52249.55it/s] 57%|█████▋    | 1260445/2196017 [00:28<00:18, 51628.93it/s] 58%|█████▊    | 1265686/2196017 [00:28<00:17, 51860.66it/s] 58%|█████▊    | 1270875/2196017 [00:28<00:17, 51867.40it/s] 58%|█████▊    | 1276157/2196017 [00:28<00:17, 52145.37it/s] 58%|█████▊    | 1281483/2196017 [00:28<00:17, 52474.25it/s] 59%|█████▊    | 1286732/2196017 [00:28<00:17, 52042.30it/s] 59%|█████▉    | 1292015/2196017 [00:28<00:17, 52273.63it/s] 59%|█████▉    | 1297257/2196017 [00:29<00:17, 52316.16it/s] 59%|█████▉    | 1302490/2196017 [00:29<00:17, 51615.80it/s] 60%|█████▉    | 1307739/2196017 [00:29<00:17, 51872.54it/s] 60%|█████▉    | 1312929/2196017 [00:29<00:17, 51706.18it/s] 60%|██████    | 1318266/2196017 [00:29<00:16, 52192.01it/s] 60%|██████    | 1323585/2196017 [00:29<00:16, 52479.28it/s] 61%|██████    | 1328835/2196017 [00:29<00:16, 52105.73it/s] 61%|██████    | 1334093/2196017 [00:29<00:16, 52244.60it/s] 61%|██████    | 1339319/2196017 [00:29<00:16, 52086.61it/s] 61%|██████    | 1344643/2196017 [00:29<00:16, 52426.37it/s] 61%|██████▏   | 1349887/2196017 [00:30<00:16, 52351.48it/s] 62%|██████▏   | 1355124/2196017 [00:30<00:16, 52191.38it/s] 62%|██████▏   | 1360344/2196017 [00:30<00:16, 52185.13it/s] 62%|██████▏   | 1365564/2196017 [00:30<00:15, 51947.99it/s] 62%|██████▏   | 1370779/2196017 [00:30<00:15, 52006.66it/s] 63%|██████▎   | 1375981/2196017 [00:30<00:15, 51717.54it/s] 63%|██████▎   | 1381154/2196017 [00:30<00:15, 51695.89it/s] 63%|██████▎   | 1386354/2196017 [00:30<00:15, 51784.41it/s] 63%|██████▎   | 1391554/2196017 [00:30<00:15, 51846.80it/s] 64%|██████▎   | 1396799/2196017 [00:30<00:15, 52024.80it/s] 64%|██████▍   | 1402002/2196017 [00:31<00:15, 51843.84it/s] 64%|██████▍   | 1407293/2196017 [00:31<00:15, 52156.99it/s] 64%|██████▍   | 1412510/2196017 [00:31<00:15, 52110.08it/s] 65%|██████▍   | 1417722/2196017 [00:31<00:14, 52111.65it/s] 65%|██████▍   | 1422988/2196017 [00:31<00:14, 52274.15it/s] 65%|██████▌   | 1428216/2196017 [00:31<00:14, 52029.47it/s] 65%|██████▌   | 1433567/2196017 [00:31<00:14, 52464.16it/s] 66%|██████▌   | 1438815/2196017 [00:31<00:14, 52222.23it/s] 66%|██████▌   | 1444070/2196017 [00:31<00:14, 52318.95it/s] 66%|██████▌   | 1449308/2196017 [00:31<00:14, 52336.44it/s] 66%|██████▌   | 1454543/2196017 [00:32<00:14, 51859.19it/s] 66%|██████▋   | 1459754/2196017 [00:32<00:14, 51932.34it/s] 67%|██████▋   | 1464949/2196017 [00:32<00:14, 51529.19it/s] 67%|██████▋   | 1470104/2196017 [00:32<00:14, 51258.03it/s] 67%|██████▋   | 1475232/2196017 [00:32<00:14, 51075.38it/s] 67%|██████▋   | 1480358/2196017 [00:32<00:13, 51129.66it/s] 68%|██████▊   | 1485520/2196017 [00:32<00:13, 51274.66it/s] 68%|██████▊   | 1490649/2196017 [00:32<00:13, 50943.21it/s] 68%|██████▊   | 1495880/2196017 [00:32<00:13, 51342.10it/s] 68%|██████▊   | 1501151/2196017 [00:33<00:13, 51743.77it/s] 69%|██████▊   | 1506328/2196017 [00:33<00:13, 51747.47it/s] 69%|██████▉   | 1511504/2196017 [00:33<00:13, 51623.77it/s] 69%|██████▉   | 1516668/2196017 [00:33<00:13, 51403.72it/s] 69%|██████▉   | 1522003/2196017 [00:33<00:12, 51971.28it/s] 70%|██████▉   | 1527274/2196017 [00:33<00:12, 52179.05it/s] 70%|██████▉   | 1532537/2196017 [00:33<00:12, 52310.97it/s] 70%|███████   | 1537845/2196017 [00:33<00:12, 52538.64it/s] 70%|███████   | 1543100/2196017 [00:33<00:12, 52315.04it/s] 71%|███████   | 1548347/2196017 [00:33<00:12, 52359.69it/s] 71%|███████   | 1553614/2196017 [00:34<00:12, 52450.47it/s] 71%|███████   | 1558861/2196017 [00:34<00:12, 52455.03it/s] 71%|███████   | 1564121/2196017 [00:34<00:12, 52496.09it/s] 71%|███████▏  | 1569371/2196017 [00:34<00:12, 52207.41it/s] 72%|███████▏  | 1574659/2196017 [00:34<00:11, 52406.47it/s] 72%|███████▏  | 1579975/2196017 [00:34<00:11, 52630.03it/s] 72%|███████▏  | 1585325/2196017 [00:34<00:11, 52885.28it/s] 72%|███████▏  | 1590723/2196017 [00:34<00:11, 53208.09it/s] 73%|███████▎  | 1596045/2196017 [00:34<00:11, 53121.94it/s] 73%|███████▎  | 1601358/2196017 [00:34<00:11, 53122.47it/s] 73%|███████▎  | 1606710/2196017 [00:35<00:11, 53239.57it/s] 73%|███████▎  | 1612035/2196017 [00:35<00:11, 53084.67it/s] 74%|███████▎  | 1617362/2196017 [00:35<00:10, 53138.03it/s] 74%|███████▍  | 1622677/2196017 [00:35<00:10, 52986.08it/s] 74%|███████▍  | 1627976/2196017 [00:35<00:10, 52986.44it/s] 74%|███████▍  | 1633275/2196017 [00:35<00:10, 52922.72it/s] 75%|███████▍  | 1638607/2196017 [00:35<00:10, 53040.69it/s] 75%|███████▍  | 1643945/2196017 [00:35<00:10, 53141.37it/s] 75%|███████▌  | 1649260/2196017 [00:35<00:10, 52991.88it/s] 75%|███████▌  | 1654560/2196017 [00:35<00:10, 52719.36it/s] 76%|███████▌  | 1659833/2196017 [00:36<00:10, 52421.49it/s] 76%|███████▌  | 1665169/2196017 [00:36<00:10, 52697.90it/s] 76%|███████▌  | 1670440/2196017 [00:36<00:09, 52663.24it/s] 76%|███████▋  | 1675707/2196017 [00:36<00:09, 52611.21it/s] 77%|███████▋  | 1681001/2196017 [00:36<00:09, 52709.06it/s] 77%|███████▋  | 1686273/2196017 [00:36<00:09, 52458.26it/s] 77%|███████▋  | 1691520/2196017 [00:36<00:09, 52341.08it/s] 77%|███████▋  | 1696890/2196017 [00:36<00:09, 52740.83it/s] 78%|███████▊  | 1702166/2196017 [00:36<00:09, 52705.89it/s] 78%|███████▊  | 1707438/2196017 [00:36<00:09, 52620.92it/s] 78%|███████▊  | 1712701/2196017 [00:37<00:09, 52530.67it/s] 78%|███████▊  | 1717955/2196017 [00:37<00:09, 52344.92it/s] 78%|███████▊  | 1723222/2196017 [00:37<00:09, 52439.91it/s] 79%|███████▊  | 1728467/2196017 [00:37<00:09, 51512.17it/s] 79%|███████▉  | 1733738/2196017 [00:37<00:08, 51864.50it/s] 79%|███████▉  | 1738959/2196017 [00:37<00:08, 51965.76it/s] 79%|███████▉  | 1744221/2196017 [00:37<00:08, 52158.45it/s] 80%|███████▉  | 1749478/2196017 [00:37<00:08, 52279.43it/s] 80%|███████▉  | 1754754/2196017 [00:37<00:08, 52420.57it/s] 80%|████████  | 1760014/2196017 [00:37<00:08, 52472.04it/s] 80%|████████  | 1765262/2196017 [00:38<00:08, 52266.05it/s] 81%|████████  | 1770490/2196017 [00:38<00:08, 52136.03it/s] 81%|████████  | 1775705/2196017 [00:38<00:08, 52049.19it/s] 81%|████████  | 1780911/2196017 [00:38<00:08, 51713.09it/s] 81%|████████▏ | 1786123/2196017 [00:38<00:07, 51831.97it/s] 82%|████████▏ | 1791307/2196017 [00:38<00:07, 51638.73it/s] 82%|████████▏ | 1796561/2196017 [00:38<00:07, 51903.81it/s] 82%|████████▏ | 1801753/2196017 [00:38<00:07, 51736.20it/s] 82%|████████▏ | 1806928/2196017 [00:38<00:07, 51618.95it/s] 83%|████████▎ | 1812204/2196017 [00:38<00:07, 51939.16it/s] 83%|████████▎ | 1817399/2196017 [00:39<00:07, 51936.15it/s] 83%|████████▎ | 1822683/2196017 [00:39<00:07, 52202.28it/s] 83%|████████▎ | 1827904/2196017 [00:39<00:07, 51792.83it/s] 83%|████████▎ | 1833085/2196017 [00:39<00:07, 51746.74it/s] 84%|████████▎ | 1838444/2196017 [00:39<00:06, 52285.62it/s] 84%|████████▍ | 1843675/2196017 [00:39<00:06, 52022.41it/s] 84%|████████▍ | 1848978/2196017 [00:39<00:06, 52318.85it/s] 84%|████████▍ | 1854212/2196017 [00:39<00:06, 52180.92it/s] 85%|████████▍ | 1859432/2196017 [00:39<00:06, 51987.29it/s] 85%|████████▍ | 1864632/2196017 [00:39<00:06, 51889.85it/s] 85%|████████▌ | 1869888/2196017 [00:40<00:06, 52088.70it/s] 85%|████████▌ | 1875123/2196017 [00:40<00:06, 52165.20it/s] 86%|████████▌ | 1880341/2196017 [00:40<00:06, 51883.77it/s] 86%|████████▌ | 1885531/2196017 [00:40<00:05, 51755.16it/s] 86%|████████▌ | 1890783/2196017 [00:40<00:05, 51980.70it/s] 86%|████████▋ | 1895982/2196017 [00:40<00:05, 51947.69it/s] 87%|████████▋ | 1901255/2196017 [00:40<00:05, 52177.92it/s] 87%|████████▋ | 1906474/2196017 [00:40<00:05, 52084.82it/s] 87%|████████▋ | 1911690/2196017 [00:40<00:05, 52104.32it/s] 87%|████████▋ | 1917022/2196017 [00:40<00:05, 52461.88it/s] 88%|████████▊ | 1922269/2196017 [00:41<00:05, 52265.29it/s] 88%|████████▊ | 1927572/2196017 [00:41<00:05, 52491.76it/s] 88%|████████▊ | 1932822/2196017 [00:41<00:05, 52284.62it/s] 88%|████████▊ | 1938052/2196017 [00:41<00:04, 51979.91it/s] 88%|████████▊ | 1943284/2196017 [00:41<00:04, 52080.19it/s] 89%|████████▊ | 1948493/2196017 [00:41<00:04, 51888.88it/s] 89%|████████▉ | 1953766/2196017 [00:41<00:04, 52137.77it/s] 89%|████████▉ | 1958993/2196017 [00:41<00:04, 52175.08it/s] 89%|████████▉ | 1964259/2196017 [00:41<00:04, 52318.18it/s] 90%|████████▉ | 1969505/2196017 [00:41<00:04, 52358.83it/s] 90%|████████▉ | 1974742/2196017 [00:42<00:04, 51906.68it/s] 90%|█████████ | 1979963/2196017 [00:42<00:04, 51996.99it/s] 90%|█████████ | 1985164/2196017 [00:42<00:04, 51926.34it/s] 91%|█████████ | 1990475/2196017 [00:42<00:03, 52273.37it/s] 91%|█████████ | 1995776/2196017 [00:42<00:03, 52490.17it/s] 91%|█████████ | 2001026/2196017 [00:42<00:03, 52188.61it/s] 91%|█████████▏| 2006350/2196017 [00:42<00:03, 52498.62it/s] 92%|█████████▏| 2011692/2196017 [00:42<00:03, 52771.43it/s] 92%|█████████▏| 2016999/2196017 [00:42<00:03, 52858.29it/s] 92%|█████████▏| 2022286/2196017 [00:42<00:03, 52842.13it/s] 92%|█████████▏| 2027571/2196017 [00:43<00:03, 52512.25it/s] 93%|█████████▎| 2032913/2196017 [00:43<00:03, 52779.02it/s] 93%|█████████▎| 2038192/2196017 [00:43<00:03, 52537.81it/s] 93%|█████████▎| 2043447/2196017 [00:43<00:02, 52401.18it/s] 93%|█████████▎| 2048839/2196017 [00:43<00:02, 52845.56it/s] 94%|█████████▎| 2054125/2196017 [00:43<00:02, 52537.28it/s] 94%|█████████▍| 2059468/2196017 [00:43<00:02, 52800.95it/s] 94%|█████████▍| 2064788/2196017 [00:43<00:02, 52916.74it/s] 94%|█████████▍| 2070081/2196017 [00:43<00:02, 52295.95it/s] 95%|█████████▍| 2075407/2196017 [00:43<00:02, 52580.35it/s] 95%|█████████▍| 2080668/2196017 [00:44<00:02, 52567.23it/s] 95%|█████████▍| 2086068/2196017 [00:44<00:02, 52987.13it/s] 95%|█████████▌| 2091391/2196017 [00:44<00:01, 53057.92it/s] 95%|█████████▌| 2096752/2196017 [00:44<00:01, 53220.40it/s] 96%|█████████▌| 2102084/2196017 [00:44<00:01, 53247.52it/s] 96%|█████████▌| 2107410/2196017 [00:44<00:01, 53220.71it/s] 96%|█████████▌| 2112735/2196017 [00:44<00:01, 53228.03it/s] 96%|█████████▋| 2118059/2196017 [00:44<00:01, 52966.94it/s] 97%|█████████▋| 2123357/2196017 [00:44<00:01, 52617.50it/s] 97%|█████████▋| 2128620/2196017 [00:44<00:01, 52447.61it/s] 97%|█████████▋| 2133909/2196017 [00:45<00:01, 52578.40it/s] 97%|█████████▋| 2139220/2196017 [00:45<00:01, 52734.38it/s] 98%|█████████▊| 2144618/2196017 [00:45<00:00, 53101.18it/s] 98%|█████████▊| 2149930/2196017 [00:45<00:00, 52189.74it/s] 98%|█████████▊| 2155154/2196017 [00:45<00:00, 52116.46it/s] 98%|█████████▊| 2160498/2196017 [00:45<00:00, 52504.46it/s] 99%|█████████▊| 2165850/2196017 [00:45<00:00, 52803.06it/s] 99%|█████████▉| 2171161/2196017 [00:45<00:00, 52892.86it/s] 99%|█████████▉| 2176452/2196017 [00:45<00:00, 52852.13it/s] 99%|█████████▉| 2181844/2196017 [00:45<00:00, 53166.80it/s]100%|█████████▉| 2187162/2196017 [00:46<00:00, 53016.73it/s]100%|█████████▉| 2192469/2196017 [00:46<00:00, 53032.19it/s]100%|██████████| 2196017/2196017 [00:46<00:00, 47479.15it/s]
[2022-05-31 09:51:00,452] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 09:51:15,742] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7fe569469a30>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7fe569469a30>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 09:51:15,750] INFO: Vocab size: 64518
[2022-05-31 09:51:15,750] INFO: Nb labels: 2
[2022-05-31 09:51:15,750] INFO: Total params: 21123803
[2022-05-31 09:51:15,751] INFO: Learnable params: 1768403
[2022-05-31 09:51:15,753] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  0%|          | 1/8214 [00:00<13:47,  9.93ex/s]  4%|▍         | 333/8214 [00:00<09:16, 14.16ex/s]  8%|▊         | 655/8214 [00:00<06:14, 20.20ex/s] 12%|█▏        | 961/8214 [00:00<04:12, 28.77ex/s] 14%|█▍        | 1170/8214 [00:00<02:56, 39.93ex/s] 18%|█▊        | 1484/8214 [00:00<01:58, 56.73ex/s] 22%|██▏       | 1802/8214 [00:01<01:19, 80.43ex/s] 25%|██▍       | 2041/8214 [00:01<00:54, 113.15ex/s] 29%|██▉       | 2368/8214 [00:01<00:36, 159.28ex/s] 33%|███▎      | 2696/8214 [00:01<00:24, 222.90ex/s] 37%|███▋      | 3000/8214 [00:01<00:17, 306.46ex/s] 41%|████      | 3331/8214 [00:01<00:11, 421.07ex/s] 45%|████▍     | 3674/8214 [00:01<00:07, 571.34ex/s] 49%|████▊     | 3988/8214 [00:01<00:05, 756.95ex/s] 52%|█████▏    | 4295/8214 [00:01<00:04, 960.20ex/s] 56%|█████▋    | 4631/8214 [00:02<00:02, 1221.72ex/s] 61%|██████    | 4971/8214 [00:02<00:02, 1511.94ex/s] 64%|██████▍   | 5287/8214 [00:02<00:01, 1725.59ex/s] 68%|██████▊   | 5613/8214 [00:02<00:01, 2009.09ex/s] 72%|███████▏  | 5940/8214 [00:02<00:01, 2271.47ex/s] 76%|███████▌  | 6253/8214 [00:02<00:00, 2317.16ex/s] 80%|████████  | 6600/8214 [00:02<00:00, 2572.79ex/s] 84%|████████▍ | 6911/8214 [00:02<00:00, 2712.57ex/s] 88%|████████▊ | 7220/8214 [00:02<00:00, 2628.73ex/s] 92%|█████████▏| 7557/8214 [00:03<00:00, 2814.42ex/s] 96%|█████████▌| 7886/8214 [00:03<00:00, 2941.90ex/s]100%|█████████▉| 8198/8214 [00:03<00:00, 2728.27ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2514.48ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 26%|██▌       | 354/1369 [00:00<00:00, 3537.14ex/s] 49%|████▉     | 672/1369 [00:00<00:00, 3419.06ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2981.99ex/s] 97%|█████████▋| 1331/1369 [00:00<00:00, 3072.12ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3001.48ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 14%|█▍        | 191/1369 [00:00<00:00, 1904.61ex/s] 31%|███       | 426/1369 [00:00<00:00, 1753.92ex/s] 48%|████▊     | 652/1369 [00:00<00:00, 1878.62ex/s] 70%|███████   | 964/1369 [00:00<00:00, 2131.98ex/s] 84%|████████▎ | 1146/1369 [00:00<00:00, 1999.53ex/s]100%|██████████| 1369/1369 [00:00<00:00, 2153.47ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 113, in forward
    x.numpy() / test_temperature.numpy(),  # x / test_temperature --> ValueError: only one element tensors can be converted to Python scalars
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

                                                                   