	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 10:28:38,077] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 10:28:43,568] INFO: Building board loggers...
[2022-05-31 10:28:43,568] INFO: Building callbacks...
[2022-05-31 10:28:43,570] INFO: Building model: spectra...
[2022-05-31 10:28:44,094] INFO: Created a temporary directory at /tmp/tmp4agn6ku2
[2022-05-31 10:28:44,094] INFO: Writing /tmp/tmp4agn6ku2/_remote_module_non_sriptable.py
[2022-05-31 10:28:44,947] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 10:28:55,630] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<156:16:50,  3.90it/s]  0%|          | 963/2196017 [00:00<109:22:03,  5.58it/s]  0%|          | 2193/2196017 [00:00<76:31:45,  7.96it/s]  0%|          | 3475/2196017 [00:00<53:33:12, 11.37it/s]  0%|          | 4742/2196017 [00:00<37:28:48, 16.24it/s]  0%|          | 6105/2196017 [00:00<26:13:59, 23.19it/s]  0%|          | 7430/2196017 [00:00<18:21:57, 33.10it/s]  0%|          | 8813/2196017 [00:00<12:51:40, 47.24it/s]  0%|          | 10246/2196017 [00:01<9:00:34, 67.39it/s]  1%|          | 11710/2196017 [00:01<6:18:53, 96.08it/s]  1%|          | 13209/2196017 [00:01<4:25:46, 136.88it/s]  1%|          | 14751/2196017 [00:01<3:06:37, 194.81it/s]  1%|          | 16334/2196017 [00:01<2:11:13, 276.83it/s]  1%|          | 17903/2196017 [00:01<1:32:29, 392.51it/s]  1%|          | 19487/2196017 [00:01<1:05:22, 554.83it/s]  1%|          | 21093/2196017 [00:01<46:24, 781.05it/s]    1%|          | 22803/2196017 [00:01<33:05, 1094.36it/s]  1%|          | 24432/2196017 [00:01<23:49, 1519.60it/s]  1%|          | 26129/2196017 [00:02<17:17, 2090.62it/s]  1%|▏         | 27870/2196017 [00:02<12:43, 2840.31it/s]  1%|▏         | 29629/2196017 [00:02<09:30, 3794.76it/s]  1%|▏         | 31443/2196017 [00:02<07:15, 4975.00it/s]  2%|▏         | 33367/2196017 [00:02<05:38, 6397.39it/s]  2%|▏         | 35284/2196017 [00:02<04:30, 7994.95it/s]  2%|▏         | 37142/2196017 [00:02<03:43, 9642.97it/s]  2%|▏         | 39106/2196017 [00:02<03:09, 11380.05it/s]  2%|▏         | 41077/2196017 [00:02<02:45, 13032.29it/s]  2%|▏         | 43071/2196017 [00:02<02:28, 14543.28it/s]  2%|▏         | 45191/2196017 [00:03<02:13, 16055.53it/s]  2%|▏         | 47391/2196017 [00:03<02:02, 17469.72it/s]  2%|▏         | 49489/2196017 [00:03<01:56, 18392.47it/s]  2%|▏         | 51599/2196017 [00:03<01:52, 19127.62it/s]  2%|▏         | 53806/2196017 [00:03<01:47, 19924.42it/s]  3%|▎         | 56046/2196017 [00:03<01:43, 20606.53it/s]  3%|▎         | 58361/2196017 [00:03<01:40, 21308.70it/s]  3%|▎         | 60688/2196017 [00:03<01:37, 21860.88it/s]  3%|▎         | 63140/2196017 [00:03<01:34, 22594.89it/s]  3%|▎         | 65622/2196017 [00:03<01:31, 23218.65it/s]  3%|▎         | 68117/2196017 [00:04<01:29, 23712.26it/s]  3%|▎         | 70706/2196017 [00:04<01:27, 24319.84it/s]  3%|▎         | 73289/2196017 [00:04<01:25, 24746.71it/s]  3%|▎         | 75959/2196017 [00:04<01:23, 25296.24it/s]  4%|▎         | 78750/2196017 [00:04<01:21, 26022.82it/s]  4%|▎         | 81498/2196017 [00:04<01:19, 26443.44it/s]  4%|▍         | 84276/2196017 [00:04<01:18, 26825.24it/s]  4%|▍         | 87161/2196017 [00:04<01:16, 27400.80it/s]  4%|▍         | 90055/2196017 [00:04<01:15, 27841.28it/s]  4%|▍         | 93087/2196017 [00:04<01:13, 28537.73it/s]  4%|▍         | 96054/2196017 [00:05<01:12, 28863.68it/s]  5%|▍         | 99057/2196017 [00:05<01:11, 29197.13it/s]  5%|▍         | 102174/2196017 [00:05<01:10, 29762.13it/s]  5%|▍         | 105467/2196017 [00:05<01:08, 30646.01it/s]  5%|▍         | 108663/2196017 [00:05<01:07, 31027.15it/s]  5%|▌         | 111942/2196017 [00:05<01:06, 31535.75it/s]  5%|▌         | 115331/2196017 [00:05<01:04, 32205.29it/s]  5%|▌         | 118765/2196017 [00:05<01:03, 32810.97it/s]  6%|▌         | 122191/2196017 [00:05<01:02, 33232.61it/s]  6%|▌         | 125623/2196017 [00:05<01:01, 33550.92it/s]  6%|▌         | 129161/2196017 [00:06<01:00, 34077.63it/s]  6%|▌         | 132762/2196017 [00:06<00:59, 34632.07it/s]  6%|▌         | 136360/2196017 [00:06<00:58, 35025.34it/s]  6%|▋         | 140050/2196017 [00:06<00:57, 35566.09it/s]  7%|▋         | 143725/2196017 [00:06<00:57, 35912.84it/s]  7%|▋         | 147433/2196017 [00:06<00:56, 36254.78it/s]  7%|▋         | 151239/2196017 [00:06<00:55, 36770.79it/s]  7%|▋         | 155137/2196017 [00:06<00:54, 37405.87it/s]  7%|▋         | 159216/2196017 [00:06<00:53, 38360.52it/s]  7%|▋         | 163209/2196017 [00:06<00:52, 38817.46it/s]  8%|▊         | 167245/2196017 [00:07<00:51, 39266.23it/s]  8%|▊         | 171368/2196017 [00:07<00:50, 39830.00it/s]  8%|▊         | 175386/2196017 [00:07<00:50, 39934.34it/s]  8%|▊         | 179471/2196017 [00:07<00:50, 40201.96it/s]  8%|▊         | 183529/2196017 [00:07<00:49, 40312.81it/s]  9%|▊         | 187697/2196017 [00:07<00:49, 40713.35it/s]  9%|▊         | 191847/2196017 [00:07<00:48, 40944.45it/s]  9%|▉         | 196009/2196017 [00:07<00:48, 41132.65it/s]  9%|▉         | 200310/2196017 [00:07<00:47, 41676.93it/s]  9%|▉         | 204640/2196017 [00:07<00:47, 42150.35it/s] 10%|▉         | 209049/2196017 [00:08<00:46, 42712.47it/s] 10%|▉         | 213398/2196017 [00:08<00:46, 42942.32it/s] 10%|▉         | 217898/2196017 [00:08<00:45, 43538.91it/s] 10%|█         | 222363/2196017 [00:08<00:44, 43864.55it/s] 10%|█         | 226813/2196017 [00:08<00:44, 44051.63it/s] 11%|█         | 231455/2196017 [00:08<00:43, 44735.89it/s] 11%|█         | 235934/2196017 [00:08<00:43, 44649.03it/s] 11%|█         | 240403/2196017 [00:08<00:43, 44587.92it/s] 11%|█         | 244943/2196017 [00:08<00:43, 44828.18it/s] 11%|█▏        | 249484/2196017 [00:08<00:43, 44999.15it/s] 12%|█▏        | 253986/2196017 [00:09<00:43, 44918.16it/s] 12%|█▏        | 258620/2196017 [00:09<00:42, 45334.49it/s] 12%|█▏        | 263223/2196017 [00:09<00:42, 45537.85it/s] 12%|█▏        | 267850/2196017 [00:09<00:42, 45753.12it/s] 12%|█▏        | 272443/2196017 [00:09<00:41, 45805.14it/s] 13%|█▎        | 277077/2196017 [00:09<00:41, 45961.93it/s] 13%|█▎        | 281674/2196017 [00:09<00:41, 45922.72it/s] 13%|█▎        | 286364/2196017 [00:09<00:41, 46202.56it/s] 13%|█▎        | 291037/2196017 [00:09<00:41, 46356.76it/s] 13%|█▎        | 295674/2196017 [00:09<00:41, 46164.05it/s] 14%|█▎        | 300382/2196017 [00:10<00:40, 46433.19it/s] 14%|█▍        | 305066/2196017 [00:10<00:40, 46554.07it/s] 14%|█▍        | 309851/2196017 [00:10<00:40, 46933.92it/s] 14%|█▍        | 314546/2196017 [00:10<00:40, 46876.10it/s] 15%|█▍        | 319235/2196017 [00:10<00:40, 46809.69it/s] 15%|█▍        | 323986/2196017 [00:10<00:39, 47015.19it/s] 15%|█▍        | 328702/2196017 [00:10<00:39, 47056.77it/s] 15%|█▌        | 333423/2196017 [00:10<00:39, 47100.30it/s] 15%|█▌        | 338216/2196017 [00:10<00:39, 47344.15it/s] 16%|█▌        | 343077/2196017 [00:10<00:38, 47714.83it/s] 16%|█▌        | 347850/2196017 [00:11<00:38, 47675.79it/s] 16%|█▌        | 352725/2196017 [00:11<00:38, 47990.90it/s] 16%|█▋        | 357570/2196017 [00:11<00:38, 48125.91it/s] 17%|█▋        | 362504/2196017 [00:11<00:37, 48483.70it/s] 17%|█▋        | 367473/2196017 [00:11<00:37, 48838.48it/s] 17%|█▋        | 372519/2196017 [00:11<00:36, 49313.66it/s] 17%|█▋        | 377467/2196017 [00:11<00:36, 49363.39it/s] 17%|█▋        | 382405/2196017 [00:11<00:36, 49180.23it/s] 18%|█▊        | 387358/2196017 [00:11<00:36, 49282.27it/s] 18%|█▊        | 392288/2196017 [00:11<00:36, 49130.35it/s] 18%|█▊        | 397202/2196017 [00:12<00:36, 49053.87it/s] 18%|█▊        | 402108/2196017 [00:12<00:36, 48816.15it/s] 19%|█▊        | 406991/2196017 [00:12<00:36, 48611.71it/s] 19%|█▉        | 411853/2196017 [00:12<00:36, 48434.19it/s] 19%|█▉        | 416782/2196017 [00:12<00:36, 48686.50it/s] 19%|█▉        | 421706/2196017 [00:12<00:36, 48849.49it/s] 19%|█▉        | 426824/2196017 [00:12<00:35, 49524.86it/s] 20%|█▉        | 431836/2196017 [00:12<00:35, 49700.16it/s] 20%|█▉        | 436935/2196017 [00:12<00:35, 50078.75it/s] 20%|██        | 442013/2196017 [00:12<00:34, 50285.03it/s] 20%|██        | 447109/2196017 [00:13<00:34, 50485.19it/s] 21%|██        | 452221/2196017 [00:13<00:34, 50672.90it/s] 21%|██        | 457316/2196017 [00:13<00:34, 50753.92it/s] 21%|██        | 462393/2196017 [00:13<00:34, 50519.49it/s] 21%|██▏       | 467446/2196017 [00:13<00:34, 50346.13it/s] 22%|██▏       | 472539/2196017 [00:13<00:34, 50519.28it/s] 22%|██▏       | 477602/2196017 [00:13<00:33, 50551.60it/s] 22%|██▏       | 482658/2196017 [00:13<00:34, 50377.20it/s] 22%|██▏       | 487736/2196017 [00:13<00:33, 50497.16it/s] 22%|██▏       | 492795/2196017 [00:13<00:33, 50523.91it/s] 23%|██▎       | 497927/2196017 [00:14<00:33, 50759.36it/s] 23%|██▎       | 503004/2196017 [00:14<00:33, 50758.32it/s] 23%|██▎       | 508165/2196017 [00:14<00:33, 51005.21it/s] 23%|██▎       | 513267/2196017 [00:14<00:33, 50423.74it/s] 24%|██▎       | 518355/2196017 [00:14<00:33, 50557.37it/s] 24%|██▍       | 523430/2196017 [00:14<00:33, 50613.21it/s] 24%|██▍       | 528493/2196017 [00:14<00:32, 50595.36it/s] 24%|██▍       | 533617/2196017 [00:14<00:32, 50785.98it/s] 25%|██▍       | 538734/2196017 [00:14<00:32, 50898.06it/s] 25%|██▍       | 543825/2196017 [00:14<00:32, 50664.19it/s] 25%|██▍       | 548922/2196017 [00:15<00:32, 50753.39it/s] 25%|██▌       | 554005/2196017 [00:15<00:32, 50774.22it/s] 25%|██▌       | 559142/2196017 [00:15<00:32, 50951.33it/s] 26%|██▌       | 564245/2196017 [00:15<00:32, 50972.70it/s] 26%|██▌       | 569343/2196017 [00:15<00:32, 50471.54it/s] 26%|██▌       | 574425/2196017 [00:15<00:32, 50573.36it/s] 26%|██▋       | 579505/2196017 [00:15<00:31, 50638.73it/s] 27%|██▋       | 584679/2196017 [00:15<00:31, 50962.74it/s] 27%|██▋       | 589813/2196017 [00:15<00:31, 51071.53it/s] 27%|██▋       | 594921/2196017 [00:15<00:31, 51062.33it/s] 27%|██▋       | 600068/2196017 [00:16<00:31, 51183.05it/s] 28%|██▊       | 605187/2196017 [00:16<00:31, 50671.38it/s] 28%|██▊       | 610256/2196017 [00:16<00:31, 50262.08it/s] 28%|██▊       | 615301/2196017 [00:16<00:31, 50317.60it/s] 28%|██▊       | 620335/2196017 [00:16<00:31, 50127.74it/s] 28%|██▊       | 625517/2196017 [00:16<00:31, 50623.39it/s] 29%|██▊       | 630745/2196017 [00:16<00:30, 51109.08it/s] 29%|██▉       | 635875/2196017 [00:16<00:30, 51165.24it/s] 29%|██▉       | 641080/2196017 [00:16<00:30, 51427.47it/s] 29%|██▉       | 646242/2196017 [00:16<00:30, 51483.40it/s] 30%|██▉       | 651434/2196017 [00:17<00:29, 51608.63it/s] 30%|██▉       | 656646/2196017 [00:17<00:29, 51759.35it/s] 30%|███       | 661864/2196017 [00:17<00:29, 51884.40it/s] 30%|███       | 667053/2196017 [00:17<00:29, 51856.76it/s] 31%|███       | 672289/2196017 [00:17<00:29, 52005.18it/s] 31%|███       | 677492/2196017 [00:17<00:29, 52010.22it/s] 31%|███       | 682746/2196017 [00:17<00:29, 52166.34it/s] 31%|███▏      | 688032/2196017 [00:17<00:28, 52370.90it/s] 32%|███▏      | 693270/2196017 [00:17<00:28, 52249.44it/s] 32%|███▏      | 698496/2196017 [00:17<00:28, 52085.89it/s] 32%|███▏      | 703705/2196017 [00:18<00:28, 51937.88it/s] 32%|███▏      | 708935/2196017 [00:18<00:28, 52044.52it/s] 33%|███▎      | 714140/2196017 [00:18<00:28, 51780.35it/s] 33%|███▎      | 719401/2196017 [00:18<00:28, 52025.66it/s] 33%|███▎      | 724676/2196017 [00:18<00:28, 52238.43it/s] 33%|███▎      | 729905/2196017 [00:18<00:28, 52253.16it/s] 33%|███▎      | 735180/2196017 [00:18<00:27, 52400.46it/s] 34%|███▎      | 740468/2196017 [00:18<00:27, 52542.90it/s] 34%|███▍      | 745776/2196017 [00:18<00:27, 52700.09it/s] 34%|███▍      | 751047/2196017 [00:18<00:27, 52593.93it/s] 34%|███▍      | 756307/2196017 [00:19<00:27, 51951.37it/s] 35%|███▍      | 761505/2196017 [00:19<00:27, 51871.08it/s] 35%|███▍      | 766786/2196017 [00:19<00:27, 52147.22it/s] 35%|███▌      | 772003/2196017 [00:19<00:27, 52048.71it/s] 35%|███▌      | 777209/2196017 [00:19<00:27, 51995.25it/s] 36%|███▌      | 782410/2196017 [00:19<00:27, 51820.26it/s] 36%|███▌      | 787637/2196017 [00:19<00:27, 51930.97it/s] 36%|███▌      | 792831/2196017 [00:19<00:27, 51905.04it/s] 36%|███▋      | 798087/2196017 [00:19<00:26, 52097.20it/s] 37%|███▋      | 803298/2196017 [00:20<00:26, 52065.42it/s] 37%|███▋      | 808620/2196017 [00:20<00:26, 52406.33it/s] 37%|███▋      | 813862/2196017 [00:20<00:26, 52391.60it/s] 37%|███▋      | 819102/2196017 [00:20<00:26, 52318.40it/s] 38%|███▊      | 824342/2196017 [00:20<00:26, 52340.48it/s] 38%|███▊      | 829647/2196017 [00:20<00:26, 52549.30it/s] 38%|███▊      | 834914/2196017 [00:20<00:25, 52583.06it/s] 38%|███▊      | 840243/2196017 [00:20<00:25, 52792.58it/s] 39%|███▊      | 845523/2196017 [00:20<00:25, 52658.19it/s] 39%|███▊      | 850798/2196017 [00:20<00:25, 52684.29it/s] 39%|███▉      | 856067/2196017 [00:21<00:25, 52442.93it/s] 39%|███▉      | 861312/2196017 [00:21<00:25, 52220.57it/s] 39%|███▉      | 866535/2196017 [00:21<00:25, 52160.33it/s] 40%|███▉      | 871752/2196017 [00:21<00:25, 52022.76it/s] 40%|███▉      | 876955/2196017 [00:21<00:25, 51885.31it/s] 40%|████      | 882196/2196017 [00:21<00:25, 52041.15it/s] 40%|████      | 887511/2196017 [00:21<00:24, 52368.08it/s] 41%|████      | 892778/2196017 [00:21<00:24, 52456.40it/s] 41%|████      | 898109/2196017 [00:21<00:24, 52707.71it/s] 41%|████      | 903409/2196017 [00:21<00:24, 52794.43it/s] 41%|████▏     | 908689/2196017 [00:22<00:24, 52722.44it/s] 42%|████▏     | 913962/2196017 [00:22<00:24, 52668.63it/s] 42%|████▏     | 919230/2196017 [00:22<00:24, 52536.58it/s] 42%|████▏     | 924484/2196017 [00:22<00:24, 52438.64it/s] 42%|████▏     | 929729/2196017 [00:22<00:24, 52183.26it/s] 43%|████▎     | 934969/2196017 [00:22<00:24, 52247.18it/s] 43%|████▎     | 940258/2196017 [00:22<00:23, 52437.61it/s] 43%|████▎     | 945503/2196017 [00:22<00:23, 52422.33it/s] 43%|████▎     | 950772/2196017 [00:22<00:23, 52499.82it/s] 44%|████▎     | 956160/2196017 [00:22<00:23, 52905.14it/s] 44%|████▍     | 961515/2196017 [00:23<00:23, 53094.98it/s] 44%|████▍     | 966826/2196017 [00:23<00:23, 53068.19it/s] 44%|████▍     | 972234/2196017 [00:23<00:22, 53367.30it/s] 45%|████▍     | 977599/2196017 [00:23<00:22, 53450.56it/s] 45%|████▍     | 982945/2196017 [00:23<00:22, 53272.89it/s] 45%|████▌     | 988308/2196017 [00:23<00:22, 53378.85it/s] 45%|████▌     | 993649/2196017 [00:23<00:22, 53386.99it/s] 45%|████▌     | 998989/2196017 [00:23<00:22, 52975.31it/s] 46%|████▌     | 1004288/2196017 [00:23<00:22, 52694.03it/s] 46%|████▌     | 1009559/2196017 [00:23<00:22, 52601.15it/s] 46%|████▌     | 1014820/2196017 [00:24<00:22, 52439.10it/s] 46%|████▋     | 1020085/2196017 [00:24<00:22, 52499.63it/s] 47%|████▋     | 1025336/2196017 [00:24<00:22, 52279.47it/s] 47%|████▋     | 1030679/2196017 [00:24<00:22, 52616.70it/s] 47%|████▋     | 1035994/2196017 [00:24<00:21, 52773.03it/s] 47%|████▋     | 1041333/2196017 [00:24<00:21, 52955.70it/s] 48%|████▊     | 1046694/2196017 [00:24<00:21, 53147.76it/s] 48%|████▊     | 1052059/2196017 [00:24<00:21, 53296.85it/s] 48%|████▊     | 1057422/2196017 [00:24<00:21, 53395.73it/s] 48%|████▊     | 1062762/2196017 [00:24<00:21, 53179.54it/s] 49%|████▊     | 1068161/2196017 [00:25<00:21, 53419.86it/s] 49%|████▉     | 1073504/2196017 [00:25<00:21, 53092.85it/s] 49%|████▉     | 1078815/2196017 [00:25<00:21, 52913.43it/s] 49%|████▉     | 1084138/2196017 [00:25<00:20, 53005.38it/s] 50%|████▉     | 1089490/2196017 [00:25<00:20, 53156.74it/s] 50%|████▉     | 1094807/2196017 [00:25<00:20, 53014.77it/s] 50%|█████     | 1100109/2196017 [00:25<00:20, 52789.29it/s] 50%|█████     | 1105389/2196017 [00:25<00:20, 52485.78it/s] 51%|█████     | 1110639/2196017 [00:25<00:20, 52388.16it/s] 51%|█████     | 1115904/2196017 [00:25<00:20, 52465.70it/s] 51%|█████     | 1121205/2196017 [00:26<00:20, 52626.41it/s] 51%|█████▏    | 1126469/2196017 [00:26<00:20, 52316.90it/s] 52%|█████▏    | 1131814/2196017 [00:26<00:20, 52650.81it/s] 52%|█████▏    | 1137081/2196017 [00:26<00:20, 52650.52it/s] 52%|█████▏    | 1142371/2196017 [00:26<00:19, 52723.36it/s] 52%|█████▏    | 1147776/2196017 [00:26<00:19, 53112.09it/s] 53%|█████▎    | 1153120/2196017 [00:26<00:19, 53207.93it/s] 53%|█████▎    | 1158442/2196017 [00:26<00:19, 53152.35it/s] 53%|█████▎    | 1163804/2196017 [00:26<00:19, 53290.06it/s] 53%|█████▎    | 1169134/2196017 [00:26<00:19, 53169.66it/s] 53%|█████▎    | 1174452/2196017 [00:27<00:19, 53046.41it/s] 54%|█████▎    | 1179757/2196017 [00:27<00:19, 52955.39it/s] 54%|█████▍    | 1185160/2196017 [00:27<00:18, 53270.98it/s] 54%|█████▍    | 1190488/2196017 [00:27<00:18, 53150.47it/s] 54%|█████▍    | 1195804/2196017 [00:27<00:18, 53111.64it/s] 55%|█████▍    | 1201116/2196017 [00:27<00:18, 52906.73it/s] 55%|█████▍    | 1206425/2196017 [00:27<00:18, 52959.48it/s] 55%|█████▌    | 1211722/2196017 [00:27<00:18, 52790.91it/s] 55%|█████▌    | 1217002/2196017 [00:27<00:18, 52646.21it/s] 56%|█████▌    | 1222293/2196017 [00:27<00:18, 52724.71it/s] 56%|█████▌    | 1227566/2196017 [00:28<00:18, 52672.10it/s] 56%|█████▌    | 1232834/2196017 [00:28<00:18, 52603.16it/s] 56%|█████▋    | 1238095/2196017 [00:28<00:18, 52283.13it/s] 57%|█████▋    | 1243433/2196017 [00:28<00:18, 52607.37it/s] 57%|█████▋    | 1248695/2196017 [00:28<00:18, 51984.24it/s] 57%|█████▋    | 1254011/2196017 [00:28<00:18, 52329.31it/s] 57%|█████▋    | 1259247/2196017 [00:28<00:17, 52271.33it/s] 58%|█████▊    | 1264504/2196017 [00:28<00:17, 52358.58it/s] 58%|█████▊    | 1269790/2196017 [00:28<00:17, 52507.57it/s] 58%|█████▊    | 1275042/2196017 [00:28<00:17, 52399.38it/s] 58%|█████▊    | 1280283/2196017 [00:29<00:17, 52335.06it/s] 59%|█████▊    | 1285517/2196017 [00:29<00:17, 52248.56it/s] 59%|█████▉    | 1290803/2196017 [00:29<00:17, 52427.98it/s] 59%|█████▉    | 1296047/2196017 [00:29<00:17, 52407.73it/s] 59%|█████▉    | 1301289/2196017 [00:29<00:17, 52201.25it/s] 59%|█████▉    | 1306510/2196017 [00:29<00:17, 52103.62it/s] 60%|█████▉    | 1311721/2196017 [00:29<00:17, 51145.28it/s] 60%|█████▉    | 1316840/2196017 [00:29<00:17, 50939.17it/s] 60%|██████    | 1321938/2196017 [00:29<00:17, 50749.86it/s] 60%|██████    | 1327128/2196017 [00:29<00:17, 51087.70it/s] 61%|██████    | 1332450/2196017 [00:30<00:16, 51709.21it/s] 61%|██████    | 1337776/2196017 [00:30<00:16, 52164.49it/s] 61%|██████    | 1343071/2196017 [00:30<00:16, 52395.81it/s] 61%|██████▏   | 1348314/2196017 [00:30<00:16, 52334.91it/s] 62%|██████▏   | 1353694/2196017 [00:30<00:15, 52764.90it/s] 62%|██████▏   | 1359019/2196017 [00:30<00:15, 52908.57it/s] 62%|██████▏   | 1364366/2196017 [00:30<00:15, 53073.59it/s] 62%|██████▏   | 1369752/2196017 [00:30<00:15, 53306.05it/s] 63%|██████▎   | 1375127/2196017 [00:30<00:15, 53438.21it/s] 63%|██████▎   | 1380472/2196017 [00:30<00:15, 53286.25it/s] 63%|██████▎   | 1385811/2196017 [00:31<00:15, 53314.18it/s] 63%|██████▎   | 1391189/2196017 [00:31<00:15, 53452.14it/s] 64%|██████▎   | 1396535/2196017 [00:31<00:15, 53264.58it/s] 64%|██████▍   | 1401864/2196017 [00:31<00:14, 53269.74it/s] 64%|██████▍   | 1407192/2196017 [00:31<00:14, 53040.27it/s] 64%|██████▍   | 1412497/2196017 [00:31<00:14, 52835.72it/s] 65%|██████▍   | 1417782/2196017 [00:31<00:14, 52785.85it/s] 65%|██████▍   | 1423061/2196017 [00:31<00:14, 52726.70it/s] 65%|██████▌   | 1428370/2196017 [00:31<00:14, 52833.56it/s] 65%|██████▌   | 1433725/2196017 [00:31<00:14, 53044.05it/s] 66%|██████▌   | 1439066/2196017 [00:32<00:14, 53150.60it/s] 66%|██████▌   | 1444482/2196017 [00:32<00:14, 53447.20it/s] 66%|██████▌   | 1449867/2196017 [00:32<00:13, 53566.73it/s] 66%|██████▋   | 1455225/2196017 [00:32<00:13, 53565.82it/s] 67%|██████▋   | 1460648/2196017 [00:32<00:13, 53762.73it/s] 67%|██████▋   | 1466066/2196017 [00:32<00:13, 53886.37it/s] 67%|██████▋   | 1471455/2196017 [00:32<00:13, 53735.36it/s] 67%|██████▋   | 1476829/2196017 [00:32<00:13, 53554.63it/s] 67%|██████▋   | 1482185/2196017 [00:32<00:13, 53346.72it/s] 68%|██████▊   | 1487521/2196017 [00:32<00:13, 53188.53it/s] 68%|██████▊   | 1492841/2196017 [00:33<00:13, 52781.12it/s] 68%|██████▊   | 1498121/2196017 [00:33<00:13, 52762.27it/s] 68%|██████▊   | 1503442/2196017 [00:33<00:13, 52894.80it/s] 69%|██████▊   | 1508790/2196017 [00:33<00:12, 53068.83it/s] 69%|██████▉   | 1514185/2196017 [00:33<00:12, 53329.79it/s] 69%|██████▉   | 1519545/2196017 [00:33<00:12, 53410.46it/s] 69%|██████▉   | 1524892/2196017 [00:33<00:12, 53427.49it/s] 70%|██████▉   | 1530289/2196017 [00:33<00:12, 53587.58it/s] 70%|██████▉   | 1535650/2196017 [00:33<00:12, 53594.05it/s] 70%|███████   | 1541039/2196017 [00:33<00:12, 53681.52it/s] 70%|███████   | 1546408/2196017 [00:34<00:12, 53678.32it/s] 71%|███████   | 1551776/2196017 [00:34<00:12, 53487.29it/s] 71%|███████   | 1557146/2196017 [00:34<00:11, 53549.60it/s] 71%|███████   | 1562502/2196017 [00:34<00:11, 53434.46it/s] 71%|███████▏  | 1567846/2196017 [00:34<00:11, 53394.48it/s] 72%|███████▏  | 1573186/2196017 [00:34<00:11, 53357.22it/s] 72%|███████▏  | 1578575/2196017 [00:34<00:11, 53515.24it/s] 72%|███████▏  | 1584006/2196017 [00:34<00:11, 53750.17it/s] 72%|███████▏  | 1589394/2196017 [00:34<00:11, 53787.22it/s] 73%|███████▎  | 1594804/2196017 [00:34<00:11, 53880.11it/s] 73%|███████▎  | 1600193/2196017 [00:35<00:11, 53782.82it/s] 73%|███████▎  | 1605629/2196017 [00:35<00:10, 53952.82it/s] 73%|███████▎  | 1611025/2196017 [00:35<00:10, 53793.79it/s] 74%|███████▎  | 1616405/2196017 [00:35<00:10, 53783.21it/s] 74%|███████▍  | 1621809/2196017 [00:35<00:10, 53859.23it/s] 74%|███████▍  | 1627256/2196017 [00:35<00:10, 54038.97it/s] 74%|███████▍  | 1632687/2196017 [00:35<00:10, 54118.81it/s] 75%|███████▍  | 1638124/2196017 [00:35<00:10, 54193.55it/s] 75%|███████▍  | 1643544/2196017 [00:35<00:10, 53775.10it/s] 75%|███████▌  | 1648923/2196017 [00:35<00:10, 53463.63it/s] 75%|███████▌  | 1654271/2196017 [00:36<00:10, 53229.28it/s] 76%|███████▌  | 1659595/2196017 [00:36<00:10, 52845.63it/s] 76%|███████▌  | 1664922/2196017 [00:36<00:10, 52970.13it/s] 76%|███████▌  | 1670248/2196017 [00:36<00:09, 53056.32it/s] 76%|███████▋  | 1675604/2196017 [00:36<00:09, 53204.17it/s] 77%|███████▋  | 1680975/2196017 [00:36<00:09, 53353.76it/s] 77%|███████▋  | 1686431/2196017 [00:36<00:09, 53708.76it/s] 77%|███████▋  | 1691803/2196017 [00:36<00:09, 53637.46it/s] 77%|███████▋  | 1697279/2196017 [00:36<00:09, 53967.63it/s] 78%|███████▊  | 1702677/2196017 [00:36<00:09, 53881.92it/s] 78%|███████▊  | 1708127/2196017 [00:37<00:09, 54065.27it/s] 78%|███████▊  | 1713555/2196017 [00:37<00:08, 54127.52it/s] 78%|███████▊  | 1719013/2196017 [00:37<00:08, 54261.91it/s] 79%|███████▊  | 1724440/2196017 [00:37<00:08, 54172.80it/s] 79%|███████▉  | 1729861/2196017 [00:37<00:08, 54183.82it/s] 79%|███████▉  | 1735280/2196017 [00:37<00:08, 54072.49it/s] 79%|███████▉  | 1740688/2196017 [00:37<00:08, 53850.23it/s] 80%|███████▉  | 1746074/2196017 [00:37<00:08, 53175.49it/s] 80%|███████▉  | 1751394/2196017 [00:37<00:08, 53127.93it/s] 80%|███████▉  | 1756709/2196017 [00:37<00:08, 53068.38it/s] 80%|████████  | 1762068/2196017 [00:38<00:08, 53223.06it/s] 80%|████████  | 1767444/2196017 [00:38<00:08, 53380.75it/s] 81%|████████  | 1772851/2196017 [00:38<00:07, 53584.25it/s] 81%|████████  | 1778307/2196017 [00:38<00:07, 53871.44it/s] 81%|████████  | 1783728/2196017 [00:38<00:07, 53970.46it/s] 81%|████████▏ | 1789133/2196017 [00:38<00:07, 53992.93it/s] 82%|████████▏ | 1794533/2196017 [00:38<00:07, 53796.69it/s] 82%|████████▏ | 1799916/2196017 [00:38<00:07, 53804.04it/s] 82%|████████▏ | 1805297/2196017 [00:38<00:07, 53584.29it/s] 82%|████████▏ | 1810656/2196017 [00:39<00:07, 53524.20it/s] 83%|████████▎ | 1816009/2196017 [00:39<00:07, 53110.44it/s] 83%|████████▎ | 1821322/2196017 [00:39<00:07, 52906.69it/s] 83%|████████▎ | 1826614/2196017 [00:39<00:06, 52785.22it/s] 83%|████████▎ | 1831894/2196017 [00:39<00:06, 52748.52it/s] 84%|████████▎ | 1837237/2196017 [00:39<00:06, 52949.72it/s] 84%|████████▍ | 1842608/2196017 [00:39<00:06, 53173.36it/s] 84%|████████▍ | 1848009/2196017 [00:39<00:06, 53421.41it/s] 84%|████████▍ | 1853422/2196017 [00:39<00:06, 53629.31it/s] 85%|████████▍ | 1858786/2196017 [00:39<00:06, 53584.59it/s] 85%|████████▍ | 1864151/2196017 [00:40<00:06, 53601.53it/s] 85%|████████▌ | 1869571/2196017 [00:40<00:06, 53778.09it/s] 85%|████████▌ | 1874950/2196017 [00:40<00:05, 53778.33it/s] 86%|████████▌ | 1880335/2196017 [00:40<00:05, 53799.29it/s] 86%|████████▌ | 1885716/2196017 [00:40<00:05, 53705.35it/s] 86%|████████▌ | 1891119/2196017 [00:40<00:05, 53801.58it/s] 86%|████████▋ | 1896500/2196017 [00:40<00:05, 53662.24it/s] 87%|████████▋ | 1901867/2196017 [00:40<00:05, 53515.93it/s] 87%|████████▋ | 1907219/2196017 [00:40<00:05, 53346.77it/s] 87%|████████▋ | 1912595/2196017 [00:40<00:05, 53467.72it/s] 87%|████████▋ | 1917943/2196017 [00:41<00:05, 53359.69it/s] 88%|████████▊ | 1923345/2196017 [00:41<00:05, 53554.69it/s] 88%|████████▊ | 1928701/2196017 [00:41<00:05, 53425.39it/s] 88%|████████▊ | 1934107/2196017 [00:41<00:04, 53613.76it/s] 88%|████████▊ | 1939469/2196017 [00:41<00:04, 53494.48it/s] 89%|████████▊ | 1944847/2196017 [00:41<00:04, 53579.03it/s] 89%|████████▉ | 1950226/2196017 [00:41<00:04, 53640.37it/s] 89%|████████▉ | 1955622/2196017 [00:41<00:04, 53735.57it/s] 89%|████████▉ | 1961024/2196017 [00:41<00:04, 53820.37it/s] 90%|████████▉ | 1966407/2196017 [00:41<00:04, 53708.85it/s] 90%|████████▉ | 1971798/2196017 [00:42<00:04, 53767.75it/s] 90%|█████████ | 1977175/2196017 [00:42<00:04, 53546.73it/s] 90%|█████████ | 1982530/2196017 [00:42<00:03, 53478.80it/s] 91%|█████████ | 1987879/2196017 [00:42<00:03, 53473.84it/s] 91%|█████████ | 1993227/2196017 [00:42<00:03, 53052.22it/s] 91%|█████████ | 1998563/2196017 [00:42<00:03, 53143.55it/s] 91%|█████████▏| 2003879/2196017 [00:42<00:03, 53123.05it/s] 91%|█████████▏| 2009294/2196017 [00:42<00:03, 53425.26it/s] 92%|█████████▏| 2014638/2196017 [00:42<00:03, 53304.21it/s] 92%|█████████▏| 2020061/2196017 [00:42<00:03, 53578.59it/s] 92%|█████████▏| 2025420/2196017 [00:43<00:03, 53499.77it/s] 92%|█████████▏| 2030796/2196017 [00:43<00:03, 53577.51it/s] 93%|█████████▎| 2036191/2196017 [00:43<00:02, 53687.24it/s] 93%|█████████▎| 2041564/2196017 [00:43<00:02, 53697.43it/s] 93%|█████████▎| 2046985/2196017 [00:43<00:02, 53848.32it/s] 93%|█████████▎| 2052371/2196017 [00:43<00:02, 53751.36it/s] 94%|█████████▎| 2057751/2196017 [00:43<00:02, 53764.61it/s] 94%|█████████▍| 2063128/2196017 [00:43<00:02, 53142.12it/s] 94%|█████████▍| 2068444/2196017 [00:43<00:02, 52847.48it/s] 94%|█████████▍| 2073736/2196017 [00:43<00:02, 52867.00it/s] 95%|█████████▍| 2079024/2196017 [00:44<00:02, 52438.50it/s] 95%|█████████▍| 2084270/2196017 [00:44<00:02, 52179.05it/s] 95%|█████████▌| 2089505/2196017 [00:44<00:02, 52229.41it/s] 95%|█████████▌| 2094729/2196017 [00:44<00:01, 52184.80it/s] 96%|█████████▌| 2099954/2196017 [00:44<00:01, 52203.91it/s] 96%|█████████▌| 2105175/2196017 [00:44<00:01, 52124.63it/s] 96%|█████████▌| 2110412/2196017 [00:44<00:01, 52195.67it/s] 96%|█████████▋| 2115743/2196017 [00:44<00:01, 52523.73it/s] 97%|█████████▋| 2121094/2196017 [00:44<00:01, 52814.44it/s] 97%|█████████▋| 2126469/2196017 [00:44<00:01, 53091.46it/s] 97%|█████████▋| 2131830/2196017 [00:45<00:01, 53245.87it/s] 97%|█████████▋| 2137258/2196017 [00:45<00:01, 53549.24it/s] 98%|█████████▊| 2142614/2196017 [00:45<00:00, 53409.90it/s] 98%|█████████▊| 2147956/2196017 [00:45<00:00, 53378.93it/s] 98%|█████████▊| 2153295/2196017 [00:45<00:00, 53230.87it/s] 98%|█████████▊| 2158619/2196017 [00:45<00:00, 53066.64it/s] 99%|█████████▊| 2163927/2196017 [00:45<00:00, 52969.44it/s] 99%|█████████▉| 2169225/2196017 [00:45<00:00, 52856.65it/s] 99%|█████████▉| 2174511/2196017 [00:45<00:00, 52803.10it/s] 99%|█████████▉| 2179919/2196017 [00:45<00:00, 53179.28it/s]100%|█████████▉| 2185238/2196017 [00:46<00:00, 53084.87it/s]100%|█████████▉| 2190575/2196017 [00:46<00:00, 53169.91it/s]100%|█████████▉| 2195925/2196017 [00:46<00:00, 53268.03it/s]100%|██████████| 2196017/2196017 [00:46<00:00, 47492.68it/s]
[2022-05-31 10:29:42,107] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 10:29:49,416] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f5068845a00>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f5068845a00>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 10:29:49,424] INFO: Vocab size: 64518
[2022-05-31 10:29:49,424] INFO: Nb labels: 2
[2022-05-31 10:29:49,424] INFO: Total params: 21123803
[2022-05-31 10:29:49,424] INFO: Learnable params: 1768403
[2022-05-31 10:29:49,427] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  2%|▏         | 205/8214 [00:00<00:03, 2043.64ex/s]  7%|▋         | 541/8214 [00:00<00:03, 2313.69ex/s] 11%|█         | 870/8214 [00:00<00:02, 2537.12ex/s] 13%|█▎        | 1069/8214 [00:00<00:04, 1544.98ex/s] 17%|█▋        | 1389/8214 [00:00<00:03, 1827.61ex/s] 21%|██        | 1707/8214 [00:00<00:03, 2093.88ex/s] 24%|██▍       | 2000/8214 [00:00<00:02, 2188.28ex/s] 28%|██▊       | 2333/8214 [00:00<00:02, 2437.89ex/s] 32%|███▏      | 2644/8214 [00:01<00:02, 2606.78ex/s] 36%|███▌      | 2964/8214 [00:01<00:01, 2757.54ex/s] 40%|███▉      | 3258/8214 [00:01<00:01, 2635.67ex/s] 44%|████▎     | 3583/8214 [00:01<00:01, 2793.84ex/s] 47%|████▋     | 3890/8214 [00:01<00:01, 2870.47ex/s] 51%|█████     | 4186/8214 [00:01<00:01, 2705.67ex/s] 55%|█████▍    | 4514/8214 [00:01<00:01, 2855.36ex/s] 59%|█████▉    | 4830/8214 [00:01<00:01, 2939.24ex/s] 62%|██████▏   | 5131/8214 [00:01<00:01, 2763.98ex/s] 66%|██████▋   | 5454/8214 [00:02<00:00, 2888.08ex/s] 70%|███████   | 5771/8214 [00:02<00:00, 2963.77ex/s] 74%|███████▍  | 6073/8214 [00:02<00:00, 2744.61ex/s] 78%|███████▊  | 6387/8214 [00:02<00:00, 2849.79ex/s] 81%|████████▏ | 6693/8214 [00:02<00:00, 2907.46ex/s] 85%|████████▌ | 6988/8214 [00:02<00:00, 2895.58ex/s] 89%|████████▊ | 7281/8214 [00:02<00:00, 2693.89ex/s] 93%|█████████▎| 7609/8214 [00:02<00:00, 2845.40ex/s] 97%|█████████▋| 7936/8214 [00:02<00:00, 2958.85ex/s]100%|██████████| 8214/8214 [00:03<00:00, 2717.49ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 25%|██▍       | 342/1369 [00:00<00:00, 3416.22ex/s] 48%|████▊     | 658/1369 [00:00<00:00, 3334.14ex/s] 71%|███████▏  | 976/1369 [00:00<00:00, 3283.31ex/s] 87%|████████▋ | 1188/1369 [00:00<00:00, 2690.32ex/s]100%|██████████| 1369/1369 [00:00<00:00, 2917.60ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  6%|▌         | 83/1369 [00:00<00:02, 596.28ex/s]  8%|▊         | 114/1369 [00:00<00:02, 461.54ex/s] 10%|█         | 143/1369 [00:00<00:03, 362.11ex/s] 23%|██▎       | 320/1369 [00:00<00:02, 473.07ex/s] 33%|███▎      | 455/1369 [00:00<00:01, 552.73ex/s] 39%|███▊      | 529/1369 [00:00<00:01, 527.08ex/s] 61%|██████    | 830/1369 [00:00<00:00, 700.40ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 832.87ex/s] 94%|█████████▍| 1285/1369 [00:01<00:00, 1056.91ex/s]100%|██████████| 1369/1369 [00:01<00:00, 1228.27ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 82, in _make_variables
    scores.append(self._ravel(var._scores))
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 52, in _ravel
    return x.view(-1)
TypeError: Cannot interpret '-1' as a data type

                                                                   