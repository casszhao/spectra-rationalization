	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 11:23:53,590] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 11:23:56,994] INFO: Building board loggers...
[2022-05-31 11:23:56,995] INFO: Building callbacks...
[2022-05-31 11:23:56,996] INFO: Building model: spectra...
[2022-05-31 11:23:57,069] INFO: Created a temporary directory at /tmp/tmp067d6pre
[2022-05-31 11:23:57,069] INFO: Writing /tmp/tmp067d6pre/_remote_module_non_sriptable.py
[2022-05-31 11:23:57,153] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 11:24:05,723] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1090/2196017 [00:00<03:21, 10888.15it/s]  0%|          | 2348/2196017 [00:00<03:13, 11345.15it/s]  0%|          | 3669/2196017 [00:00<03:05, 11846.29it/s]  0%|          | 4973/2196017 [00:00<02:59, 12177.70it/s]  0%|          | 6354/2196017 [00:00<02:53, 12623.91it/s]  0%|          | 7769/2196017 [00:00<02:47, 13044.58it/s]  0%|          | 9206/2196017 [00:00<02:43, 13412.49it/s]  0%|          | 10702/2196017 [00:00<02:37, 13839.36it/s]  1%|          | 12209/2196017 [00:00<02:33, 14186.13it/s]  1%|          | 13750/2196017 [00:01<02:30, 14529.13it/s]  1%|          | 15357/2196017 [00:01<02:25, 14958.95it/s]  1%|          | 16947/2196017 [00:01<02:23, 15229.23it/s]  1%|          | 18613/2196017 [00:01<02:19, 15630.85it/s]  1%|          | 20230/2196017 [00:01<02:17, 15784.53it/s]  1%|          | 21967/2196017 [00:01<02:13, 16226.13it/s]  1%|          | 23709/2196017 [00:01<02:11, 16566.26it/s]  1%|          | 25396/2196017 [00:01<02:10, 16655.88it/s]  1%|          | 27209/2196017 [00:01<02:07, 17072.16it/s]  1%|▏         | 28980/2196017 [00:01<02:05, 17258.33it/s]  1%|▏         | 30848/2196017 [00:02<02:02, 17657.59it/s]  1%|▏         | 32789/2196017 [00:02<01:59, 18144.90it/s]  2%|▏         | 34758/2196017 [00:02<01:56, 18581.47it/s]  2%|▏         | 36717/2196017 [00:02<01:54, 18868.89it/s]  2%|▏         | 38649/2196017 [00:02<01:53, 19001.63it/s]  2%|▏         | 40660/2196017 [00:02<01:51, 19320.53it/s]  2%|▏         | 42680/2196017 [00:02<01:50, 19571.85it/s]  2%|▏         | 44840/2196017 [00:02<01:46, 20138.96it/s]  2%|▏         | 47119/2196017 [00:02<01:42, 20863.32it/s]  2%|▏         | 49293/2196017 [00:02<01:41, 21118.71it/s]  2%|▏         | 51443/2196017 [00:03<01:41, 21230.91it/s]  2%|▏         | 53730/2196017 [00:03<01:38, 21692.77it/s]  3%|▎         | 55984/2196017 [00:03<01:37, 21939.20it/s]  3%|▎         | 58214/2196017 [00:03<01:36, 22043.67it/s]  3%|▎         | 60512/2196017 [00:03<01:35, 22309.82it/s]  3%|▎         | 62964/2196017 [00:03<01:33, 22928.59it/s]  3%|▎         | 65436/2196017 [00:03<01:30, 23437.74it/s]  3%|▎         | 67945/2196017 [00:03<01:29, 23909.54it/s]  3%|▎         | 70582/2196017 [00:03<01:26, 24594.02it/s]  3%|▎         | 73218/2196017 [00:03<01:24, 25097.49it/s]  3%|▎         | 75945/2196017 [00:04<01:22, 25710.89it/s]  4%|▎         | 78794/2196017 [00:04<01:19, 26481.09it/s]  4%|▎         | 81640/2196017 [00:04<01:18, 27045.20it/s]  4%|▍         | 84484/2196017 [00:04<01:16, 27446.80it/s]  4%|▍         | 87441/2196017 [00:04<01:15, 28047.37it/s]  4%|▍         | 90392/2196017 [00:04<01:13, 28470.64it/s]  4%|▍         | 93487/2196017 [00:04<01:12, 29169.51it/s]  4%|▍         | 96545/2196017 [00:04<01:10, 29578.24it/s]  5%|▍         | 99605/2196017 [00:04<01:10, 29876.20it/s]  5%|▍         | 102834/2196017 [00:04<01:08, 30561.16it/s]  5%|▍         | 106188/2196017 [00:05<01:06, 31390.89it/s]  5%|▍         | 109521/2196017 [00:05<01:05, 31948.32it/s]  5%|▌         | 112853/2196017 [00:05<01:04, 32347.04it/s]  5%|▌         | 116303/2196017 [00:05<01:03, 32962.97it/s]  5%|▌         | 119795/2196017 [00:05<01:01, 33521.25it/s]  6%|▌         | 123231/2196017 [00:05<01:01, 33768.43it/s]  6%|▌         | 126776/2196017 [00:05<01:00, 34255.64it/s]  6%|▌         | 130447/2196017 [00:05<00:59, 34955.62it/s]  6%|▌         | 134172/2196017 [00:05<00:57, 35612.23it/s]  6%|▋         | 137958/2196017 [00:05<00:56, 36256.12it/s]  6%|▋         | 141709/2196017 [00:06<00:56, 36621.67it/s]  7%|▋         | 145547/2196017 [00:06<00:55, 37130.30it/s]  7%|▋         | 149397/2196017 [00:06<00:54, 37520.54it/s]  7%|▋         | 153266/2196017 [00:06<00:53, 37862.07it/s]  7%|▋         | 157284/2196017 [00:06<00:52, 38527.09it/s]  7%|▋         | 161273/2196017 [00:06<00:52, 38924.95it/s]  8%|▊         | 165353/2196017 [00:06<00:51, 39465.96it/s]  8%|▊         | 169380/2196017 [00:06<00:51, 39703.76it/s]  8%|▊         | 173429/2196017 [00:06<00:50, 39936.34it/s]  8%|▊         | 177457/2196017 [00:06<00:50, 40038.06it/s]  8%|▊         | 181545/2196017 [00:07<00:50, 40282.31it/s]  8%|▊         | 185796/2196017 [00:07<00:49, 40917.38it/s]  9%|▊         | 190006/2196017 [00:07<00:48, 41263.17it/s]  9%|▉         | 194231/2196017 [00:07<00:48, 41552.75it/s]  9%|▉         | 198608/2196017 [00:07<00:47, 42189.94it/s]  9%|▉         | 203029/2196017 [00:07<00:46, 42775.82it/s]  9%|▉         | 207556/2196017 [00:07<00:45, 43493.01it/s] 10%|▉         | 212016/2196017 [00:07<00:45, 43818.07it/s] 10%|▉         | 216503/2196017 [00:07<00:44, 44126.74it/s] 10%|█         | 220985/2196017 [00:07<00:44, 44332.09it/s] 10%|█         | 225567/2196017 [00:08<00:44, 44766.42it/s] 10%|█         | 230183/2196017 [00:08<00:43, 45170.50it/s] 11%|█         | 234830/2196017 [00:08<00:43, 45550.56it/s] 11%|█         | 239388/2196017 [00:08<00:43, 45344.79it/s] 11%|█         | 244026/2196017 [00:08<00:42, 45649.42it/s] 11%|█▏        | 248594/2196017 [00:08<00:42, 45393.88it/s] 12%|█▏        | 253296/2196017 [00:08<00:42, 45856.01it/s] 12%|█▏        | 257990/2196017 [00:08<00:41, 46175.73it/s] 12%|█▏        | 262662/2196017 [00:08<00:41, 46333.68it/s] 12%|█▏        | 267362/2196017 [00:08<00:41, 46531.33it/s] 12%|█▏        | 272017/2196017 [00:09<00:41, 46469.42it/s] 13%|█▎        | 276665/2196017 [00:09<00:41, 46424.90it/s] 13%|█▎        | 281433/2196017 [00:09<00:40, 46792.38it/s] 13%|█▎        | 286258/2196017 [00:09<00:40, 47220.22it/s] 13%|█▎        | 290982/2196017 [00:09<00:40, 47090.10it/s] 13%|█▎        | 295693/2196017 [00:09<00:40, 46803.11it/s] 14%|█▎        | 300482/2196017 [00:09<00:40, 47122.22it/s] 14%|█▍        | 305282/2196017 [00:09<00:39, 47371.17it/s] 14%|█▍        | 310195/2196017 [00:09<00:39, 47883.60it/s] 14%|█▍        | 315042/2196017 [00:09<00:39, 48055.89it/s] 15%|█▍        | 319887/2196017 [00:10<00:38, 48172.95it/s] 15%|█▍        | 324802/2196017 [00:10<00:38, 48461.15it/s] 15%|█▌        | 329690/2196017 [00:10<00:38, 48585.41it/s] 15%|█▌        | 334615/2196017 [00:10<00:38, 48782.81it/s] 15%|█▌        | 339614/2196017 [00:10<00:37, 49133.04it/s] 16%|█▌        | 344529/2196017 [00:10<00:37, 48977.14it/s] 16%|█▌        | 349505/2196017 [00:10<00:37, 49207.88it/s] 16%|█▌        | 354448/2196017 [00:10<00:37, 49272.18it/s] 16%|█▋        | 359376/2196017 [00:10<00:37, 49205.88it/s] 17%|█▋        | 364326/2196017 [00:10<00:37, 49291.90it/s] 17%|█▋        | 369375/2196017 [00:11<00:36, 49643.69it/s] 17%|█▋        | 374418/2196017 [00:11<00:36, 49876.27it/s] 17%|█▋        | 379435/2196017 [00:11<00:36, 49961.44it/s] 18%|█▊        | 384450/2196017 [00:11<00:36, 50016.45it/s] 18%|█▊        | 389542/2196017 [00:11<00:35, 50282.94it/s] 18%|█▊        | 394601/2196017 [00:11<00:35, 50372.99it/s] 18%|█▊        | 399653/2196017 [00:11<00:35, 50416.95it/s] 18%|█▊        | 404699/2196017 [00:11<00:35, 50416.03it/s] 19%|█▊        | 409752/2196017 [00:11<00:35, 50449.53it/s] 19%|█▉        | 414798/2196017 [00:11<00:35, 50433.97it/s] 19%|█▉        | 419928/2196017 [00:12<00:35, 50689.60it/s] 19%|█▉        | 425055/2196017 [00:12<00:34, 50860.94it/s] 20%|█▉        | 430142/2196017 [00:12<00:34, 50794.80it/s] 20%|█▉        | 435225/2196017 [00:12<00:34, 50803.73it/s] 20%|██        | 440350/2196017 [00:12<00:34, 50936.27it/s] 20%|██        | 445531/2196017 [00:12<00:34, 51194.13it/s] 21%|██        | 450665/2196017 [00:12<00:34, 51236.06it/s] 21%|██        | 455808/2196017 [00:12<00:33, 51291.36it/s] 21%|██        | 460938/2196017 [00:12<00:33, 51198.80it/s] 21%|██        | 466081/2196017 [00:12<00:33, 51265.80it/s] 21%|██▏       | 471222/2196017 [00:13<00:33, 51308.77it/s] 22%|██▏       | 476438/2196017 [00:13<00:33, 51560.13it/s] 22%|██▏       | 481606/2196017 [00:13<00:33, 51593.84it/s] 22%|██▏       | 486825/2196017 [00:13<00:33, 51770.49it/s] 22%|██▏       | 492016/2196017 [00:13<00:32, 51810.62it/s] 23%|██▎       | 497230/2196017 [00:13<00:32, 51908.93it/s] 23%|██▎       | 502422/2196017 [00:13<00:32, 51894.12it/s] 23%|██▎       | 507612/2196017 [00:13<00:32, 51456.93it/s] 23%|██▎       | 512831/2196017 [00:13<00:32, 51672.93it/s] 24%|██▎       | 518013/2196017 [00:13<00:32, 51716.17it/s] 24%|██▍       | 523186/2196017 [00:14<00:32, 51669.93it/s] 24%|██▍       | 528354/2196017 [00:14<00:32, 51662.03it/s] 24%|██▍       | 533546/2196017 [00:14<00:32, 51737.18it/s] 25%|██▍       | 538720/2196017 [00:14<00:32, 51719.32it/s] 25%|██▍       | 543933/2196017 [00:14<00:31, 51839.53it/s] 25%|██▌       | 549164/2196017 [00:14<00:31, 51977.91it/s] 25%|██▌       | 554405/2196017 [00:14<00:31, 52105.62it/s] 25%|██▌       | 559711/2196017 [00:14<00:31, 52387.58it/s] 26%|██▌       | 564951/2196017 [00:14<00:31, 52340.45it/s] 26%|██▌       | 570186/2196017 [00:14<00:31, 51989.30it/s] 26%|██▌       | 575408/2196017 [00:15<00:31, 52056.49it/s] 26%|██▋       | 580615/2196017 [00:15<00:31, 52031.31it/s] 27%|██▋       | 585878/2196017 [00:15<00:30, 52207.72it/s] 27%|██▋       | 591100/2196017 [00:15<00:30, 52151.26it/s] 27%|██▋       | 596347/2196017 [00:15<00:30, 52245.75it/s] 27%|██▋       | 601679/2196017 [00:15<00:30, 52560.94it/s] 28%|██▊       | 606936/2196017 [00:15<00:30, 52537.90it/s] 28%|██▊       | 612191/2196017 [00:15<00:30, 52368.48it/s] 28%|██▊       | 617497/2196017 [00:15<00:30, 52572.00it/s] 28%|██▊       | 622755/2196017 [00:15<00:29, 52512.04it/s] 29%|██▊       | 628105/2196017 [00:16<00:29, 52803.21it/s] 29%|██▉       | 633450/2196017 [00:16<00:29, 52994.15it/s] 29%|██▉       | 638751/2196017 [00:16<00:29, 52993.61it/s] 29%|██▉       | 644051/2196017 [00:16<00:29, 52949.00it/s] 30%|██▉       | 649370/2196017 [00:16<00:29, 53018.89it/s] 30%|██▉       | 654678/2196017 [00:16<00:29, 53034.42it/s] 30%|███       | 659982/2196017 [00:16<00:29, 52962.25it/s] 30%|███       | 665279/2196017 [00:16<00:29, 52635.17it/s] 31%|███       | 670544/2196017 [00:16<00:29, 52570.38it/s] 31%|███       | 675802/2196017 [00:16<00:28, 52565.05it/s] 31%|███       | 681059/2196017 [00:17<00:28, 52553.13it/s] 31%|███▏      | 686365/2196017 [00:17<00:28, 52704.08it/s] 31%|███▏      | 691677/2196017 [00:17<00:28, 52824.80it/s] 32%|███▏      | 697015/2196017 [00:17<00:28, 52989.22it/s] 32%|███▏      | 702315/2196017 [00:17<00:28, 52059.32it/s] 32%|███▏      | 707525/2196017 [00:17<00:30, 49142.02it/s] 32%|███▏      | 712915/2196017 [00:17<00:29, 50476.36it/s] 33%|███▎      | 718193/2196017 [00:17<00:28, 51145.89it/s] 33%|███▎      | 723562/2196017 [00:17<00:28, 51881.02it/s] 33%|███▎      | 728932/2196017 [00:17<00:27, 52410.73it/s] 33%|███▎      | 734212/2196017 [00:18<00:27, 52525.80it/s] 34%|███▎      | 739509/2196017 [00:18<00:27, 52656.61it/s] 34%|███▍      | 744787/2196017 [00:18<00:27, 52692.94it/s] 34%|███▍      | 750066/2196017 [00:18<00:27, 52720.49it/s] 34%|███▍      | 755342/2196017 [00:18<00:27, 52447.21it/s] 35%|███▍      | 760590/2196017 [00:18<00:27, 52387.10it/s] 35%|███▍      | 765855/2196017 [00:18<00:27, 52464.06it/s] 35%|███▌      | 771103/2196017 [00:18<00:27, 52332.79it/s] 35%|███▌      | 776338/2196017 [00:18<00:27, 51664.20it/s] 36%|███▌      | 781538/2196017 [00:18<00:27, 51762.59it/s] 36%|███▌      | 786718/2196017 [00:19<00:27, 51773.67it/s] 36%|███▌      | 791927/2196017 [00:19<00:27, 51866.78it/s] 36%|███▋      | 797193/2196017 [00:19<00:26, 52100.50it/s] 37%|███▋      | 802520/2196017 [00:19<00:26, 52443.43it/s] 37%|███▋      | 807879/2196017 [00:19<00:26, 52781.64it/s] 37%|███▋      | 813220/2196017 [00:19<00:26, 52965.78it/s] 37%|███▋      | 818550/2196017 [00:19<00:25, 53064.26it/s] 38%|███▊      | 823858/2196017 [00:19<00:25, 53037.59it/s] 38%|███▊      | 829163/2196017 [00:19<00:25, 52956.39it/s] 38%|███▊      | 834460/2196017 [00:19<00:25, 52908.69it/s] 38%|███▊      | 839752/2196017 [00:20<00:25, 52902.56it/s] 38%|███▊      | 845050/2196017 [00:20<00:25, 52924.69it/s] 39%|███▊      | 850351/2196017 [00:20<00:25, 52947.88it/s] 39%|███▉      | 855668/2196017 [00:20<00:25, 53013.02it/s] 39%|███▉      | 860984/2196017 [00:20<00:25, 53054.96it/s] 39%|███▉      | 866318/2196017 [00:20<00:25, 53139.98it/s] 40%|███▉      | 871633/2196017 [00:20<00:25, 52905.50it/s] 40%|███▉      | 876924/2196017 [00:20<00:24, 52827.30it/s] 40%|████      | 882207/2196017 [00:20<00:24, 52565.25it/s] 40%|████      | 887464/2196017 [00:20<00:24, 52550.68it/s] 41%|████      | 892720/2196017 [00:21<00:24, 52422.83it/s] 41%|████      | 897996/2196017 [00:21<00:24, 52522.39it/s] 41%|████      | 903288/2196017 [00:21<00:24, 52639.11it/s] 41%|████▏     | 908558/2196017 [00:21<00:24, 52654.74it/s] 42%|████▏     | 913824/2196017 [00:21<00:24, 52617.08it/s] 42%|████▏     | 919116/2196017 [00:21<00:24, 52706.82it/s] 42%|████▏     | 924391/2196017 [00:21<00:24, 52719.74it/s] 42%|████▏     | 929682/2196017 [00:21<00:23, 52776.62it/s] 43%|████▎     | 934965/2196017 [00:21<00:23, 52790.03it/s] 43%|████▎     | 940308/2196017 [00:21<00:23, 52978.58it/s] 43%|████▎     | 945669/2196017 [00:22<00:23, 53163.93it/s] 43%|████▎     | 950986/2196017 [00:22<00:23, 53079.63it/s] 44%|████▎     | 956295/2196017 [00:22<00:23, 53064.58it/s] 44%|████▍     | 961602/2196017 [00:22<00:23, 52905.93it/s] 44%|████▍     | 966908/2196017 [00:22<00:23, 52949.77it/s] 44%|████▍     | 972266/2196017 [00:22<00:23, 53137.22it/s] 45%|████▍     | 977584/2196017 [00:22<00:22, 53149.95it/s] 45%|████▍     | 982900/2196017 [00:22<00:22, 53066.26it/s] 45%|████▍     | 988207/2196017 [00:22<00:22, 53035.15it/s] 45%|████▌     | 993563/2196017 [00:22<00:22, 53191.16it/s] 45%|████▌     | 998907/2196017 [00:23<00:22, 53253.74it/s] 46%|████▌     | 1004270/2196017 [00:23<00:22, 53363.11it/s] 46%|████▌     | 1009608/2196017 [00:23<00:22, 53365.10it/s] 46%|████▌     | 1014948/2196017 [00:23<00:22, 53375.39it/s] 46%|████▋     | 1020286/2196017 [00:23<00:22, 53309.27it/s] 47%|████▋     | 1025636/2196017 [00:23<00:21, 53365.52it/s] 47%|████▋     | 1030988/2196017 [00:23<00:21, 53411.75it/s] 47%|████▋     | 1036356/2196017 [00:23<00:21, 53490.70it/s] 47%|████▋     | 1041706/2196017 [00:23<00:21, 53389.88it/s] 48%|████▊     | 1047046/2196017 [00:23<00:21, 53177.56it/s] 48%|████▊     | 1052365/2196017 [00:24<00:21, 52458.36it/s] 48%|████▊     | 1057669/2196017 [00:24<00:21, 52631.30it/s] 48%|████▊     | 1062938/2196017 [00:24<00:21, 52646.80it/s] 49%|████▊     | 1068270/2196017 [00:24<00:21, 52846.95it/s] 49%|████▉     | 1073556/2196017 [00:24<00:21, 52783.08it/s] 49%|████▉     | 1078885/2196017 [00:24<00:21, 52931.90it/s] 49%|████▉     | 1084220/2196017 [00:24<00:20, 53053.98it/s] 50%|████▉     | 1089574/2196017 [00:24<00:20, 53195.85it/s] 50%|████▉     | 1094910/2196017 [00:24<00:20, 53242.68it/s] 50%|█████     | 1100249/2196017 [00:24<00:20, 53271.94it/s] 50%|█████     | 1105577/2196017 [00:25<00:20, 53169.61it/s] 51%|█████     | 1110926/2196017 [00:25<00:20, 53264.66it/s] 51%|█████     | 1116267/2196017 [00:25<00:20, 53307.51it/s] 51%|█████     | 1121625/2196017 [00:25<00:20, 53388.37it/s] 51%|█████▏    | 1126964/2196017 [00:25<00:20, 53116.52it/s] 52%|█████▏    | 1132292/2196017 [00:25<00:20, 53163.16it/s] 52%|█████▏    | 1137636/2196017 [00:25<00:19, 53243.30it/s] 52%|█████▏    | 1142961/2196017 [00:25<00:19, 53076.82it/s] 52%|█████▏    | 1148316/2196017 [00:25<00:19, 53217.00it/s] 53%|█████▎    | 1153666/2196017 [00:25<00:19, 53300.65it/s] 53%|█████▎    | 1159024/2196017 [00:26<00:19, 53384.01it/s] 53%|█████▎    | 1164408/2196017 [00:26<00:19, 53517.96it/s] 53%|█████▎    | 1169763/2196017 [00:26<00:19, 53527.50it/s] 54%|█████▎    | 1175130/2196017 [00:26<00:19, 53569.54it/s] 54%|█████▍    | 1180512/2196017 [00:26<00:18, 53643.07it/s] 54%|█████▍    | 1185946/2196017 [00:26<00:18, 53849.52it/s] 54%|█████▍    | 1191347/2196017 [00:26<00:18, 53896.88it/s] 54%|█████▍    | 1196737/2196017 [00:26<00:18, 53844.23it/s] 55%|█████▍    | 1202122/2196017 [00:26<00:18, 53764.76it/s] 55%|█████▍    | 1207501/2196017 [00:26<00:18, 53765.77it/s] 55%|█████▌    | 1212878/2196017 [00:27<00:18, 53642.79it/s] 55%|█████▌    | 1218251/2196017 [00:27<00:18, 53666.87it/s] 56%|█████▌    | 1223643/2196017 [00:27<00:18, 53740.54it/s] 56%|█████▌    | 1229043/2196017 [00:27<00:17, 53816.52it/s] 56%|█████▌    | 1234451/2196017 [00:27<00:17, 53893.50it/s] 56%|█████▋    | 1239920/2196017 [00:27<00:17, 54128.99it/s] 57%|█████▋    | 1245373/2196017 [00:27<00:17, 54248.03it/s] 57%|█████▋    | 1250799/2196017 [00:27<00:17, 54187.93it/s] 57%|█████▋    | 1256247/2196017 [00:27<00:17, 54273.38it/s] 57%|█████▋    | 1261699/2196017 [00:27<00:17, 54345.25it/s] 58%|█████▊    | 1267134/2196017 [00:28<00:17, 54346.18it/s] 58%|█████▊    | 1272569/2196017 [00:28<00:17, 54112.92it/s] 58%|█████▊    | 1278046/2196017 [00:28<00:16, 54304.51it/s] 58%|█████▊    | 1283477/2196017 [00:28<00:16, 54076.94it/s] 59%|█████▊    | 1288886/2196017 [00:28<00:16, 54073.06it/s] 59%|█████▉    | 1294294/2196017 [00:28<00:16, 54074.81it/s] 59%|█████▉    | 1299730/2196017 [00:28<00:16, 54159.22it/s] 59%|█████▉    | 1305147/2196017 [00:28<00:16, 54131.92it/s] 60%|█████▉    | 1310640/2196017 [00:28<00:16, 54368.26it/s] 60%|█████▉    | 1316179/2196017 [00:28<00:16, 54670.55it/s] 60%|██████    | 1321647/2196017 [00:29<00:16, 54607.75it/s] 60%|██████    | 1327109/2196017 [00:29<00:16, 54031.30it/s] 61%|██████    | 1332546/2196017 [00:29<00:15, 54131.71it/s] 61%|██████    | 1337989/2196017 [00:29<00:15, 54219.98it/s] 61%|██████    | 1343434/2196017 [00:29<00:15, 54288.37it/s] 61%|██████▏   | 1348864/2196017 [00:29<00:15, 54276.43it/s] 62%|██████▏   | 1354360/2196017 [00:29<00:15, 54477.33it/s] 62%|██████▏   | 1359809/2196017 [00:29<00:15, 54404.77it/s] 62%|██████▏   | 1365265/2196017 [00:29<00:15, 54450.83it/s] 62%|██████▏   | 1370719/2196017 [00:29<00:15, 54475.70it/s] 63%|██████▎   | 1376225/2196017 [00:30<00:15, 54649.47it/s] 63%|██████▎   | 1381691/2196017 [00:30<00:14, 54559.70it/s] 63%|██████▎   | 1387148/2196017 [00:30<00:14, 54446.50it/s] 63%|██████▎   | 1392602/2196017 [00:30<00:14, 54472.12it/s] 64%|██████▎   | 1398050/2196017 [00:30<00:14, 54364.58it/s] 64%|██████▍   | 1403487/2196017 [00:30<00:14, 54352.73it/s] 64%|██████▍   | 1408923/2196017 [00:30<00:14, 54182.76it/s] 64%|██████▍   | 1414383/2196017 [00:30<00:14, 54306.58it/s] 65%|██████▍   | 1419842/2196017 [00:30<00:14, 54389.96it/s] 65%|██████▍   | 1425282/2196017 [00:30<00:14, 54370.98it/s] 65%|██████▌   | 1430720/2196017 [00:31<00:14, 54205.30it/s] 65%|██████▌   | 1436244/2196017 [00:31<00:13, 54510.40it/s] 66%|██████▌   | 1441715/2196017 [00:31<00:13, 54567.53it/s] 66%|██████▌   | 1447181/2196017 [00:31<00:13, 54592.84it/s] 66%|██████▌   | 1452642/2196017 [00:31<00:13, 54595.62it/s] 66%|██████▋   | 1458137/2196017 [00:31<00:13, 54698.74it/s] 67%|██████▋   | 1463621/2196017 [00:31<00:13, 54738.83it/s] 67%|██████▋   | 1469096/2196017 [00:31<00:13, 54556.56it/s] 67%|██████▋   | 1474552/2196017 [00:31<00:13, 54555.19it/s] 67%|██████▋   | 1480061/2196017 [00:31<00:13, 54713.54it/s] 68%|██████▊   | 1485533/2196017 [00:32<00:13, 54425.54it/s] 68%|██████▊   | 1490977/2196017 [00:32<00:12, 54332.72it/s] 68%|██████▊   | 1496424/2196017 [00:32<00:12, 54371.13it/s] 68%|██████▊   | 1501867/2196017 [00:32<00:12, 54386.30it/s] 69%|██████▊   | 1507306/2196017 [00:32<00:12, 54259.52it/s] 69%|██████▉   | 1512746/2196017 [00:32<00:12, 54300.94it/s] 69%|██████▉   | 1518177/2196017 [00:32<00:12, 54081.55it/s] 69%|██████▉   | 1523603/2196017 [00:32<00:12, 54133.01it/s] 70%|██████▉   | 1529029/2196017 [00:32<00:12, 54170.32it/s] 70%|██████▉   | 1534487/2196017 [00:32<00:12, 54291.17it/s] 70%|███████   | 1539944/2196017 [00:33<00:12, 54372.67it/s] 70%|███████   | 1545407/2196017 [00:33<00:11, 54447.19it/s] 71%|███████   | 1550916/2196017 [00:33<00:11, 54636.53it/s] 71%|███████   | 1556380/2196017 [00:33<00:11, 54591.51it/s] 71%|███████   | 1561840/2196017 [00:33<00:11, 54558.45it/s] 71%|███████▏  | 1567356/2196017 [00:33<00:11, 54735.22it/s] 72%|███████▏  | 1572830/2196017 [00:33<00:11, 54569.97it/s] 72%|███████▏  | 1578342/2196017 [00:33<00:11, 54732.75it/s] 72%|███████▏  | 1583841/2196017 [00:33<00:11, 54808.83it/s] 72%|███████▏  | 1589354/2196017 [00:34<00:11, 54902.50it/s] 73%|███████▎  | 1594845/2196017 [00:34<00:10, 54669.04it/s] 73%|███████▎  | 1600313/2196017 [00:34<00:10, 54511.88it/s] 73%|███████▎  | 1605776/2196017 [00:34<00:10, 54544.75it/s] 73%|███████▎  | 1611231/2196017 [00:34<00:10, 53577.40it/s] 74%|███████▎  | 1616605/2196017 [00:34<00:10, 53623.61it/s] 74%|███████▍  | 1622015/2196017 [00:34<00:10, 53765.05it/s] 74%|███████▍  | 1627470/2196017 [00:34<00:10, 53997.71it/s] 74%|███████▍  | 1632961/2196017 [00:34<00:10, 54266.41it/s] 75%|███████▍  | 1638476/2196017 [00:34<00:10, 54527.94it/s] 75%|███████▍  | 1643931/2196017 [00:35<00:10, 54495.09it/s] 75%|███████▌  | 1649398/2196017 [00:35<00:10, 54547.23it/s] 75%|███████▌  | 1654854/2196017 [00:35<00:09, 54377.48it/s] 76%|███████▌  | 1660304/2196017 [00:35<00:09, 54412.37it/s] 76%|███████▌  | 1665759/2196017 [00:35<00:09, 54452.05it/s] 76%|███████▌  | 1671254/2196017 [00:35<00:09, 54598.52it/s] 76%|███████▋  | 1676761/2196017 [00:35<00:09, 54738.04it/s] 77%|███████▋  | 1682236/2196017 [00:35<00:09, 54717.97it/s] 77%|███████▋  | 1687752/2196017 [00:35<00:09, 54849.22it/s] 77%|███████▋  | 1693238/2196017 [00:35<00:09, 54698.54it/s] 77%|███████▋  | 1698726/2196017 [00:36<00:09, 54751.35it/s] 78%|███████▊  | 1704202/2196017 [00:36<00:09, 54595.63it/s] 78%|███████▊  | 1709662/2196017 [00:36<00:08, 54530.07it/s] 78%|███████▊  | 1715124/2196017 [00:36<00:08, 54554.23it/s] 78%|███████▊  | 1720580/2196017 [00:36<00:08, 54498.01it/s] 79%|███████▊  | 1726030/2196017 [00:36<00:08, 54353.19it/s] 79%|███████▉  | 1731517/2196017 [00:36<00:08, 54506.95it/s] 79%|███████▉  | 1737030/2196017 [00:36<00:08, 54690.61it/s] 79%|███████▉  | 1742546/2196017 [00:36<00:08, 54828.46it/s] 80%|███████▉  | 1748030/2196017 [00:36<00:08, 54721.03it/s] 80%|███████▉  | 1753503/2196017 [00:37<00:08, 54713.56it/s] 80%|████████  | 1758975/2196017 [00:37<00:08, 54593.61it/s] 80%|████████  | 1764456/2196017 [00:37<00:07, 54657.16it/s] 81%|████████  | 1769922/2196017 [00:37<00:07, 54511.20it/s] 81%|████████  | 1775374/2196017 [00:37<00:07, 54496.27it/s] 81%|████████  | 1780825/2196017 [00:37<00:07, 54478.86it/s] 81%|████████▏ | 1786298/2196017 [00:37<00:07, 54552.19it/s] 82%|████████▏ | 1791754/2196017 [00:37<00:07, 54431.26it/s] 82%|████████▏ | 1797198/2196017 [00:37<00:07, 54337.37it/s] 82%|████████▏ | 1802707/2196017 [00:37<00:07, 54558.03it/s] 82%|████████▏ | 1808201/2196017 [00:38<00:07, 54670.60it/s] 83%|████████▎ | 1813669/2196017 [00:38<00:06, 54635.77it/s] 83%|████████▎ | 1819190/2196017 [00:38<00:06, 54805.43it/s] 83%|████████▎ | 1824712/2196017 [00:38<00:06, 54926.86it/s] 83%|████████▎ | 1830205/2196017 [00:38<00:06, 54820.62it/s] 84%|████████▎ | 1835711/2196017 [00:38<00:06, 54891.84it/s] 84%|████████▍ | 1841201/2196017 [00:38<00:06, 54719.29it/s] 84%|████████▍ | 1846674/2196017 [00:38<00:06, 54514.06it/s] 84%|████████▍ | 1852137/2196017 [00:38<00:06, 54548.14it/s] 85%|████████▍ | 1857593/2196017 [00:38<00:06, 54397.35it/s] 85%|████████▍ | 1863034/2196017 [00:39<00:06, 54360.58it/s] 85%|████████▌ | 1868489/2196017 [00:39<00:06, 54415.57it/s] 85%|████████▌ | 1873972/2196017 [00:39<00:05, 54538.60it/s] 86%|████████▌ | 1879427/2196017 [00:39<00:05, 54519.50it/s] 86%|████████▌ | 1884921/2196017 [00:39<00:05, 54644.05it/s] 86%|████████▌ | 1890441/2196017 [00:39<00:05, 54809.21it/s] 86%|████████▋ | 1895923/2196017 [00:39<00:05, 54335.36it/s] 87%|████████▋ | 1901368/2196017 [00:39<00:05, 54369.05it/s] 87%|████████▋ | 1906814/2196017 [00:39<00:05, 54394.03it/s] 87%|████████▋ | 1912286/2196017 [00:39<00:05, 54490.53it/s] 87%|████████▋ | 1917736/2196017 [00:40<00:05, 54262.33it/s] 88%|████████▊ | 1923163/2196017 [00:40<00:05, 54089.64it/s] 88%|████████▊ | 1928573/2196017 [00:40<00:04, 53891.39it/s] 88%|████████▊ | 1933976/2196017 [00:40<00:04, 53932.41it/s] 88%|████████▊ | 1939370/2196017 [00:40<00:04, 53921.21it/s] 89%|████████▊ | 1944791/2196017 [00:40<00:04, 54005.11it/s] 89%|████████▉ | 1950220/2196017 [00:40<00:04, 54087.74it/s] 89%|████████▉ | 1955702/2196017 [00:40<00:04, 54303.17it/s] 89%|████████▉ | 1961182/2196017 [00:40<00:04, 54449.97it/s] 90%|████████▉ | 1966628/2196017 [00:40<00:04, 54400.32it/s] 90%|████████▉ | 1972069/2196017 [00:41<00:04, 54280.72it/s] 90%|█████████ | 1977511/2196017 [00:41<00:04, 54321.98it/s] 90%|█████████ | 1982967/2196017 [00:41<00:03, 54391.83it/s] 91%|█████████ | 1988442/2196017 [00:41<00:03, 54497.37it/s] 91%|█████████ | 1993892/2196017 [00:41<00:03, 54349.64it/s] 91%|█████████ | 1999328/2196017 [00:41<00:03, 54331.51it/s] 91%|█████████▏| 2004762/2196017 [00:41<00:03, 54303.93it/s] 92%|█████████▏| 2010193/2196017 [00:41<00:03, 54245.60it/s] 92%|█████████▏| 2015629/2196017 [00:41<00:03, 54279.34it/s] 92%|█████████▏| 2021115/2196017 [00:41<00:03, 54450.71it/s] 92%|█████████▏| 2026601/2196017 [00:42<00:03, 54570.81it/s] 93%|█████████▎| 2032089/2196017 [00:42<00:02, 54662.79it/s] 93%|█████████▎| 2037584/2196017 [00:42<00:02, 54747.64it/s] 93%|█████████▎| 2043059/2196017 [00:42<00:02, 54665.43it/s] 93%|█████████▎| 2048536/2196017 [00:42<00:02, 54696.70it/s] 94%|█████████▎| 2054006/2196017 [00:42<00:02, 54625.39it/s] 94%|█████████▍| 2059469/2196017 [00:42<00:02, 54600.78it/s] 94%|█████████▍| 2064932/2196017 [00:42<00:02, 54609.25it/s] 94%|█████████▍| 2070393/2196017 [00:42<00:02, 54490.30it/s] 95%|█████████▍| 2075843/2196017 [00:42<00:02, 54470.63it/s] 95%|█████████▍| 2081291/2196017 [00:43<00:02, 54333.77it/s] 95%|█████████▌| 2086725/2196017 [00:43<00:02, 54282.08it/s] 95%|█████████▌| 2092197/2196017 [00:43<00:01, 54409.87it/s] 96%|█████████▌| 2097657/2196017 [00:43<00:01, 54466.16it/s] 96%|█████████▌| 2103132/2196017 [00:43<00:01, 54549.89it/s] 96%|█████████▌| 2108608/2196017 [00:43<00:01, 54611.84it/s] 96%|█████████▋| 2114096/2196017 [00:43<00:01, 54691.21it/s] 97%|█████████▋| 2119566/2196017 [00:43<00:01, 54622.45it/s] 97%|█████████▋| 2125029/2196017 [00:43<00:01, 54570.40it/s] 97%|█████████▋| 2130498/2196017 [00:43<00:01, 54606.16it/s] 97%|█████████▋| 2135959/2196017 [00:44<00:01, 54571.03it/s] 98%|█████████▊| 2141422/2196017 [00:44<00:01, 54588.06it/s] 98%|█████████▊| 2146901/2196017 [00:44<00:00, 54645.85it/s] 98%|█████████▊| 2152366/2196017 [00:44<00:00, 54455.72it/s] 98%|█████████▊| 2157812/2196017 [00:44<00:00, 54339.42it/s] 99%|█████████▊| 2163247/2196017 [00:44<00:00, 54295.55it/s] 99%|█████████▉| 2168677/2196017 [00:44<00:00, 54296.04it/s] 99%|█████████▉| 2174107/2196017 [00:44<00:00, 53882.23it/s] 99%|█████████▉| 2179540/2196017 [00:44<00:00, 54013.38it/s] 99%|█████████▉| 2185035/2196017 [00:44<00:00, 54288.21it/s]100%|█████████▉| 2190511/2196017 [00:45<00:00, 54426.78it/s]100%|█████████▉| 2195982/2196017 [00:45<00:00, 54509.12it/s]100%|██████████| 2196017/2196017 [00:45<00:00, 48646.70it/s]
[2022-05-31 11:24:50,878] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 11:24:57,618] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f2d2a819b80>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f2d2a819b80>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 11:24:57,622] INFO: Vocab size: 64518
[2022-05-31 11:24:57,622] INFO: Nb labels: 2
[2022-05-31 11:24:57,623] INFO: Total params: 21123803
[2022-05-31 11:24:57,623] INFO: Learnable params: 1768403
[2022-05-31 11:24:57,625] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  4%|▍         | 358/8214 [00:00<00:02, 3579.35ex/s]  9%|▊         | 708/8214 [00:00<00:02, 3554.74ex/s] 12%|█▏        | 1000/8214 [00:00<00:04, 1485.70ex/s] 16%|█▋        | 1345/8214 [00:00<00:03, 1791.40ex/s] 20%|██        | 1672/8214 [00:00<00:03, 2071.87ex/s] 24%|██▍       | 2000/8214 [00:00<00:02, 2199.51ex/s] 29%|██▊       | 2348/8214 [00:01<00:02, 2472.25ex/s] 33%|███▎      | 2697/8214 [00:01<00:02, 2707.79ex/s] 37%|███▋      | 3000/8214 [00:01<00:01, 2618.16ex/s] 41%|████      | 3347/8214 [00:01<00:01, 2823.73ex/s] 45%|████▍     | 3695/8214 [00:01<00:01, 2992.91ex/s] 49%|████▉     | 4010/8214 [00:01<00:01, 2845.00ex/s] 53%|█████▎    | 4361/8214 [00:01<00:01, 3016.18ex/s] 57%|█████▋    | 4701/8214 [00:01<00:01, 3119.18ex/s] 61%|██████    | 5022/8214 [00:01<00:01, 2931.84ex/s] 66%|██████▌   | 5381/8214 [00:02<00:00, 3099.70ex/s] 70%|██████▉   | 5726/8214 [00:02<00:00, 3195.57ex/s] 74%|███████▎  | 6053/8214 [00:02<00:00, 2919.62ex/s] 78%|███████▊  | 6412/8214 [00:02<00:00, 3091.47ex/s] 82%|████████▏ | 6761/8214 [00:02<00:00, 3198.79ex/s] 86%|████████▋ | 7089/8214 [00:02<00:00, 2986.35ex/s] 91%|█████████ | 7445/8214 [00:02<00:00, 3137.50ex/s] 95%|█████████▍| 7793/8214 [00:02<00:00, 3232.31ex/s] 99%|█████████▉| 8123/8214 [00:02<00:00, 2999.80ex/s]100%|██████████| 8214/8214 [00:02<00:00, 2754.10ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 26%|██▌       | 358/1369 [00:00<00:00, 3570.86ex/s] 51%|█████▏    | 702/1369 [00:00<00:00, 3528.24ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2988.42ex/s] 99%|█████████▊| 1350/1369 [00:00<00:00, 3124.44ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3093.00ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 25%|██▌       | 348/1369 [00:00<00:00, 3432.07ex/s] 50%|█████     | 689/1369 [00:00<00:00, 3423.39ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2945.07ex/s] 98%|█████████▊| 1337/1369 [00:00<00:00, 3059.57ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3034.08ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
numpy.__version__
1.21.4
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 82, in _make_variables
    scores.append(self._ravel(var._scores))
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 52, in _ravel
    return x.view(-1)
TypeError: Cannot interpret '-1' as a data type

                                                                   