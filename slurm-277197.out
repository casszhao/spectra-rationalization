	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 11:32:11,667] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 11:32:17,044] INFO: Building board loggers...
[2022-05-31 11:32:17,044] INFO: Building callbacks...
[2022-05-31 11:32:17,046] INFO: Building model: spectra...
[2022-05-31 11:32:17,279] INFO: Created a temporary directory at /tmp/tmp8s6lzj10
[2022-05-31 11:32:17,280] INFO: Writing /tmp/tmp8s6lzj10/_remote_module_non_sriptable.py
[2022-05-31 11:32:17,857] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 11:32:29,287] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:01<824:28:31,  1.35s/it]  0%|          | 575/2196017 [00:01<577:00:49,  1.06it/s]  0%|          | 1713/2196017 [00:01<403:42:59,  1.51it/s]  0%|          | 2935/2196017 [00:01<282:27:32,  2.16it/s]  0%|          | 4184/2196017 [00:01<197:37:24,  3.08it/s]  0%|          | 5418/2196017 [00:01<138:16:23,  4.40it/s]  0%|          | 6697/2196017 [00:01<96:44:56,  6.29it/s]   0%|          | 8045/2196017 [00:02<67:41:46,  8.98it/s]  0%|          | 9409/2196017 [00:02<47:22:16, 12.82it/s]  0%|          | 10801/2196017 [00:02<33:09:06, 18.31it/s]  1%|          | 12067/2196017 [00:02<23:12:27, 26.14it/s]  1%|          | 13510/2196017 [00:02<16:14:50, 37.31it/s]  1%|          | 15014/2196017 [00:02<11:22:38, 53.25it/s]  1%|          | 16561/2196017 [00:02<7:58:12, 75.96it/s]   1%|          | 18055/2196017 [00:02<5:35:15, 108.28it/s]  1%|          | 19566/2196017 [00:02<3:55:13, 154.21it/s]  1%|          | 21110/2196017 [00:02<2:45:15, 219.35it/s]  1%|          | 22790/2196017 [00:03<1:56:14, 311.62it/s]  1%|          | 24397/2196017 [00:03<1:21:58, 441.50it/s]  1%|          | 26092/2196017 [00:03<57:58, 623.75it/s]    1%|▏         | 27829/2196017 [00:03<41:10, 877.56it/s]  1%|▏         | 29472/2196017 [00:03<29:38, 1218.07it/s]  1%|▏         | 31257/2196017 [00:03<21:20, 1690.63it/s]  2%|▏         | 33103/2196017 [00:03<15:30, 2323.93it/s]  2%|▏         | 34972/2196017 [00:03<11:25, 3151.81it/s]  2%|▏         | 36811/2196017 [00:03<08:34, 4194.45it/s]  2%|▏         | 38630/2196017 [00:03<06:35, 5453.11it/s]  2%|▏         | 40546/2196017 [00:04<05:10, 6943.15it/s]  2%|▏         | 42493/2196017 [00:04<04:10, 8602.79it/s]  2%|▏         | 44529/2196017 [00:04<03:26, 10404.64it/s]  2%|▏         | 46743/2196017 [00:04<02:53, 12371.87it/s]  2%|▏         | 48906/2196017 [00:04<02:31, 14194.00it/s]  2%|▏         | 50957/2196017 [00:04<02:17, 15618.78it/s]  2%|▏         | 53159/2196017 [00:04<02:05, 17108.88it/s]  3%|▎         | 55253/2196017 [00:04<01:58, 18072.47it/s]  3%|▎         | 57506/2196017 [00:04<01:51, 19207.84it/s]  3%|▎         | 59784/2196017 [00:04<01:45, 20156.02it/s]  3%|▎         | 62038/2196017 [00:05<01:42, 20813.77it/s]  3%|▎         | 64415/2196017 [00:05<01:38, 21619.02it/s]  3%|▎         | 66865/2196017 [00:05<01:35, 22409.53it/s]  3%|▎         | 69287/2196017 [00:05<01:32, 22923.25it/s]  3%|▎         | 71761/2196017 [00:05<01:30, 23436.65it/s]  3%|▎         | 74285/2196017 [00:05<01:28, 23946.65it/s]  4%|▎         | 77028/2196017 [00:05<01:25, 24893.03it/s]  4%|▎         | 79859/2196017 [00:05<01:21, 25823.09it/s]  4%|▍         | 82596/2196017 [00:05<01:20, 26263.12it/s]  4%|▍         | 85276/2196017 [00:05<01:19, 26418.55it/s]  4%|▍         | 88086/2196017 [00:06<01:18, 26894.88it/s]  4%|▍         | 90937/2196017 [00:06<01:16, 27351.32it/s]  4%|▍         | 94019/2196017 [00:06<01:14, 28300.34it/s]  4%|▍         | 96917/2196017 [00:06<01:13, 28500.69it/s]  5%|▍         | 99874/2196017 [00:06<01:12, 28811.82it/s]  5%|▍         | 102995/2196017 [00:06<01:10, 29483.80it/s]  5%|▍         | 106203/2196017 [00:06<01:09, 30216.98it/s]  5%|▍         | 109350/2196017 [00:06<01:08, 30580.65it/s]  5%|▌         | 112522/2196017 [00:06<01:07, 30909.55it/s]  5%|▌         | 115788/2196017 [00:06<01:06, 31406.22it/s]  5%|▌         | 119178/2196017 [00:07<01:04, 32106.10it/s]  6%|▌         | 122516/2196017 [00:07<01:03, 32473.41it/s]  6%|▌         | 125836/2196017 [00:07<01:03, 32686.58it/s]  6%|▌         | 129290/2196017 [00:07<01:02, 33220.96it/s]  6%|▌         | 132808/2196017 [00:07<01:01, 33782.29it/s]  6%|▌         | 136364/2196017 [00:07<01:00, 34296.50it/s]  6%|▋         | 140014/2196017 [00:07<00:58, 34927.37it/s]  7%|▋         | 143679/2196017 [00:07<00:57, 35418.94it/s]  7%|▋         | 147331/2196017 [00:07<00:57, 35742.11it/s]  7%|▋         | 150972/2196017 [00:07<00:56, 35939.19it/s]  7%|▋         | 154696/2196017 [00:08<00:56, 36317.95it/s]  7%|▋         | 158646/2196017 [00:08<00:54, 37215.65it/s]  7%|▋         | 162464/2196017 [00:08<00:54, 37498.89it/s]  8%|▊         | 166350/2196017 [00:08<00:53, 37894.92it/s]  8%|▊         | 170200/2196017 [00:08<00:53, 38067.69it/s]  8%|▊         | 174106/2196017 [00:08<00:52, 38359.39it/s]  8%|▊         | 178041/2196017 [00:08<00:52, 38648.24it/s]  8%|▊         | 182033/2196017 [00:08<00:51, 39019.52it/s]  8%|▊         | 186145/2196017 [00:08<00:50, 39625.78it/s]  9%|▊         | 190253/2196017 [00:08<00:50, 40049.51it/s]  9%|▉         | 194314/2196017 [00:09<00:49, 40215.58it/s]  9%|▉         | 198641/2196017 [00:09<00:48, 41083.71it/s]  9%|▉         | 202989/2196017 [00:09<00:47, 41773.17it/s]  9%|▉         | 207331/2196017 [00:09<00:47, 42252.05it/s] 10%|▉         | 211628/2196017 [00:09<00:46, 42464.53it/s] 10%|▉         | 215950/2196017 [00:09<00:46, 42686.86it/s] 10%|█         | 220298/2196017 [00:09<00:46, 42920.33it/s] 10%|█         | 224699/2196017 [00:09<00:45, 43238.41it/s] 10%|█         | 229144/2196017 [00:09<00:45, 43592.82it/s] 11%|█         | 233569/2196017 [00:09<00:44, 43786.13it/s] 11%|█         | 237950/2196017 [00:10<00:44, 43570.84it/s] 11%|█         | 242472/2196017 [00:10<00:44, 44051.42it/s] 11%|█         | 246899/2196017 [00:10<00:44, 44114.64it/s] 11%|█▏        | 251421/2196017 [00:10<00:43, 44440.45it/s] 12%|█▏        | 255942/2196017 [00:10<00:43, 44664.56it/s] 12%|█▏        | 260410/2196017 [00:10<00:43, 44492.08it/s] 12%|█▏        | 264861/2196017 [00:10<00:44, 43582.25it/s] 12%|█▏        | 269225/2196017 [00:10<00:44, 43419.86it/s] 12%|█▏        | 273739/2196017 [00:10<00:43, 43921.04it/s] 13%|█▎        | 278255/2196017 [00:10<00:43, 44284.96it/s] 13%|█▎        | 282878/2196017 [00:11<00:42, 44849.27it/s] 13%|█▎        | 287485/2196017 [00:11<00:42, 45207.10it/s] 13%|█▎        | 292017/2196017 [00:11<00:42, 45228.39it/s] 14%|█▎        | 296543/2196017 [00:11<00:42, 45097.09it/s] 14%|█▎        | 301182/2196017 [00:11<00:41, 45475.75it/s] 14%|█▍        | 305828/2196017 [00:11<00:41, 45765.47it/s] 14%|█▍        | 310585/2196017 [00:11<00:40, 46292.27it/s] 14%|█▍        | 315217/2196017 [00:11<00:40, 46246.57it/s] 15%|█▍        | 319875/2196017 [00:11<00:40, 46345.72it/s] 15%|█▍        | 324611/2196017 [00:12<00:40, 46643.25it/s] 15%|█▍        | 329336/2196017 [00:12<00:39, 46822.35it/s] 15%|█▌        | 334020/2196017 [00:12<00:39, 46586.38it/s] 15%|█▌        | 338689/2196017 [00:12<00:39, 46601.22it/s] 16%|█▌        | 343350/2196017 [00:12<00:39, 46493.08it/s] 16%|█▌        | 348000/2196017 [00:12<00:39, 46433.20it/s] 16%|█▌        | 352746/2196017 [00:12<00:39, 46734.29it/s] 16%|█▋        | 357511/2196017 [00:12<00:39, 47003.57it/s] 16%|█▋        | 362273/2196017 [00:12<00:38, 47185.96it/s] 17%|█▋        | 367093/2196017 [00:12<00:38, 47483.84it/s] 17%|█▋        | 371994/2196017 [00:13<00:38, 47931.22it/s] 17%|█▋        | 376913/2196017 [00:13<00:37, 48300.56it/s] 17%|█▋        | 381745/2196017 [00:13<00:37, 47940.87it/s] 18%|█▊        | 386542/2196017 [00:13<00:37, 47784.95it/s] 18%|█▊        | 391322/2196017 [00:13<00:37, 47677.62it/s] 18%|█▊        | 396091/2196017 [00:13<00:37, 47542.90it/s] 18%|█▊        | 400915/2196017 [00:13<00:37, 47747.42it/s] 18%|█▊        | 405725/2196017 [00:13<00:37, 47851.16it/s] 19%|█▊        | 410511/2196017 [00:13<00:37, 47717.70it/s] 19%|█▉        | 415344/2196017 [00:13<00:37, 47897.59it/s] 19%|█▉        | 420333/2196017 [00:14<00:36, 48477.98it/s] 19%|█▉        | 425252/2196017 [00:14<00:36, 48684.74it/s] 20%|█▉        | 430159/2196017 [00:14<00:36, 48799.56it/s] 20%|█▉        | 435087/2196017 [00:14<00:35, 48940.60it/s] 20%|██        | 439984/2196017 [00:14<00:35, 48948.80it/s] 20%|██        | 445019/2196017 [00:14<00:35, 49358.84it/s] 20%|██        | 449957/2196017 [00:14<00:35, 49362.83it/s] 21%|██        | 454895/2196017 [00:14<00:35, 49223.12it/s] 21%|██        | 459819/2196017 [00:14<00:35, 48875.79it/s] 21%|██        | 464708/2196017 [00:14<00:35, 48860.01it/s] 21%|██▏       | 469599/2196017 [00:15<00:35, 48873.96it/s] 22%|██▏       | 474563/2196017 [00:15<00:35, 49100.98it/s] 22%|██▏       | 479474/2196017 [00:15<00:35, 48878.03it/s] 22%|██▏       | 484408/2196017 [00:15<00:34, 49014.68it/s] 22%|██▏       | 489311/2196017 [00:15<00:35, 48626.11it/s] 23%|██▎       | 494271/2196017 [00:15<00:34, 48912.46it/s] 23%|██▎       | 499234/2196017 [00:15<00:34, 49125.03it/s] 23%|██▎       | 504214/2196017 [00:15<00:34, 49325.32it/s] 23%|██▎       | 509258/2196017 [00:15<00:33, 49652.79it/s] 23%|██▎       | 514391/2196017 [00:15<00:33, 50141.85it/s] 24%|██▎       | 519441/2196017 [00:16<00:33, 50248.31it/s] 24%|██▍       | 524468/2196017 [00:16<00:33, 50093.79it/s] 24%|██▍       | 529479/2196017 [00:16<00:33, 49972.45it/s] 24%|██▍       | 534478/2196017 [00:16<00:33, 49878.86it/s] 25%|██▍       | 539467/2196017 [00:16<00:33, 49576.39it/s] 25%|██▍       | 544426/2196017 [00:16<00:33, 49548.42it/s] 25%|██▌       | 549420/2196017 [00:16<00:33, 49663.00it/s] 25%|██▌       | 554402/2196017 [00:16<00:33, 49708.02it/s] 25%|██▌       | 559374/2196017 [00:16<00:32, 49687.96it/s] 26%|██▌       | 564463/2196017 [00:16<00:32, 50041.63it/s] 26%|██▌       | 569468/2196017 [00:17<00:32, 49799.13it/s] 26%|██▌       | 574474/2196017 [00:17<00:32, 49875.23it/s] 26%|██▋       | 579463/2196017 [00:17<00:32, 49709.90it/s] 27%|██▋       | 584544/2196017 [00:17<00:32, 50034.63it/s] 27%|██▋       | 589673/2196017 [00:17<00:31, 50402.88it/s] 27%|██▋       | 594767/2196017 [00:17<00:31, 50562.19it/s] 27%|██▋       | 599892/2196017 [00:17<00:31, 50764.69it/s] 28%|██▊       | 604970/2196017 [00:17<00:31, 50658.05it/s] 28%|██▊       | 610037/2196017 [00:17<00:31, 50505.44it/s] 28%|██▊       | 615089/2196017 [00:17<00:31, 50343.31it/s] 28%|██▊       | 620124/2196017 [00:18<00:31, 50103.85it/s] 28%|██▊       | 625136/2196017 [00:18<00:31, 49944.88it/s] 29%|██▊       | 630132/2196017 [00:18<00:31, 49814.74it/s] 29%|██▉       | 635135/2196017 [00:18<00:31, 49875.58it/s] 29%|██▉       | 640217/2196017 [00:18<00:31, 50153.76it/s] 29%|██▉       | 645303/2196017 [00:18<00:30, 50362.76it/s] 30%|██▉       | 650401/2196017 [00:18<00:30, 50545.94it/s] 30%|██▉       | 655457/2196017 [00:18<00:30, 50402.83it/s] 30%|███       | 660694/2196017 [00:18<00:30, 50976.66it/s] 30%|███       | 665794/2196017 [00:18<00:30, 50785.15it/s] 31%|███       | 670879/2196017 [00:19<00:30, 50804.57it/s] 31%|███       | 675961/2196017 [00:19<00:30, 50626.35it/s] 31%|███       | 681030/2196017 [00:19<00:29, 50644.90it/s] 31%|███       | 686140/2196017 [00:19<00:29, 50777.88it/s] 31%|███▏      | 691222/2196017 [00:19<00:29, 50788.38it/s] 32%|███▏      | 696302/2196017 [00:19<00:29, 50442.01it/s] 32%|███▏      | 701347/2196017 [00:19<00:29, 50406.32it/s] 32%|███▏      | 706438/2196017 [00:19<00:29, 50554.95it/s] 32%|███▏      | 711646/2196017 [00:19<00:29, 51000.80it/s] 33%|███▎      | 716748/2196017 [00:19<00:29, 50635.95it/s] 33%|███▎      | 721814/2196017 [00:20<00:29, 50480.68it/s] 33%|███▎      | 726864/2196017 [00:20<00:29, 50069.10it/s] 33%|███▎      | 731957/2196017 [00:20<00:29, 50311.62it/s] 34%|███▎      | 737093/2196017 [00:20<00:28, 50620.20it/s] 34%|███▍      | 742163/2196017 [00:20<00:28, 50643.22it/s] 34%|███▍      | 747231/2196017 [00:20<00:28, 50653.36it/s] 34%|███▍      | 752298/2196017 [00:20<00:28, 50596.13it/s] 34%|███▍      | 757460/2196017 [00:20<00:28, 50898.98it/s] 35%|███▍      | 762551/2196017 [00:20<00:28, 50420.03it/s] 35%|███▍      | 767631/2196017 [00:20<00:28, 50529.77it/s] 35%|███▌      | 772686/2196017 [00:21<00:28, 50381.30it/s] 35%|███▌      | 777726/2196017 [00:21<00:28, 50348.08it/s] 36%|███▌      | 782762/2196017 [00:21<00:28, 50323.49it/s] 36%|███▌      | 787806/2196017 [00:21<00:27, 50355.85it/s] 36%|███▌      | 792887/2196017 [00:21<00:27, 50491.11it/s] 36%|███▋      | 798008/2196017 [00:21<00:27, 50702.94it/s] 37%|███▋      | 803113/2196017 [00:21<00:27, 50804.08it/s] 37%|███▋      | 808295/2196017 [00:21<00:27, 51102.75it/s] 37%|███▋      | 813406/2196017 [00:21<00:27, 51079.41it/s] 37%|███▋      | 818515/2196017 [00:21<00:27, 50983.72it/s] 38%|███▊      | 823684/2196017 [00:22<00:26, 51193.47it/s] 38%|███▊      | 828804/2196017 [00:22<00:26, 51144.24it/s] 38%|███▊      | 833919/2196017 [00:22<00:26, 51101.65it/s] 38%|███▊      | 839030/2196017 [00:22<00:26, 50937.39it/s] 38%|███▊      | 844177/2196017 [00:22<00:26, 51093.74it/s] 39%|███▊      | 849289/2196017 [00:22<00:26, 51098.60it/s] 39%|███▉      | 854543/2196017 [00:22<00:26, 51521.29it/s] 39%|███▉      | 859697/2196017 [00:22<00:26, 51318.52it/s] 39%|███▉      | 864830/2196017 [00:22<00:26, 51110.96it/s] 40%|███▉      | 869942/2196017 [00:22<00:26, 50972.94it/s] 40%|███▉      | 875040/2196017 [00:23<00:26, 50608.64it/s] 40%|████      | 880102/2196017 [00:23<00:26, 50475.65it/s] 40%|████      | 885195/2196017 [00:23<00:25, 50608.92it/s] 41%|████      | 890257/2196017 [00:23<00:25, 50397.95it/s] 41%|████      | 895418/2196017 [00:23<00:25, 50754.42it/s] 41%|████      | 900654/2196017 [00:23<00:25, 51223.77it/s] 41%|████      | 905779/2196017 [00:23<00:25, 51208.04it/s] 41%|████▏     | 910902/2196017 [00:23<00:25, 51161.26it/s] 42%|████▏     | 916020/2196017 [00:23<00:25, 50934.49it/s] 42%|████▏     | 921115/2196017 [00:23<00:25, 50878.32it/s] 42%|████▏     | 926205/2196017 [00:24<00:24, 50883.60it/s] 42%|████▏     | 931294/2196017 [00:24<00:24, 50849.06it/s] 43%|████▎     | 936380/2196017 [00:24<00:24, 50787.02it/s] 43%|████▎     | 941574/2196017 [00:24<00:24, 51124.67it/s] 43%|████▎     | 946777/2196017 [00:24<00:24, 51391.51it/s] 43%|████▎     | 951917/2196017 [00:24<00:24, 51250.76it/s] 44%|████▎     | 957043/2196017 [00:24<00:24, 51102.31it/s] 44%|████▍     | 962154/2196017 [00:24<00:24, 50525.04it/s] 44%|████▍     | 967209/2196017 [00:24<00:24, 50468.27it/s] 44%|████▍     | 972361/2196017 [00:24<00:24, 50779.16it/s] 45%|████▍     | 977441/2196017 [00:25<00:24, 50670.32it/s] 45%|████▍     | 982524/2196017 [00:25<00:23, 50717.95it/s] 45%|████▍     | 987690/2196017 [00:25<00:23, 50995.11it/s] 45%|████▌     | 992871/2196017 [00:25<00:23, 51213.67it/s] 45%|████▌     | 998101/2196017 [00:25<00:23, 51534.13it/s] 46%|████▌     | 1003256/2196017 [00:25<00:23, 51369.59it/s] 46%|████▌     | 1008403/2196017 [00:25<00:23, 51398.18it/s] 46%|████▌     | 1013544/2196017 [00:25<00:23, 51368.97it/s] 46%|████▋     | 1018682/2196017 [00:25<00:23, 50895.74it/s] 47%|████▋     | 1023773/2196017 [00:25<00:23, 50699.17it/s] 47%|████▋     | 1028844/2196017 [00:26<00:23, 50319.26it/s] 47%|████▋     | 1033878/2196017 [00:26<00:23, 50010.31it/s] 47%|████▋     | 1038881/2196017 [00:26<00:23, 49987.99it/s] 48%|████▊     | 1043926/2196017 [00:26<00:22, 50125.07it/s] 48%|████▊     | 1049019/2196017 [00:26<00:22, 50362.56it/s] 48%|████▊     | 1054190/2196017 [00:26<00:22, 50744.98it/s] 48%|████▊     | 1059654/2196017 [00:26<00:21, 51853.04it/s] 49%|████▊     | 1065175/2196017 [00:26<00:21, 52814.10it/s] 49%|████▊     | 1070466/2196017 [00:26<00:21, 52824.17it/s] 49%|████▉     | 1075755/2196017 [00:26<00:21, 52172.47it/s] 49%|████▉     | 1080979/2196017 [00:27<00:21, 51860.04it/s] 49%|████▉     | 1086170/2196017 [00:27<00:21, 51595.08it/s] 50%|████▉     | 1091395/2196017 [00:27<00:21, 51788.48it/s] 50%|████▉     | 1096719/2196017 [00:27<00:21, 52215.36it/s] 50%|█████     | 1102005/2196017 [00:27<00:20, 52405.03it/s] 50%|█████     | 1107248/2196017 [00:27<00:20, 52278.19it/s] 51%|█████     | 1112478/2196017 [00:27<00:20, 52227.34it/s] 51%|█████     | 1117702/2196017 [00:27<00:20, 51588.92it/s] 51%|█████     | 1122864/2196017 [00:27<00:20, 51103.11it/s] 51%|█████▏    | 1127978/2196017 [00:28<00:21, 50739.63it/s] 52%|█████▏    | 1133387/2196017 [00:28<00:20, 51699.04it/s] 52%|█████▏    | 1138773/2196017 [00:28<00:20, 52327.93it/s] 52%|█████▏    | 1144012/2196017 [00:28<00:20, 52051.41it/s] 52%|█████▏    | 1149269/2196017 [00:28<00:20, 52203.63it/s] 53%|█████▎    | 1154496/2196017 [00:28<00:19, 52221.37it/s] 53%|█████▎    | 1159814/2196017 [00:28<00:19, 52503.92it/s] 53%|█████▎    | 1165276/2196017 [00:28<00:19, 53106.27it/s] 53%|█████▎    | 1170590/2196017 [00:28<00:19, 52875.63it/s] 54%|█████▎    | 1175880/2196017 [00:28<00:19, 52665.03it/s] 54%|█████▍    | 1181210/2196017 [00:29<00:19, 52853.61it/s] 54%|█████▍    | 1186507/2196017 [00:29<00:19, 52886.90it/s] 54%|█████▍    | 1191797/2196017 [00:29<00:19, 52825.45it/s] 55%|█████▍    | 1197081/2196017 [00:29<00:18, 52761.54it/s] 55%|█████▍    | 1202358/2196017 [00:29<00:18, 52597.04it/s] 55%|█████▍    | 1207619/2196017 [00:29<00:19, 52011.58it/s] 55%|█████▌    | 1212841/2196017 [00:29<00:18, 52073.91it/s] 55%|█████▌    | 1218181/2196017 [00:29<00:18, 52461.58it/s] 56%|█████▌    | 1223484/2196017 [00:29<00:18, 52628.26it/s] 56%|█████▌    | 1228749/2196017 [00:29<00:18, 52529.28it/s] 56%|█████▌    | 1234070/2196017 [00:30<00:18, 52731.49it/s] 56%|█████▋    | 1239424/2196017 [00:30<00:18, 52969.53it/s] 57%|█████▋    | 1244760/2196017 [00:30<00:17, 53084.46it/s] 57%|█████▋    | 1250103/2196017 [00:30<00:17, 53185.17it/s] 57%|█████▋    | 1255438/2196017 [00:30<00:17, 53231.79it/s] 57%|█████▋    | 1260762/2196017 [00:30<00:17, 53079.54it/s] 58%|█████▊    | 1266071/2196017 [00:30<00:17, 52745.76it/s] 58%|█████▊    | 1271347/2196017 [00:30<00:17, 51991.17it/s] 58%|█████▊    | 1276644/2196017 [00:30<00:17, 52280.13it/s] 58%|█████▊    | 1281875/2196017 [00:30<00:17, 52070.16it/s] 59%|█████▊    | 1287084/2196017 [00:31<00:17, 51965.47it/s] 59%|█████▉    | 1292352/2196017 [00:31<00:17, 52176.87it/s] 59%|█████▉    | 1297604/2196017 [00:31<00:17, 52277.75it/s] 59%|█████▉    | 1302833/2196017 [00:31<00:17, 52212.70it/s] 60%|█████▉    | 1308055/2196017 [00:31<00:17, 52181.24it/s] 60%|█████▉    | 1313295/2196017 [00:31<00:16, 52246.39it/s] 60%|██████    | 1318520/2196017 [00:31<00:16, 52239.01it/s] 60%|██████    | 1323745/2196017 [00:31<00:16, 51976.77it/s] 61%|██████    | 1328978/2196017 [00:31<00:16, 52080.47it/s] 61%|██████    | 1334319/2196017 [00:31<00:16, 52467.40it/s] 61%|██████    | 1339567/2196017 [00:32<00:16, 52317.87it/s] 61%|██████    | 1344800/2196017 [00:32<00:16, 52193.05it/s] 61%|██████▏   | 1350078/2196017 [00:32<00:16, 52367.11it/s] 62%|██████▏   | 1355331/2196017 [00:32<00:16, 52413.60it/s] 62%|██████▏   | 1360573/2196017 [00:32<00:16, 51940.23it/s] 62%|██████▏   | 1365769/2196017 [00:32<00:16, 51429.77it/s] 62%|██████▏   | 1370915/2196017 [00:32<00:16, 51173.96it/s] 63%|██████▎   | 1376035/2196017 [00:32<00:16, 51099.32it/s] 63%|██████▎   | 1381147/2196017 [00:32<00:16, 50798.03it/s] 63%|██████▎   | 1386229/2196017 [00:32<00:16, 50543.44it/s] 63%|██████▎   | 1391285/2196017 [00:33<00:16, 50191.16it/s] 64%|██████▎   | 1396441/2196017 [00:33<00:15, 50592.04it/s] 64%|██████▍   | 1401652/2196017 [00:33<00:15, 51037.22it/s] 64%|██████▍   | 1406758/2196017 [00:33<00:15, 51030.02it/s] 64%|██████▍   | 1411898/2196017 [00:33<00:15, 51140.17it/s] 65%|██████▍   | 1417066/2196017 [00:33<00:15, 51300.55it/s] 65%|██████▍   | 1422256/2196017 [00:33<00:15, 51477.00it/s] 65%|██████▍   | 1427405/2196017 [00:33<00:14, 51255.05it/s] 65%|██████▌   | 1432532/2196017 [00:33<00:14, 51186.93it/s] 65%|██████▌   | 1437734/2196017 [00:33<00:14, 51433.80it/s] 66%|██████▌   | 1442967/2196017 [00:34<00:14, 51698.70it/s] 66%|██████▌   | 1448138/2196017 [00:34<00:14, 51382.82it/s] 66%|██████▌   | 1453278/2196017 [00:34<00:14, 51168.59it/s] 66%|██████▋   | 1458421/2196017 [00:34<00:14, 51244.70it/s] 67%|██████▋   | 1463547/2196017 [00:34<00:14, 51164.71it/s] 67%|██████▋   | 1468664/2196017 [00:34<00:14, 51030.95it/s] 67%|██████▋   | 1473882/2196017 [00:34<00:14, 51370.15it/s] 67%|██████▋   | 1479020/2196017 [00:34<00:14, 51148.26it/s] 68%|██████▊   | 1484136/2196017 [00:34<00:13, 51074.66it/s] 68%|██████▊   | 1489245/2196017 [00:34<00:13, 51076.68it/s] 68%|██████▊   | 1494374/2196017 [00:35<00:13, 51140.39it/s] 68%|██████▊   | 1499583/2196017 [00:35<00:13, 51420.84it/s] 69%|██████▊   | 1504760/2196017 [00:35<00:13, 51521.51it/s] 69%|██████▉   | 1509913/2196017 [00:35<00:13, 51485.34it/s] 69%|██████▉   | 1515062/2196017 [00:35<00:13, 51483.29it/s] 69%|██████▉   | 1520211/2196017 [00:35<00:13, 51131.30it/s] 69%|██████▉   | 1525379/2196017 [00:35<00:13, 51294.15it/s] 70%|██████▉   | 1530643/2196017 [00:35<00:12, 51688.31it/s] 70%|██████▉   | 1535813/2196017 [00:35<00:12, 51612.29it/s] 70%|███████   | 1541014/2196017 [00:35<00:12, 51729.73it/s] 70%|███████   | 1546254/2196017 [00:36<00:12, 51928.87it/s] 71%|███████   | 1551501/2196017 [00:36<00:12, 52088.75it/s] 71%|███████   | 1556727/2196017 [00:36<00:12, 52139.32it/s] 71%|███████   | 1561942/2196017 [00:36<00:12, 51974.27it/s] 71%|███████▏  | 1567140/2196017 [00:36<00:12, 51704.50it/s] 72%|███████▏  | 1572312/2196017 [00:36<00:12, 51431.59it/s] 72%|███████▏  | 1577456/2196017 [00:36<00:12, 51261.75it/s] 72%|███████▏  | 1582624/2196017 [00:36<00:11, 51384.92it/s] 72%|███████▏  | 1587769/2196017 [00:36<00:11, 51403.71it/s] 73%|███████▎  | 1592980/2196017 [00:36<00:11, 51613.30it/s] 73%|███████▎  | 1598257/2196017 [00:37<00:11, 51953.98it/s] 73%|███████▎  | 1603505/2196017 [00:37<00:11, 52110.06it/s] 73%|███████▎  | 1608717/2196017 [00:37<00:11, 52112.65it/s] 73%|███████▎  | 1613929/2196017 [00:37<00:11, 52026.83it/s] 74%|███████▎  | 1619156/2196017 [00:37<00:11, 52095.73it/s] 74%|███████▍  | 1624366/2196017 [00:37<00:10, 51973.99it/s] 74%|███████▍  | 1629564/2196017 [00:37<00:10, 51941.81it/s] 74%|███████▍  | 1634759/2196017 [00:37<00:10, 51839.88it/s] 75%|███████▍  | 1639944/2196017 [00:37<00:10, 51749.19it/s] 75%|███████▍  | 1645120/2196017 [00:37<00:10, 51743.38it/s] 75%|███████▌  | 1650387/2196017 [00:38<00:10, 52016.07it/s] 75%|███████▌  | 1655590/2196017 [00:38<00:10, 52016.09it/s] 76%|███████▌  | 1660792/2196017 [00:38<00:10, 51891.09it/s] 76%|███████▌  | 1665998/2196017 [00:38<00:10, 51940.85it/s] 76%|███████▌  | 1671193/2196017 [00:38<00:10, 51478.66it/s] 76%|███████▋  | 1676342/2196017 [00:38<00:10, 51109.62it/s] 77%|███████▋  | 1681455/2196017 [00:38<00:10, 50915.55it/s] 77%|███████▋  | 1686599/2196017 [00:38<00:09, 51069.96it/s] 77%|███████▋  | 1691707/2196017 [00:38<00:10, 50210.82it/s] 77%|███████▋  | 1696845/2196017 [00:38<00:09, 50554.11it/s] 78%|███████▊  | 1701986/2196017 [00:39<00:09, 50806.91it/s] 78%|███████▊  | 1707070/2196017 [00:39<00:09, 50681.41it/s] 78%|███████▊  | 1712218/2196017 [00:39<00:09, 50915.97it/s] 78%|███████▊  | 1717312/2196017 [00:39<00:09, 50680.65it/s] 78%|███████▊  | 1722382/2196017 [00:39<00:09, 50607.44it/s] 79%|███████▊  | 1727497/2196017 [00:39<00:09, 50767.71it/s] 79%|███████▉  | 1732619/2196017 [00:39<00:09, 50900.18it/s] 79%|███████▉  | 1737728/2196017 [00:39<00:08, 50924.37it/s] 79%|███████▉  | 1742821/2196017 [00:39<00:08, 50867.10it/s] 80%|███████▉  | 1747995/2196017 [00:39<00:08, 51125.81it/s] 80%|███████▉  | 1753172/2196017 [00:40<00:08, 51314.95it/s] 80%|████████  | 1758305/2196017 [00:40<00:08, 51243.19it/s] 80%|████████  | 1763430/2196017 [00:40<00:08, 51193.58it/s] 81%|████████  | 1768550/2196017 [00:40<00:08, 50837.68it/s] 81%|████████  | 1773635/2196017 [00:40<00:08, 50667.94it/s] 81%|████████  | 1778703/2196017 [00:40<00:08, 50310.84it/s] 81%|████████  | 1783736/2196017 [00:40<00:08, 49967.63it/s] 81%|████████▏ | 1788776/2196017 [00:40<00:08, 50096.07it/s] 82%|████████▏ | 1793887/2196017 [00:40<00:07, 50395.98it/s] 82%|████████▏ | 1799085/2196017 [00:40<00:07, 50859.23it/s] 82%|████████▏ | 1804286/2196017 [00:41<00:07, 51197.47it/s] 82%|████████▏ | 1809408/2196017 [00:41<00:07, 51029.75it/s] 83%|████████▎ | 1814567/2196017 [00:41<00:07, 51195.76it/s] 83%|████████▎ | 1819688/2196017 [00:41<00:07, 51050.44it/s] 83%|████████▎ | 1824816/2196017 [00:41<00:07, 51119.07it/s] 83%|████████▎ | 1829929/2196017 [00:41<00:07, 51065.54it/s] 84%|████████▎ | 1835037/2196017 [00:41<00:07, 51048.68it/s] 84%|████████▍ | 1840143/2196017 [00:41<00:07, 50827.71it/s] 84%|████████▍ | 1845372/2196017 [00:41<00:06, 51255.70it/s] 84%|████████▍ | 1850585/2196017 [00:41<00:06, 51514.40it/s] 85%|████████▍ | 1855895/2196017 [00:42<00:06, 51977.08it/s] 85%|████████▍ | 1861099/2196017 [00:42<00:06, 51993.35it/s] 85%|████████▍ | 1866331/2196017 [00:42<00:06, 52089.56it/s] 85%|████████▌ | 1871541/2196017 [00:42<00:06, 51908.36it/s] 85%|████████▌ | 1876733/2196017 [00:42<00:06, 51806.94it/s] 86%|████████▌ | 1881915/2196017 [00:42<00:06, 51719.89it/s] 86%|████████▌ | 1887088/2196017 [00:42<00:05, 51671.02it/s] 86%|████████▌ | 1892277/2196017 [00:42<00:05, 51735.94it/s] 86%|████████▋ | 1897451/2196017 [00:42<00:05, 51639.82it/s] 87%|████████▋ | 1902881/2196017 [00:42<00:05, 52408.99it/s] 87%|████████▋ | 1908125/2196017 [00:43<00:05, 52066.08it/s] 87%|████████▋ | 1913353/2196017 [00:43<00:05, 52129.42it/s] 87%|████████▋ | 1918568/2196017 [00:43<00:05, 52012.72it/s] 88%|████████▊ | 1923771/2196017 [00:43<00:05, 51945.60it/s] 88%|████████▊ | 1928991/2196017 [00:43<00:05, 52019.74it/s] 88%|████████▊ | 1934194/2196017 [00:43<00:05, 51547.43it/s] 88%|████████▊ | 1939351/2196017 [00:43<00:04, 51334.38it/s] 89%|████████▊ | 1944505/2196017 [00:43<00:04, 51395.43it/s] 89%|████████▉ | 1949740/2196017 [00:43<00:04, 51676.21it/s] 89%|████████▉ | 1955028/2196017 [00:44<00:04, 52030.76it/s] 89%|████████▉ | 1960233/2196017 [00:44<00:04, 51559.90it/s] 90%|████████▉ | 1965454/2196017 [00:44<00:04, 51751.44it/s] 90%|████████▉ | 1970631/2196017 [00:44<00:04, 51558.16it/s] 90%|████████▉ | 1975789/2196017 [00:44<00:04, 51311.12it/s] 90%|█████████ | 1980922/2196017 [00:44<00:04, 50944.42it/s] 90%|█████████ | 1986018/2196017 [00:44<00:04, 50595.87it/s] 91%|█████████ | 1991120/2196017 [00:44<00:04, 50720.69it/s] 91%|█████████ | 1996343/2196017 [00:44<00:03, 51163.00it/s] 91%|█████████ | 2001617/2196017 [00:44<00:03, 51624.93it/s] 91%|█████████▏| 2006782/2196017 [00:45<00:03, 51613.13it/s] 92%|█████████▏| 2012081/2196017 [00:45<00:03, 52017.64it/s] 92%|█████████▏| 2017337/2196017 [00:45<00:03, 52178.67it/s] 92%|█████████▏| 2022557/2196017 [00:45<00:03, 52093.30it/s] 92%|█████████▏| 2027875/2196017 [00:45<00:03, 52412.56it/s] 93%|█████████▎| 2033118/2196017 [00:45<00:03, 52360.37it/s] 93%|█████████▎| 2038355/2196017 [00:45<00:03, 52362.00it/s] 93%|█████████▎| 2043592/2196017 [00:45<00:02, 52305.69it/s] 93%|█████████▎| 2048847/2196017 [00:45<00:02, 52376.48it/s] 94%|█████████▎| 2054123/2196017 [00:45<00:02, 52488.35it/s] 94%|█████████▍| 2059373/2196017 [00:46<00:02, 52179.71it/s] 94%|█████████▍| 2064592/2196017 [00:46<00:02, 52170.87it/s] 94%|█████████▍| 2069844/2196017 [00:46<00:02, 52273.31it/s] 94%|█████████▍| 2075072/2196017 [00:46<00:02, 52059.05it/s] 95%|█████████▍| 2080279/2196017 [00:46<00:02, 52059.78it/s] 95%|█████████▍| 2085527/2196017 [00:46<00:02, 52183.85it/s] 95%|█████████▌| 2090746/2196017 [00:46<00:02, 52131.50it/s] 95%|█████████▌| 2095960/2196017 [00:46<00:01, 52018.81it/s] 96%|█████████▌| 2101256/2196017 [00:46<00:01, 52295.29it/s] 96%|█████████▌| 2106688/2196017 [00:46<00:01, 52884.99it/s] 96%|█████████▌| 2111983/2196017 [00:47<00:01, 52901.92it/s] 96%|█████████▋| 2117275/2196017 [00:47<00:01, 52845.95it/s] 97%|█████████▋| 2122561/2196017 [00:47<00:01, 52602.88it/s] 97%|█████████▋| 2127823/2196017 [00:47<00:01, 52588.44it/s] 97%|█████████▋| 2133132/2196017 [00:47<00:01, 52737.36it/s] 97%|█████████▋| 2138407/2196017 [00:47<00:01, 52433.80it/s] 98%|█████████▊| 2143652/2196017 [00:47<00:01, 52067.94it/s] 98%|█████████▊| 2148860/2196017 [00:47<00:00, 51761.85it/s] 98%|█████████▊| 2154095/2196017 [00:47<00:00, 51935.48it/s] 98%|█████████▊| 2159290/2196017 [00:47<00:00, 51859.49it/s] 99%|█████████▊| 2164489/2196017 [00:48<00:00, 51896.96it/s] 99%|█████████▉| 2169789/2196017 [00:48<00:00, 52222.37it/s] 99%|█████████▉| 2175174/2196017 [00:48<00:00, 52696.34it/s] 99%|█████████▉| 2180446/2196017 [00:48<00:00, 52043.34it/s]100%|█████████▉| 2185770/2196017 [00:48<00:00, 52396.29it/s]100%|█████████▉| 2191013/2196017 [00:48<00:00, 52358.69it/s]100%|██████████| 2196017/2196017 [00:48<00:00, 45078.80it/s]
[2022-05-31 11:33:18,774] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 11:33:29,614] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7fd5d64a0ca0>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7fd5d64a0ca0>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 11:33:29,857] INFO: Vocab size: 64518
[2022-05-31 11:33:29,857] INFO: Nb labels: 2
[2022-05-31 11:33:29,857] INFO: Total params: 21123803
[2022-05-31 11:33:29,857] INFO: Learnable params: 1768403
[2022-05-31 11:33:29,862] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  0%|          | 1/8214 [00:00<44:58,  3.04ex/s]  4%|▍         | 330/8214 [00:00<30:14,  4.35ex/s]  8%|▊         | 640/8214 [00:00<20:20,  6.20ex/s] 12%|█▏        | 945/8214 [00:00<13:40,  8.86ex/s] 14%|█▍        | 1150/8214 [00:02<09:32, 12.33ex/s] 18%|█▊        | 1463/8214 [00:02<06:23, 17.58ex/s] 22%|██▏       | 1767/8214 [00:02<04:17, 25.06ex/s] 24%|██▍       | 2000/8214 [00:02<02:54, 35.61ex/s] 28%|██▊       | 2312/8214 [00:02<01:56, 50.63ex/s] 32%|███▏      | 2616/8214 [00:02<01:17, 71.81ex/s] 36%|███▌      | 2931/8214 [00:02<00:52, 101.58ex/s] 39%|███▉      | 3211/8214 [00:02<00:35, 142.19ex/s] 43%|████▎     | 3527/8214 [00:02<00:23, 199.27ex/s] 47%|████▋     | 3842/8214 [00:02<00:15, 277.14ex/s] 50%|█████     | 4130/8214 [00:03<00:10, 375.40ex/s] 54%|█████▍    | 4456/8214 [00:03<00:07, 511.02ex/s] 58%|█████▊    | 4774/8214 [00:03<00:05, 682.82ex/s] 62%|██████▏   | 5068/8214 [00:03<00:03, 862.92ex/s] 66%|██████▌   | 5382/8214 [00:03<00:02, 1102.70ex/s] 69%|██████▉   | 5703/8214 [00:03<00:01, 1372.70ex/s] 73%|███████▎  | 5999/8214 [00:03<00:01, 1623.11ex/s] 77%|███████▋  | 6291/8214 [00:03<00:01, 1777.60ex/s] 81%|████████  | 6616/8214 [00:03<00:00, 2057.09ex/s] 84%|████████▍ | 6920/8214 [00:04<00:00, 2277.16ex/s] 88%|████████▊ | 7213/8214 [00:04<00:00, 2280.64ex/s] 92%|█████████▏| 7536/8214 [00:04<00:00, 2500.23ex/s] 96%|█████████▌| 7847/8214 [00:04<00:00, 2654.26ex/s] 99%|█████████▉| 8142/8214 [00:04<00:00, 2496.36ex/s]100%|██████████| 8214/8214 [00:04<00:00, 1792.52ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 24%|██▍       | 332/1369 [00:00<00:00, 3316.93ex/s] 47%|████▋     | 646/1369 [00:00<00:00, 3261.64ex/s] 69%|██████▉   | 950/1369 [00:00<00:00, 3189.93ex/s] 84%|████████▍ | 1156/1369 [00:00<00:00, 2609.87ex/s]100%|██████████| 1369/1369 [00:00<00:00, 2836.16ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  8%|▊         | 114/1369 [00:00<00:01, 1132.52ex/s] 24%|██▎       | 322/1369 [00:00<00:00, 1311.24ex/s] 31%|███▏      | 428/1369 [00:00<00:00, 1138.10ex/s] 38%|███▊      | 515/1369 [00:00<00:01, 699.44ex/s]  43%|████▎     | 587/1369 [00:00<00:01, 546.97ex/s] 64%|██████▎   | 871/1369 [00:00<00:00, 721.80ex/s] 75%|███████▌  | 1032/1369 [00:00<00:00, 864.37ex/s] 96%|█████████▋| 1320/1369 [00:01<00:00, 1094.05ex/s]100%|██████████| 1369/1369 [00:01<00:00, 1273.59ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
numpy.__version__
1.21.4
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 82, in _make_variables
    scores.append(self._ravel(var._scores))
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 52, in _ravel
    return x.view(-1)
TypeError: Cannot interpret '-1' as a data type

                                                                   