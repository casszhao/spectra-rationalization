	Python3 anaconda is now loaded in your environment.

	CUDA-10.2 loaded

Global seed set to 5
[2022-05-31 11:31:52,705] INFO: Building data: hotel_location...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-0a7802b7f06c64d6.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-ca82752a24f4df56.arrow
Loading cached processed dataset at /jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74/cache-107cd3568339fabd.arrow
[2022-05-31 11:31:58,485] INFO: Building board loggers...
[2022-05-31 11:31:58,486] INFO: Building callbacks...
[2022-05-31 11:31:58,487] INFO: Building model: spectra...
[2022-05-31 11:31:58,787] INFO: Created a temporary directory at /tmp/tmp9kqa480t
[2022-05-31 11:31:58,788] INFO: Writing /tmp/tmp9kqa480t/_remote_module_non_sriptable.py
[2022-05-31 11:31:59,732] INFO: {'seed': 5, 'default_root_dir': 'experiments/factcheck', 'save_rationales': True, 'save_tokenizer': True, 'save_label_encoder': True, 'gpu_log': False, 'dm': 'hotel_location', 'batch_size': 32, 'num_workers': 4, 'vocab_min_occurrences': 1, 'monitor': 'val_f1score', 'monitor_mode': 'max', 'monitor_patience': 20, 'model': 'spectra', 'embed_fixed': True, 'optimizer': 'adam', 'lr': 0.0001, 'weight_decay': 1e-06, 'betas': [0.9, 0.999], 'amsgrad': False, 'momentum': 0.0, 'dampening': 0.0, 'nesterov': False, 'alpha': 0.99, 'centered': False, 'lambd': 0.0001, 't0': 1000000.0, 'scheduler': 'multistep', 'milestones': [25, 50, 75], 'lr_decay': 0.97, 'emb_type': 'glove', 'emb_path': '840B', 'emb_size': 300, 'hidden_size': 200, 'dropout': 0.1, 'sentence_encoder_layer_type': 'lstm', 'transition': 0.01, 'budget': 15, 'temperature': 0.1, 'gpus': 1, 'gradient_clip_val': 5.0, 'min_epochs': 5, 'max_epochs': 25}
[2022-05-31 11:32:09,581] INFO: Loading vectors from .word_vectors_cache/glove.840B.300d.txt
  0%|          | 0/2196017 [00:00<?, ?it/s]  0%|          | 1/2196017 [00:00<63:41:02,  9.58it/s]  0%|          | 1094/2196017 [00:00<44:34:24, 13.68it/s]  0%|          | 2374/2196017 [00:00<31:11:51, 19.53it/s]  0%|          | 3672/2196017 [00:00<21:50:21, 27.88it/s]  0%|          | 4957/2196017 [00:00<15:17:34, 39.80it/s]  0%|          | 6322/2196017 [00:00<10:42:42, 56.78it/s]  0%|          | 7687/2196017 [00:00<7:30:24, 80.97it/s]   0%|          | 9089/2196017 [00:00<5:15:52, 115.39it/s]  0%|          | 10550/2196017 [00:00<3:41:42, 164.29it/s]  1%|          | 12055/2196017 [00:01<2:35:48, 233.61it/s]  1%|          | 13589/2196017 [00:01<1:49:42, 331.56it/s]  1%|          | 15147/2196017 [00:01<1:17:26, 469.37it/s]  1%|          | 16774/2196017 [00:01<54:50, 662.34it/s]    1%|          | 18364/2196017 [00:01<39:02, 929.60it/s]  1%|          | 20007/2196017 [00:01<27:58, 1296.53it/s]  1%|          | 21628/2196017 [00:01<20:14, 1790.80it/s]  1%|          | 23334/2196017 [00:01<14:47, 2448.14it/s]  1%|          | 24954/2196017 [00:01<11:01, 3283.99it/s]  1%|          | 26703/2196017 [00:01<08:19, 4342.00it/s]  1%|▏         | 28452/2196017 [00:02<06:26, 5606.11it/s]  1%|▏         | 30137/2196017 [00:02<05:15, 6863.17it/s]  1%|▏         | 31961/2196017 [00:02<04:16, 8442.97it/s]  2%|▏         | 33873/2196017 [00:02<03:33, 10141.72it/s]  2%|▏         | 35777/2196017 [00:02<03:03, 11794.75it/s]  2%|▏         | 37705/2196017 [00:02<02:41, 13349.30it/s]  2%|▏         | 39624/2196017 [00:02<02:26, 14689.03it/s]  2%|▏         | 41589/2196017 [00:02<02:15, 15889.99it/s]  2%|▏         | 43657/2196017 [00:02<02:06, 17073.66it/s]  2%|▏         | 45841/2196017 [00:02<01:57, 18269.18it/s]  2%|▏         | 47996/2196017 [00:03<01:52, 19142.84it/s]  2%|▏         | 50089/2196017 [00:03<01:49, 19645.74it/s]  2%|▏         | 52292/2196017 [00:03<01:45, 20304.95it/s]  2%|▏         | 54479/2196017 [00:03<01:43, 20744.24it/s]  3%|▎         | 56728/2196017 [00:03<01:40, 21234.13it/s]  3%|▎         | 59017/2196017 [00:03<01:38, 21704.23it/s]  3%|▎         | 61373/2196017 [00:03<01:36, 22224.37it/s]  3%|▎         | 63853/2196017 [00:03<01:32, 22935.40it/s]  3%|▎         | 66327/2196017 [00:03<01:30, 23448.36it/s]  3%|▎         | 68853/2196017 [00:03<01:28, 23962.27it/s]  3%|▎         | 71453/2196017 [00:04<01:26, 24536.38it/s]  3%|▎         | 74078/2196017 [00:04<01:24, 25025.27it/s]  4%|▎         | 76876/2196017 [00:04<01:22, 25837.44it/s]  4%|▎         | 79772/2196017 [00:04<01:19, 26700.55it/s]  4%|▍         | 82582/2196017 [00:04<01:17, 27104.62it/s]  4%|▍         | 85429/2196017 [00:04<01:16, 27499.68it/s]  4%|▍         | 88330/2196017 [00:04<01:15, 27935.32it/s]  4%|▍         | 91134/2196017 [00:04<01:16, 27695.44it/s]  4%|▍         | 94171/2196017 [00:04<01:13, 28446.07it/s]  4%|▍         | 97134/2196017 [00:04<01:12, 28789.86it/s]  5%|▍         | 100132/2196017 [00:05<01:11, 29136.69it/s]  5%|▍         | 103317/2196017 [00:05<01:10, 29893.09it/s]  5%|▍         | 106520/2196017 [00:05<01:08, 30503.33it/s]  5%|▍         | 109736/2196017 [00:05<01:07, 30980.66it/s]  5%|▌         | 113050/2196017 [00:05<01:05, 31598.12it/s]  5%|▌         | 116427/2196017 [00:05<01:04, 32208.95it/s]  5%|▌         | 119780/2196017 [00:05<01:03, 32594.05it/s]  6%|▌         | 123067/2196017 [00:05<01:03, 32670.95it/s]  6%|▌         | 126419/2196017 [00:05<01:02, 32919.96it/s]  6%|▌         | 129940/2196017 [00:05<01:01, 33573.07it/s]  6%|▌         | 133484/2196017 [00:06<01:00, 34110.98it/s]  6%|▌         | 137130/2196017 [00:06<00:59, 34781.79it/s]  6%|▋         | 140766/2196017 [00:06<00:58, 35234.29it/s]  7%|▋         | 144513/2196017 [00:06<00:57, 35868.09it/s]  7%|▋         | 148198/2196017 [00:06<00:56, 36155.58it/s]  7%|▋         | 151974/2196017 [00:06<00:55, 36615.76it/s]  7%|▋         | 155803/2196017 [00:06<00:54, 37095.17it/s]  7%|▋         | 159793/2196017 [00:06<00:53, 37894.02it/s]  7%|▋         | 163719/2196017 [00:06<00:53, 38293.04it/s]  8%|▊         | 167654/2196017 [00:06<00:52, 38602.80it/s]  8%|▊         | 171661/2196017 [00:07<00:51, 39030.23it/s]  8%|▊         | 175569/2196017 [00:07<00:51, 39006.28it/s]  8%|▊         | 179560/2196017 [00:07<00:51, 39272.69it/s]  8%|▊         | 183491/2196017 [00:07<00:51, 39229.52it/s]  9%|▊         | 187552/2196017 [00:07<00:50, 39630.98it/s]  9%|▊         | 191660/2196017 [00:07<00:50, 40054.74it/s]  9%|▉         | 195881/2196017 [00:07<00:49, 40676.68it/s]  9%|▉         | 200127/2196017 [00:07<00:48, 41194.24it/s]  9%|▉         | 204382/2196017 [00:07<00:47, 41590.14it/s] 10%|▉         | 208747/2196017 [00:07<00:47, 42187.17it/s] 10%|▉         | 213112/2196017 [00:08<00:46, 42614.32it/s] 10%|▉         | 217440/2196017 [00:08<00:46, 42811.12it/s] 10%|█         | 221854/2196017 [00:08<00:45, 43199.14it/s] 10%|█         | 226247/2196017 [00:08<00:45, 43414.06it/s] 11%|█         | 230770/2196017 [00:08<00:44, 43942.96it/s] 11%|█         | 235168/2196017 [00:08<00:51, 38063.95it/s] 11%|█         | 239117/2196017 [00:08<00:51, 37701.31it/s] 11%|█         | 243666/2196017 [00:08<00:49, 39741.20it/s] 11%|█▏        | 248054/2196017 [00:08<00:47, 40897.42it/s] 12%|█▏        | 252566/2196017 [00:08<00:46, 42077.73it/s] 12%|█▏        | 257072/2196017 [00:09<00:45, 42928.93it/s] 12%|█▏        | 261485/2196017 [00:09<00:44, 43280.37it/s] 12%|█▏        | 266006/2196017 [00:09<00:44, 43841.36it/s] 12%|█▏        | 270417/2196017 [00:09<00:43, 43908.92it/s] 13%|█▎        | 274928/2196017 [00:09<00:43, 44261.87it/s] 13%|█▎        | 279443/2196017 [00:09<00:43, 44524.00it/s] 13%|█▎        | 284068/2196017 [00:09<00:42, 45027.82it/s] 13%|█▎        | 288584/2196017 [00:09<00:42, 45066.70it/s] 13%|█▎        | 293177/2196017 [00:09<00:41, 45320.74it/s] 14%|█▎        | 297714/2196017 [00:09<00:41, 45263.57it/s] 14%|█▍        | 302341/2196017 [00:10<00:41, 45558.80it/s] 14%|█▍        | 307102/2196017 [00:10<00:40, 46153.90it/s] 14%|█▍        | 311884/2196017 [00:10<00:40, 46639.54it/s] 14%|█▍        | 316552/2196017 [00:10<00:40, 46513.43it/s] 15%|█▍        | 321247/2196017 [00:10<00:40, 46641.57it/s] 15%|█▍        | 326016/2196017 [00:10<00:39, 46950.88it/s] 15%|█▌        | 330713/2196017 [00:10<00:40, 46591.66it/s] 15%|█▌        | 335375/2196017 [00:10<00:40, 46505.94it/s] 15%|█▌        | 340187/2196017 [00:10<00:39, 46977.70it/s] 16%|█▌        | 344938/2196017 [00:10<00:39, 47134.51it/s] 16%|█▌        | 349906/2196017 [00:11<00:38, 47859.04it/s] 16%|█▌        | 354850/2196017 [00:11<00:38, 48320.66it/s] 16%|█▋        | 359686/2196017 [00:11<00:38, 48001.00it/s] 17%|█▋        | 364727/2196017 [00:11<00:37, 48697.88it/s] 17%|█▋        | 369873/2196017 [00:11<00:36, 49493.45it/s] 17%|█▋        | 375008/2196017 [00:11<00:36, 50035.90it/s] 17%|█▋        | 380028/2196017 [00:11<00:36, 50082.46it/s] 18%|█▊        | 385322/2196017 [00:11<00:35, 50904.47it/s] 18%|█▊        | 390419/2196017 [00:11<00:35, 50861.86it/s] 18%|█▊        | 395510/2196017 [00:11<00:35, 50754.01it/s] 18%|█▊        | 400592/2196017 [00:12<00:35, 50769.05it/s] 18%|█▊        | 405672/2196017 [00:12<00:35, 50642.21it/s] 19%|█▊        | 410738/2196017 [00:12<00:35, 50167.32it/s] 19%|█▉        | 415757/2196017 [00:12<00:36, 48945.41it/s] 19%|█▉        | 420660/2196017 [00:12<00:36, 48516.52it/s] 19%|█▉        | 425519/2196017 [00:12<00:36, 48473.93it/s] 20%|█▉        | 430462/2196017 [00:12<00:36, 48754.86it/s] 20%|█▉        | 435342/2196017 [00:12<00:36, 48544.46it/s] 20%|██        | 440307/2196017 [00:12<00:35, 48870.41it/s] 20%|██        | 445273/2196017 [00:13<00:35, 49102.99it/s] 21%|██        | 450231/2196017 [00:13<00:35, 49243.98it/s] 21%|██        | 455157/2196017 [00:13<00:35, 49103.78it/s] 21%|██        | 460069/2196017 [00:13<00:35, 49100.80it/s] 21%|██        | 465151/2196017 [00:13<00:34, 49602.26it/s] 21%|██▏       | 470282/2196017 [00:13<00:34, 50100.82it/s] 22%|██▏       | 475402/2196017 [00:13<00:34, 50425.18it/s] 22%|██▏       | 480543/2196017 [00:13<00:33, 50709.43it/s] 22%|██▏       | 485616/2196017 [00:13<00:33, 50714.63it/s] 22%|██▏       | 490689/2196017 [00:13<00:33, 50549.76it/s] 23%|██▎       | 495862/2196017 [00:14<00:33, 50886.73it/s] 23%|██▎       | 500962/2196017 [00:14<00:33, 50919.18it/s] 23%|██▎       | 506134/2196017 [00:14<00:33, 51156.57it/s] 23%|██▎       | 511401/2196017 [00:14<00:32, 51600.61it/s] 24%|██▎       | 516626/2196017 [00:14<00:32, 51791.31it/s] 24%|██▍       | 521863/2196017 [00:14<00:32, 51947.37it/s] 24%|██▍       | 527089/2196017 [00:14<00:32, 52040.18it/s] 24%|██▍       | 532294/2196017 [00:14<00:32, 51890.58it/s] 24%|██▍       | 537566/2196017 [00:14<00:31, 52134.61it/s] 25%|██▍       | 542811/2196017 [00:14<00:31, 52226.79it/s] 25%|██▍       | 548035/2196017 [00:15<00:31, 51997.73it/s] 25%|██▌       | 553346/2196017 [00:15<00:31, 52326.10it/s] 25%|██▌       | 558657/2196017 [00:15<00:31, 52558.36it/s] 26%|██▌       | 563914/2196017 [00:15<00:31, 51890.67it/s] 26%|██▌       | 569106/2196017 [00:15<00:31, 51419.75it/s] 26%|██▌       | 574251/2196017 [00:15<00:31, 51135.88it/s] 26%|██▋       | 579380/2196017 [00:15<00:31, 51180.72it/s] 27%|██▋       | 584611/2196017 [00:15<00:31, 51513.02it/s] 27%|██▋       | 589926/2196017 [00:15<00:30, 51990.93it/s] 27%|██▋       | 595138/2196017 [00:15<00:30, 52029.27it/s] 27%|██▋       | 600343/2196017 [00:16<00:30, 51690.32it/s] 28%|██▊       | 605514/2196017 [00:16<00:30, 51537.99it/s] 28%|██▊       | 610670/2196017 [00:16<00:30, 51471.18it/s] 28%|██▊       | 615878/2196017 [00:16<00:30, 51649.92it/s] 28%|██▊       | 621054/2196017 [00:16<00:30, 51682.32it/s] 29%|██▊       | 626266/2196017 [00:16<00:30, 51808.85it/s] 29%|██▉       | 631615/2196017 [00:16<00:29, 52295.68it/s] 29%|██▉       | 636846/2196017 [00:16<00:29, 52008.48it/s] 29%|██▉       | 642049/2196017 [00:16<00:29, 51955.14it/s] 29%|██▉       | 647249/2196017 [00:16<00:29, 51967.08it/s] 30%|██▉       | 652447/2196017 [00:17<00:29, 51887.37it/s] 30%|██▉       | 657637/2196017 [00:17<00:29, 51864.13it/s] 30%|███       | 662824/2196017 [00:17<00:29, 51682.53it/s] 30%|███       | 668018/2196017 [00:17<00:29, 51757.05it/s] 31%|███       | 673403/2196017 [00:17<00:29, 52365.95it/s] 31%|███       | 678794/2196017 [00:17<00:28, 52818.59it/s] 31%|███       | 684079/2196017 [00:17<00:28, 52823.15it/s] 31%|███▏      | 689549/2196017 [00:17<00:28, 53371.78it/s] 32%|███▏      | 695017/2196017 [00:17<00:27, 53756.09it/s] 32%|███▏      | 700451/2196017 [00:17<00:27, 53929.50it/s] 32%|███▏      | 705846/2196017 [00:18<00:27, 53780.03it/s] 32%|███▏      | 711433/2196017 [00:18<00:27, 54389.56it/s] 33%|███▎      | 716875/2196017 [00:18<00:27, 54331.50it/s] 33%|███▎      | 722310/2196017 [00:18<00:27, 54329.88it/s] 33%|███▎      | 727745/2196017 [00:18<00:27, 54134.29it/s] 33%|███▎      | 733160/2196017 [00:18<00:27, 53593.19it/s] 34%|███▎      | 738522/2196017 [00:18<00:27, 53369.92it/s] 34%|███▍      | 743861/2196017 [00:18<00:27, 52870.83it/s] 34%|███▍      | 749151/2196017 [00:18<00:27, 52525.27it/s] 34%|███▍      | 754406/2196017 [00:18<00:27, 52223.96it/s] 35%|███▍      | 759631/2196017 [00:19<00:27, 52204.05it/s] 35%|███▍      | 764885/2196017 [00:19<00:27, 52303.99it/s] 35%|███▌      | 770117/2196017 [00:19<00:27, 52291.38it/s] 35%|███▌      | 775357/2196017 [00:19<00:27, 52322.33it/s] 36%|███▌      | 780634/2196017 [00:19<00:26, 52454.05it/s] 36%|███▌      | 785906/2196017 [00:19<00:26, 52530.09it/s] 36%|███▌      | 791160/2196017 [00:19<00:27, 51984.19it/s] 36%|███▋      | 796501/2196017 [00:19<00:26, 52402.35it/s] 37%|███▋      | 801744/2196017 [00:19<00:26, 52213.76it/s] 37%|███▋      | 806978/2196017 [00:19<00:26, 52250.65it/s] 37%|███▋      | 812205/2196017 [00:20<00:26, 52142.75it/s] 37%|███▋      | 817421/2196017 [00:20<00:26, 52071.27it/s] 37%|███▋      | 822667/2196017 [00:20<00:26, 52186.59it/s] 38%|███▊      | 827887/2196017 [00:20<00:26, 52139.32it/s] 38%|███▊      | 833157/2196017 [00:20<00:26, 52305.69it/s] 38%|███▊      | 838388/2196017 [00:20<00:26, 52169.24it/s] 38%|███▊      | 843645/2196017 [00:20<00:25, 52286.20it/s] 39%|███▊      | 848874/2196017 [00:20<00:25, 52203.68it/s] 39%|███▉      | 854155/2196017 [00:20<00:25, 52383.23it/s] 39%|███▉      | 859395/2196017 [00:20<00:25, 52387.15it/s] 39%|███▉      | 864634/2196017 [00:21<00:25, 52345.42it/s] 40%|███▉      | 869869/2196017 [00:21<00:25, 52016.74it/s] 40%|███▉      | 875072/2196017 [00:21<00:25, 51893.93it/s] 40%|████      | 880262/2196017 [00:21<00:25, 51644.71it/s] 40%|████      | 885428/2196017 [00:21<00:25, 51531.31it/s] 41%|████      | 890582/2196017 [00:21<00:25, 51475.99it/s] 41%|████      | 895781/2196017 [00:21<00:25, 51628.62it/s] 41%|████      | 900957/2196017 [00:21<00:25, 51665.66it/s] 41%|████▏     | 906205/2196017 [00:21<00:24, 51905.11it/s] 42%|████▏     | 911449/2196017 [00:21<00:24, 52063.33it/s] 42%|████▏     | 916746/2196017 [00:22<00:24, 52329.56it/s] 42%|████▏     | 921980/2196017 [00:22<00:24, 52328.51it/s] 42%|████▏     | 927214/2196017 [00:22<00:24, 52139.61it/s] 42%|████▏     | 932507/2196017 [00:22<00:24, 52373.21it/s] 43%|████▎     | 937803/2196017 [00:22<00:23, 52547.15it/s] 43%|████▎     | 943093/2196017 [00:22<00:23, 52651.06it/s] 43%|████▎     | 948401/2196017 [00:22<00:23, 52776.63it/s] 43%|████▎     | 953680/2196017 [00:22<00:23, 52715.40it/s] 44%|████▎     | 959001/2196017 [00:22<00:23, 52862.67it/s] 44%|████▍     | 964288/2196017 [00:22<00:23, 52791.26it/s] 44%|████▍     | 969616/2196017 [00:23<00:23, 52935.00it/s] 44%|████▍     | 974910/2196017 [00:23<00:23, 52926.98it/s] 45%|████▍     | 980203/2196017 [00:23<00:23, 52483.45it/s] 45%|████▍     | 985495/2196017 [00:23<00:23, 52612.10it/s] 45%|████▌     | 990764/2196017 [00:23<00:22, 52634.67it/s] 45%|████▌     | 996105/2196017 [00:23<00:22, 52864.09it/s] 46%|████▌     | 1001451/2196017 [00:23<00:22, 53040.31it/s] 46%|████▌     | 1006756/2196017 [00:23<00:22, 52779.09it/s] 46%|████▌     | 1012055/2196017 [00:23<00:22, 52841.79it/s] 46%|████▋     | 1017467/2196017 [00:23<00:22, 53217.94it/s] 47%|████▋     | 1022790/2196017 [00:24<00:22, 53115.98it/s] 47%|████▋     | 1028159/2196017 [00:24<00:21, 53285.81it/s] 47%|████▋     | 1033522/2196017 [00:24<00:21, 53388.01it/s] 47%|████▋     | 1038934/2196017 [00:24<00:21, 53605.00it/s] 48%|████▊     | 1044309/2196017 [00:24<00:21, 53648.17it/s] 48%|████▊     | 1049675/2196017 [00:24<00:21, 53215.33it/s] 48%|████▊     | 1055149/2196017 [00:24<00:21, 53662.48it/s] 48%|████▊     | 1060662/2196017 [00:24<00:20, 54092.89it/s] 49%|████▊     | 1066074/2196017 [00:24<00:20, 54084.71it/s] 49%|████▉     | 1071571/2196017 [00:24<00:20, 54345.42it/s] 49%|████▉     | 1077007/2196017 [00:25<00:20, 53911.50it/s] 49%|████▉     | 1082478/2196017 [00:25<00:20, 54148.18it/s] 50%|████▉     | 1088014/2196017 [00:25<00:20, 54502.99it/s] 50%|████▉     | 1093500/2196017 [00:25<00:20, 54607.17it/s] 50%|█████     | 1098962/2196017 [00:25<00:20, 53838.91it/s] 50%|█████     | 1104350/2196017 [00:25<00:20, 53207.93it/s] 51%|█████     | 1109675/2196017 [00:25<00:20, 52868.73it/s] 51%|█████     | 1114966/2196017 [00:25<00:20, 52756.29it/s] 51%|█████     | 1120244/2196017 [00:25<00:20, 52540.79it/s] 51%|█████▏    | 1125500/2196017 [00:25<00:20, 52392.85it/s] 52%|█████▏    | 1130969/2196017 [00:26<00:20, 53060.27it/s] 52%|█████▏    | 1136361/2196017 [00:26<00:19, 53314.82it/s] 52%|█████▏    | 1141722/2196017 [00:26<00:19, 53397.30it/s] 52%|█████▏    | 1147064/2196017 [00:26<00:19, 53367.53it/s] 52%|█████▏    | 1152471/2196017 [00:26<00:19, 53574.69it/s] 53%|█████▎    | 1157830/2196017 [00:26<00:19, 53521.96it/s] 53%|█████▎    | 1163183/2196017 [00:26<00:19, 53442.67it/s] 53%|█████▎    | 1168528/2196017 [00:26<00:19, 53426.55it/s] 53%|█████▎    | 1174002/2196017 [00:26<00:18, 53813.85it/s] 54%|█████▎    | 1179385/2196017 [00:26<00:19, 53429.07it/s] 54%|█████▍    | 1184838/2196017 [00:27<00:18, 53754.06it/s] 54%|█████▍    | 1190259/2196017 [00:27<00:18, 53887.56it/s] 54%|█████▍    | 1195868/2196017 [00:27<00:18, 54529.25it/s] 55%|█████▍    | 1201623/2196017 [00:27<00:17, 55401.01it/s] 55%|█████▍    | 1207456/2196017 [00:27<00:17, 56243.83it/s] 55%|█████▌    | 1213135/2196017 [00:27<00:17, 56406.31it/s] 55%|█████▌    | 1218781/2196017 [00:27<00:17, 55648.53it/s] 56%|█████▌    | 1224378/2196017 [00:27<00:17, 55739.32it/s] 56%|█████▌    | 1229956/2196017 [00:27<00:17, 55646.99it/s] 56%|█████▋    | 1235524/2196017 [00:28<00:17, 54959.55it/s] 57%|█████▋    | 1241065/2196017 [00:28<00:17, 55093.54it/s] 57%|█████▋    | 1246587/2196017 [00:28<00:17, 55129.98it/s] 57%|█████▋    | 1252102/2196017 [00:28<00:17, 54762.23it/s] 57%|█████▋    | 1257581/2196017 [00:28<00:17, 54738.32it/s] 58%|█████▊    | 1263057/2196017 [00:28<00:17, 54444.02it/s] 58%|█████▊    | 1268503/2196017 [00:28<00:17, 54371.22it/s] 58%|█████▊    | 1273942/2196017 [00:28<00:17, 54154.55it/s] 58%|█████▊    | 1279462/2196017 [00:28<00:16, 54463.02it/s] 59%|█████▊    | 1284910/2196017 [00:28<00:16, 54467.89it/s] 59%|█████▉    | 1290420/2196017 [00:29<00:16, 54654.11it/s] 59%|█████▉    | 1295887/2196017 [00:29<00:16, 54198.91it/s] 59%|█████▉    | 1301326/2196017 [00:29<00:16, 54255.96it/s] 60%|█████▉    | 1306753/2196017 [00:29<00:16, 54199.26it/s] 60%|█████▉    | 1312202/2196017 [00:29<00:16, 54283.85it/s] 60%|██████    | 1317631/2196017 [00:29<00:16, 54187.66it/s] 60%|██████    | 1323100/2196017 [00:29<00:16, 54335.59it/s] 60%|██████    | 1328534/2196017 [00:29<00:16, 53916.99it/s] 61%|██████    | 1334145/2196017 [00:29<00:15, 54555.40it/s] 61%|██████    | 1339604/2196017 [00:29<00:15, 54463.50it/s] 61%|██████    | 1345053/2196017 [00:30<00:15, 54453.87it/s] 61%|██████▏   | 1350500/2196017 [00:30<00:15, 54455.76it/s] 62%|██████▏   | 1355947/2196017 [00:30<00:15, 54354.75it/s] 62%|██████▏   | 1361461/2196017 [00:30<00:15, 54587.17it/s] 62%|██████▏   | 1366970/2196017 [00:30<00:15, 54734.97it/s] 62%|██████▏   | 1372459/2196017 [00:30<00:15, 54778.19it/s] 63%|██████▎   | 1377938/2196017 [00:30<00:14, 54547.89it/s] 63%|██████▎   | 1383394/2196017 [00:30<00:14, 54354.85it/s] 63%|██████▎   | 1389039/2196017 [00:30<00:14, 54964.52it/s] 64%|██████▎   | 1394663/2196017 [00:30<00:14, 55340.67it/s] 64%|██████▍   | 1400289/2196017 [00:31<00:14, 55610.92it/s] 64%|██████▍   | 1406052/2196017 [00:31<00:14, 56199.92it/s] 64%|██████▍   | 1411675/2196017 [00:31<00:14, 55915.75it/s] 65%|██████▍   | 1417269/2196017 [00:31<00:13, 55660.52it/s] 65%|██████▍   | 1422837/2196017 [00:31<00:13, 55368.56it/s] 65%|██████▌   | 1428376/2196017 [00:31<00:13, 55107.56it/s] 65%|██████▌   | 1433889/2196017 [00:31<00:13, 54737.47it/s] 66%|██████▌   | 1439365/2196017 [00:31<00:13, 54664.66it/s] 66%|██████▌   | 1444833/2196017 [00:31<00:13, 54506.31it/s] 66%|██████▌   | 1450285/2196017 [00:31<00:13, 54333.09it/s] 66%|██████▋   | 1455720/2196017 [00:32<00:13, 54049.65it/s] 67%|██████▋   | 1461184/2196017 [00:32<00:13, 54223.27it/s] 67%|██████▋   | 1467021/2196017 [00:32<00:13, 55403.68it/s] 67%|██████▋   | 1472578/2196017 [00:32<00:13, 55451.27it/s] 67%|██████▋   | 1478128/2196017 [00:32<00:12, 55296.25it/s] 68%|██████▊   | 1483662/2196017 [00:32<00:12, 55240.12it/s] 68%|██████▊   | 1489189/2196017 [00:32<00:12, 54817.18it/s] 68%|██████▊   | 1494834/2196017 [00:32<00:12, 55295.14it/s] 68%|██████▊   | 1500428/2196017 [00:32<00:12, 55471.31it/s] 69%|██████▊   | 1505978/2196017 [00:32<00:12, 55321.23it/s] 69%|██████▉   | 1511512/2196017 [00:33<00:12, 55283.35it/s] 69%|██████▉   | 1517042/2196017 [00:33<00:12, 54687.13it/s] 69%|██████▉   | 1522546/2196017 [00:33<00:12, 54789.99it/s] 70%|██████▉   | 1528084/2196017 [00:33<00:12, 54963.85it/s] 70%|██████▉   | 1533661/2196017 [00:33<00:11, 55202.83it/s] 70%|███████   | 1539183/2196017 [00:33<00:11, 54778.12it/s] 70%|███████   | 1544663/2196017 [00:33<00:11, 54359.34it/s] 71%|███████   | 1550229/2196017 [00:33<00:11, 54741.32it/s] 71%|███████   | 1555706/2196017 [00:33<00:11, 54742.42it/s] 71%|███████   | 1561182/2196017 [00:33<00:11, 54594.87it/s] 71%|███████▏  | 1566643/2196017 [00:34<00:11, 54523.78it/s] 72%|███████▏  | 1572097/2196017 [00:34<00:11, 54340.58it/s] 72%|███████▏  | 1577532/2196017 [00:34<00:11, 53704.32it/s] 72%|███████▏  | 1583019/2196017 [00:34<00:11, 54046.52it/s] 72%|███████▏  | 1588433/2196017 [00:34<00:11, 54069.64it/s] 73%|███████▎  | 1593852/2196017 [00:34<00:11, 54103.89it/s] 73%|███████▎  | 1599264/2196017 [00:34<00:11, 53807.49it/s] 73%|███████▎  | 1604662/2196017 [00:34<00:10, 53857.76it/s] 73%|███████▎  | 1610071/2196017 [00:34<00:10, 53925.55it/s] 74%|███████▎  | 1615489/2196017 [00:34<00:10, 53997.34it/s] 74%|███████▍  | 1620957/2196017 [00:35<00:10, 54198.85it/s] 74%|███████▍  | 1626476/2196017 [00:35<00:10, 54488.68it/s] 74%|███████▍  | 1631982/2196017 [00:35<00:10, 54656.01it/s] 75%|███████▍  | 1637526/2196017 [00:35<00:10, 54888.77it/s] 75%|███████▍  | 1643138/2196017 [00:35<00:10, 55246.96it/s] 75%|███████▌  | 1648664/2196017 [00:35<00:09, 54823.38it/s] 75%|███████▌  | 1654148/2196017 [00:35<00:09, 54459.89it/s] 76%|███████▌  | 1659596/2196017 [00:35<00:10, 53582.54it/s] 76%|███████▌  | 1664959/2196017 [00:35<00:09, 53547.71it/s] 76%|███████▌  | 1670357/2196017 [00:35<00:09, 53675.50it/s] 76%|███████▋  | 1675793/2196017 [00:36<00:09, 53877.18it/s] 77%|███████▋  | 1681264/2196017 [00:36<00:09, 54124.21it/s] 77%|███████▋  | 1686758/2196017 [00:36<00:09, 54365.60it/s] 77%|███████▋  | 1692219/2196017 [00:36<00:09, 54437.43it/s] 77%|███████▋  | 1697740/2196017 [00:36<00:09, 54666.82it/s] 78%|███████▊  | 1703208/2196017 [00:36<00:09, 54017.79it/s] 78%|███████▊  | 1708613/2196017 [00:36<00:09, 53941.73it/s] 78%|███████▊  | 1714009/2196017 [00:36<00:08, 53721.92it/s] 78%|███████▊  | 1719388/2196017 [00:36<00:08, 53740.26it/s] 79%|███████▊  | 1724763/2196017 [00:36<00:08, 53322.35it/s] 79%|███████▉  | 1730163/2196017 [00:37<00:08, 53519.09it/s] 79%|███████▉  | 1735517/2196017 [00:37<00:08, 53441.15it/s] 79%|███████▉  | 1740926/2196017 [00:37<00:08, 53632.16it/s] 80%|███████▉  | 1746391/2196017 [00:37<00:08, 53932.08it/s] 80%|███████▉  | 1751924/2196017 [00:37<00:08, 54339.76it/s] 80%|████████  | 1757360/2196017 [00:37<00:08, 53903.89it/s] 80%|████████  | 1762773/2196017 [00:37<00:08, 53969.11it/s] 81%|████████  | 1768172/2196017 [00:37<00:07, 53908.24it/s] 81%|████████  | 1773564/2196017 [00:37<00:07, 53607.69it/s] 81%|████████  | 1778943/2196017 [00:37<00:07, 53660.70it/s] 81%|████████▏ | 1784323/2196017 [00:38<00:07, 53702.32it/s] 82%|████████▏ | 1789786/2196017 [00:38<00:07, 53976.43it/s] 82%|████████▏ | 1795185/2196017 [00:38<00:07, 53935.43it/s] 82%|████████▏ | 1800638/2196017 [00:38<00:07, 54112.07it/s] 82%|████████▏ | 1806050/2196017 [00:38<00:07, 53878.33it/s] 82%|████████▏ | 1811439/2196017 [00:38<00:07, 53785.19it/s] 83%|████████▎ | 1816818/2196017 [00:38<00:07, 53416.49it/s] 83%|████████▎ | 1822236/2196017 [00:38<00:06, 53642.07it/s] 83%|████████▎ | 1827628/2196017 [00:38<00:06, 53724.70it/s] 83%|████████▎ | 1833048/2196017 [00:38<00:06, 53864.17it/s] 84%|████████▎ | 1838624/2196017 [00:39<00:06, 54417.66it/s] 84%|████████▍ | 1844068/2196017 [00:39<00:06, 54252.41it/s] 84%|████████▍ | 1849500/2196017 [00:39<00:06, 54270.71it/s] 84%|████████▍ | 1855001/2196017 [00:39<00:06, 54489.18it/s] 85%|████████▍ | 1860451/2196017 [00:39<00:06, 54118.53it/s] 85%|████████▍ | 1865865/2196017 [00:39<00:06, 53897.06it/s] 85%|████████▌ | 1871256/2196017 [00:39<00:06, 53642.82it/s] 85%|████████▌ | 1876622/2196017 [00:39<00:05, 53490.51it/s] 86%|████████▌ | 1881972/2196017 [00:39<00:05, 53388.14it/s] 86%|████████▌ | 1887375/2196017 [00:39<00:05, 53557.00it/s] 86%|████████▌ | 1892732/2196017 [00:40<00:05, 53539.78it/s] 86%|████████▋ | 1898087/2196017 [00:40<00:05, 53489.80it/s] 87%|████████▋ | 1903477/2196017 [00:40<00:05, 53610.20it/s] 87%|████████▋ | 1908877/2196017 [00:40<00:05, 53726.14it/s] 87%|████████▋ | 1914250/2196017 [00:40<00:05, 53599.70it/s] 87%|████████▋ | 1919611/2196017 [00:40<00:05, 53475.34it/s] 88%|████████▊ | 1924959/2196017 [00:40<00:05, 53295.46it/s] 88%|████████▊ | 1930289/2196017 [00:40<00:05, 53047.99it/s] 88%|████████▊ | 1935636/2196017 [00:40<00:04, 53171.86it/s] 88%|████████▊ | 1941012/2196017 [00:41<00:04, 53346.36it/s] 89%|████████▊ | 1946405/2196017 [00:41<00:04, 53519.72it/s] 89%|████████▉ | 1951758/2196017 [00:41<00:04, 53460.65it/s] 89%|████████▉ | 1957119/2196017 [00:41<00:04, 53504.73it/s] 89%|████████▉ | 1962654/2196017 [00:41<00:04, 54042.75it/s] 90%|████████▉ | 1968201/2196017 [00:41<00:04, 54459.80it/s] 90%|████████▉ | 1973649/2196017 [00:41<00:04, 53971.07it/s] 90%|█████████ | 1979049/2196017 [00:41<00:04, 53896.30it/s] 90%|█████████ | 1984445/2196017 [00:41<00:03, 53912.52it/s] 91%|█████████ | 1989982/2196017 [00:41<00:03, 54339.98it/s] 91%|█████████ | 1995479/2196017 [00:42<00:03, 54526.90it/s] 91%|█████████ | 2000991/2196017 [00:42<00:03, 54701.33it/s] 91%|█████████▏| 2006563/2196017 [00:42<00:03, 55002.39it/s] 92%|█████████▏| 2012065/2196017 [00:42<00:03, 54961.00it/s] 92%|█████████▏| 2017562/2196017 [00:42<00:03, 54891.05it/s] 92%|█████████▏| 2023052/2196017 [00:42<00:03, 54658.74it/s] 92%|█████████▏| 2028519/2196017 [00:42<00:03, 54426.88it/s] 93%|█████████▎| 2034006/2196017 [00:42<00:02, 54556.24it/s] 93%|█████████▎| 2039582/2196017 [00:42<00:02, 54910.42it/s] 93%|█████████▎| 2045074/2196017 [00:42<00:02, 54769.13it/s] 93%|█████████▎| 2050552/2196017 [00:43<00:02, 54612.90it/s] 94%|█████████▎| 2056014/2196017 [00:43<00:02, 54354.98it/s] 94%|█████████▍| 2061451/2196017 [00:43<00:02, 53978.77it/s] 94%|█████████▍| 2066850/2196017 [00:43<00:02, 53950.52it/s] 94%|█████████▍| 2072246/2196017 [00:43<00:02, 53868.74it/s] 95%|█████████▍| 2077657/2196017 [00:43<00:02, 53938.75it/s] 95%|█████████▍| 2083052/2196017 [00:43<00:02, 53801.55it/s] 95%|█████████▌| 2088433/2196017 [00:43<00:02, 53766.38it/s] 95%|█████████▌| 2093850/2196017 [00:43<00:01, 53885.77it/s] 96%|█████████▌| 2099239/2196017 [00:43<00:01, 53821.62it/s] 96%|█████████▌| 2104641/2196017 [00:44<00:01, 53879.69it/s] 96%|█████████▌| 2110030/2196017 [00:44<00:01, 53733.08it/s] 96%|█████████▋| 2115404/2196017 [00:44<00:01, 53676.02it/s] 97%|█████████▋| 2120772/2196017 [00:44<00:01, 53648.41it/s] 97%|█████████▋| 2126255/2196017 [00:44<00:01, 53996.61it/s] 97%|█████████▋| 2131683/2196017 [00:44<00:01, 54078.59it/s] 97%|█████████▋| 2137218/2196017 [00:44<00:01, 54452.94it/s] 98%|█████████▊| 2142807/2196017 [00:44<00:00, 54876.10it/s] 98%|█████████▊| 2148326/2196017 [00:44<00:00, 54968.50it/s] 98%|█████████▊| 2153839/2196017 [00:44<00:00, 55014.82it/s] 98%|█████████▊| 2159439/2196017 [00:45<00:00, 55304.39it/s] 99%|█████████▊| 2164978/2196017 [00:45<00:00, 55328.79it/s] 99%|█████████▉| 2170512/2196017 [00:45<00:00, 54609.82it/s] 99%|█████████▉| 2176033/2196017 [00:45<00:00, 54786.30it/s] 99%|█████████▉| 2181563/2196017 [00:45<00:00, 54938.33it/s]100%|█████████▉| 2187059/2196017 [00:45<00:00, 54649.46it/s]100%|█████████▉| 2192526/2196017 [00:45<00:00, 54607.14it/s]100%|██████████| 2196017/2196017 [00:45<00:00, 48064.30it/s]
[2022-05-31 11:32:55,823] INFO: Saving vectors to .word_vectors_cache/glove.840B.300d.txt.pt
[2022-05-31 11:33:03,290] INFO: Building trainer...
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:151: LightningDeprecationWarning: Setting `Trainer(checkpoint_callback=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f3931b2eb80>)` is deprecated in v1.5 and will be removed in v1.7. Please consider using `Trainer(enable_checkpointing=<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f3931b2eb80>)`.
  rank_zero_deprecation(
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/callback_connector.py:191: LightningDeprecationWarning: Setting `Trainer(weights_summary=full)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.model_summary.ModelSummary` with `max_depth` directly to the Trainer's `callbacks` argument instead.
  rank_zero_deprecation(
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[2022-05-31 11:33:03,297] INFO: Vocab size: 64518
[2022-05-31 11:33:03,297] INFO: Nb labels: 2
[2022-05-31 11:33:03,298] INFO: Total params: 21123803
[2022-05-31 11:33:03,298] INFO: Learnable params: 1768403
[2022-05-31 11:33:03,301] INFO: Starting fit...
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
Reusing dataset hotel_location_dataset (/jmain02/home/J2AD003/txk58/zxz22-txk58/.cache/huggingface/datasets/hotel_location_dataset/hotel_location_dataset_/0.0.0/16854e97974eb7bce3e5660d672a205c8e564c179ebebaf3535fd71760869f74)
  0%|          | 0/8214 [00:00<?, ?ex/s]  0%|          | 1/8214 [00:00<14:55,  9.17ex/s]  4%|▍         | 360/8214 [00:00<10:00, 13.08ex/s]  9%|▊         | 701/8214 [00:00<06:42, 18.66ex/s] 12%|█▏        | 1000/8214 [00:01<04:36, 26.13ex/s] 16%|█▋        | 1354/8214 [00:01<03:04, 37.21ex/s] 21%|██        | 1688/8214 [00:01<02:03, 52.90ex/s] 24%|██▍       | 2000/8214 [00:01<01:22, 74.90ex/s] 29%|██▊       | 2345/8214 [00:01<00:55, 106.01ex/s] 33%|███▎      | 2679/8214 [00:01<00:37, 149.41ex/s] 36%|███▋      | 2998/8214 [00:01<00:24, 209.22ex/s] 40%|████      | 3298/8214 [00:02<00:20, 239.35ex/s] 43%|████▎     | 3519/8214 [00:02<00:14, 322.61ex/s] 47%|████▋     | 3862/8214 [00:02<00:09, 443.01ex/s] 50%|█████     | 4109/8214 [00:02<00:07, 580.13ex/s] 54%|█████▍    | 4466/8214 [00:02<00:04, 774.67ex/s] 58%|█████▊    | 4805/8214 [00:03<00:03, 1007.88ex/s] 62%|██████▏   | 5097/8214 [00:03<00:02, 1229.52ex/s] 66%|██████▋   | 5451/8214 [00:03<00:01, 1528.84ex/s] 71%|███████   | 5791/8214 [00:03<00:01, 1831.10ex/s] 74%|███████▍  | 6105/8214 [00:03<00:01, 1956.69ex/s] 79%|███████▊  | 6449/8214 [00:03<00:00, 2245.97ex/s] 83%|████████▎ | 6789/8214 [00:03<00:00, 2499.81ex/s] 86%|████████▋ | 7105/8214 [00:04<00:00, 1558.03ex/s] 89%|████████▉ | 7351/8214 [00:04<00:00, 1731.54ex/s] 94%|█████████▎| 7685/8214 [00:04<00:00, 2023.55ex/s] 97%|█████████▋| 8000/8214 [00:04<00:00, 2094.35ex/s]100%|██████████| 8214/8214 [00:04<00:00, 1807.41ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s] 27%|██▋       | 372/1369 [00:00<00:00, 3716.64ex/s] 52%|█████▏    | 717/1369 [00:00<00:00, 3631.38ex/s] 73%|███████▎  | 1000/1369 [00:00<00:00, 2991.98ex/s] 99%|█████████▉| 1352/1369 [00:00<00:00, 3129.31ex/s]100%|██████████| 1369/1369 [00:00<00:00, 3109.74ex/s]
  0%|          | 0/1369 [00:00<?, ?ex/s]  6%|▌         | 79/1369 [00:00<00:01, 788.78ex/s] 12%|█▏        | 159/1369 [00:00<00:01, 739.43ex/s] 23%|██▎       | 319/1369 [00:00<00:01, 810.37ex/s] 27%|██▋       | 376/1369 [00:00<00:01, 679.65ex/s] 31%|███▏      | 431/1369 [00:00<00:01, 584.19ex/s] 38%|███▊      | 525/1369 [00:01<00:04, 208.22ex/s] 41%|████      | 564/1369 [00:02<00:06, 131.63ex/s] 43%|████▎     | 593/1369 [00:02<00:05, 152.51ex/s] 53%|█████▎    | 720/1369 [00:02<00:03, 207.19ex/s] 57%|█████▋    | 778/1369 [00:02<00:03, 185.56ex/s] 69%|██████▉   | 942/1369 [00:03<00:01, 252.00ex/s] 75%|███████▍  | 1020/1369 [00:03<00:01, 301.28ex/s] 98%|█████████▊| 1341/1369 [00:03<00:00, 413.75ex/s]100%|██████████| 1369/1369 [00:03<00:00, 413.54ex/s]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py:380: RuntimeWarning: Found unsupported keys in the optimizer configuration: {'scheduler'}
  rank_zero_warn(

   | Name                             | Type               | Params
-------------------------------------------------------------------------
0  | train_precision                  | Precision          | 0     
1  | val_precision                    | Precision          | 0     
2  | test_precision                   | Precision          | 0     
3  | train_recall                     | Recall             | 0     
4  | val_recall                       | Recall             | 0     
5  | test_recall                      | Recall             | 0     
6  | criterion                        | NLLLoss            | 0     
7  | train_accuracy                   | Accuracy           | 0     
8  | val_accuracy                     | Accuracy           | 0     
9  | test_accuracy                    | Accuracy           | 0     
10 | emb_layer                        | Embedding          | 19.4 M
11 | generator                        | SPECTRAGenerator   | 20.3 M
12 | generator.embed_layer            | Sequential         | 19.4 M
13 | generator.embed_layer.1          | Dropout            | 0     
14 | generator.enc_layer              | LSTMEncoder        | 803 K 
15 | generator.enc_layer.lstm         | LSTM               | 803 K 
16 | generator.layer                  | Linear             | 401   
17 | generator.self_scorer            | SelfAdditiveScorer | 160 K 
18 | generator.self_scorer.activation | Tanh               | 0     
19 | predictor                        | SentimentPredictor | 20.2 M
20 | predictor.embed_layer            | Sequential         | 19.4 M
21 | predictor.embed_layer.1          | Dropout            | 0     
22 | predictor.enc_layer              | LSTMEncoder        | 803 K 
23 | predictor.enc_layer.lstm         | LSTM               | 803 K 
24 | predictor.output_layer           | Sequential         | 802   
25 | predictor.output_layer.0         | Dropout            | 0     
26 | predictor.output_layer.1         | Linear             | 802   
27 | predictor.output_layer.2         | LogSoftmax         | 0     
-------------------------------------------------------------------------
1.8 M     Trainable params
19.4 M    Non-trainable params
21.1 M    Total params
84.495    Total estimated model params size (MB)
numpy.__version__
1.21.4
unchanged  emb_layer.weight     torch.Size([64518, 300])
xavier_n   generator.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   generator.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   generator.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      generator.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      generator.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     generator.layer.weight torch.Size([1, 400])
zeros      generator.layer.bias torch.Size([1])
xavier     generator.self_scorer.W torch.Size([400, 400])
unchanged  generator.self_scorer.b torch.Size([400])
xavier     generator.self_scorer.v torch.Size([1, 400])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0 torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0 torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0 torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0 torch.Size([800])
xavier_n   predictor.enc_layer.lstm.weight_ih_l0_reverse torch.Size([800, 300])
xavier_n   predictor.enc_layer.lstm.weight_hh_l0_reverse torch.Size([800, 200])
zeros      predictor.enc_layer.lstm.bias_ih_l0_reverse torch.Size([800])
zeros      predictor.enc_layer.lstm.bias_hh_l0_reverse torch.Size([800])
xavier     predictor.output_layer.1.weight torch.Size([2, 400])
zeros      predictor.output_layer.1.bias torch.Size([2])
Sanity Checking: 0it [00:00, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/utils/data/dataloader.py:487: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py:87: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  transition_scores = torch.tensor(t[k], device=scores.device)
tensor([[-1.4719,  0.0000],
        [-1.7429,  0.0000],
        [-2.4242,  0.0000],
        ...,
        [-2.0088,  0.0000],
        [-0.3003,  0.0000],
        [ 0.1486,  0.0000]], device='cuda:0')
0.001
tensor([[[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        ...,

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]],

        [[0.1000, 0.0000],
         [0.0000, 0.0000]]], device='cuda:0')
Traceback (most recent call last):
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/__main__.py", line 112, in <module>
    train.run(args)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/train.py", line 121, in run
    trainer.fit(model, dm)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 768, in fit
    self._call_and_handle_interrupt(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 721, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 809, in _fit_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1234, in _run
    results = self._run_stage()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1321, in _run_stage
    return self._run_train()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1343, in _run_train
    self._run_sanity_check()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1411, in _run_sanity_check
    val_loop.run()
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/dataloader/evaluation_loop.py", line 154, in advance
    dl_outputs = self.epoch_loop.run(self._data_fetcher, dl_max_batches, kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/base.py", line 204, in run
    self.advance(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 127, in advance
    output = self._evaluation_step(**kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/loops/epoch/evaluation_epoch_loop.py", line 222, in _evaluation_step
    output = self.trainer._call_strategy_hook("validation_step", *kwargs.values())
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 1763, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/pytorch_lightning/strategies/strategy.py", line 344, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 155, in validation_step
    output = self._shared_eval_step(batch, batch_idx, prefix="val")
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/base.py", line 171, in _shared_eval_step
    z, y_hat = self(input_ids, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/lightning_models/highlights/spectra.py", line 125, in forward
    z = self.generator(x, current_epoch=self.current_epoch, mask=mask)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/generators.py", line 115, in forward
    z_probs = matching_smap_atmostone_budget(
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/spectra/spectra-rationalization/rationalizers/modules/sparsemap.py", line 86, in matching_smap_atmostone_budget
    fg.solve(max_iter=max_iter)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 84, in solve
    offset, pvars, scores = self._make_variables(pfg)
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/api.py", line 82, in _make_variables
    scores.append(self._ravel(var._scores))
  File "/jmain02/home/J2AD003/txk58/zxz22-txk58/.conda/envs/spectra/lib/python3.8/site-packages/lpsmap/api/autograd.py", line 52, in _ravel
    return x.view(-1)
TypeError: Cannot interpret '-1' as a data type

                                                                   